{"version":3,"file":"voicebank-recorder.esm.js","sources":["../src/core/AudioEngine.js","../src/core/WaveformRenderer.js","../src/ui/RecorderUI.js","../src/storage/StorageAdapter.js","../src/storage/IndexedDBAdapter.js","../src/storage/ServerAdapter.js","../src/storage/ElectronAdapter.js","../src/storage/CapacitorAdapter.js","../src/storage/index.js","../src/utils/PlatformDetector.js","../src/index.js"],"sourcesContent":["/**\n * AudioEngine - 跨平台音訊錄音引擎\n * \n * 功能：\n * - 封裝 Web Audio API (AudioContext, AudioWorklet)\n * - 支援 RecordRTC 錄音 (WAV 格式)\n * - 自動處理 AudioWorklet 與 ScriptProcessor fallback\n * - 提供錄音控制 (開始/停止/暫停/繼續)\n * - 事件驅動架構 (recording-start, data-available, recording-stop 等)\n * - 麥克風輸入管理與前級增益控制\n * \n * @example\n * const engine = new AudioEngine({\n *   sampleRate: 48000,\n *   autoGainControl: false,\n *   micGain: 1.0\n * });\n * \n * engine.on('recording-start', () => console.log('Started'));\n * engine.on('data-available', (pcmData) => console.log('PCM chunk', pcmData));\n * engine.on('recording-stop', (blob) => console.log('Finished', blob));\n * \n * await engine.initialize();\n * await engine.startRecording();\n * // ... 錄音中 ...\n * await engine.stopRecording();\n */\n\nexport class AudioEngine {\n    /**\n     * 創建 AudioEngine 實例\n     * @param {Object} options - 配置選項\n     * @param {number} [options.sampleRate=48000] - 採樣率\n     * @param {boolean} [options.autoGainControl=false] - 自動增益控制\n     * @param {boolean} [options.echoCancellation=false] - 回音消除\n     * @param {boolean} [options.noiseSuppression=false] - 噪音抑制\n     * @param {number} [options.micGain=1.0] - 前級增益 (1.0-6.0)\n     * @param {string} [options.deviceId] - 麥克風設備 ID\n     * @param {string} [options.workletPath='assets/js/worklet/pcm-collector.js'] - AudioWorklet 模組路徑\n     * @param {boolean} [options.preferWorklet=true] - 優先使用 AudioWorklet（支援時）\n     */\n    constructor(options = {}) {\n        // 配置選項\n        this.config = {\n            sampleRate: options.sampleRate || 48000,\n            autoGainControl: options.autoGainControl !== undefined ? options.autoGainControl : false,\n            echoCancellation: options.echoCancellation !== undefined ? options.echoCancellation : false,\n            noiseSuppression: options.noiseSuppression !== undefined ? options.noiseSuppression : false,\n            micGain: options.micGain || 1.0,\n            deviceId: options.deviceId || null,\n            workletPath: options.workletPath || 'assets/js/worklet/pcm-collector.js',\n            preferWorklet: options.preferWorklet !== undefined ? options.preferWorklet : true\n        };\n\n        // Web Audio API 物件\n        this.audioContext = null;\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n\n        // AudioWorklet 相關\n        this.workletSupported = false;\n        this.workletLoaded = false;\n        this.pcmCollectorNode = null;\n        this.usingWorklet = false;\n\n        // PCM 數據收集 (AudioWorklet 模式)\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        // RecordRTC 錄音器\n        this.recorder = null;\n        \n        // RecordRTC 模式 PCM 採集\n        this._pcmCaptureInterval = null;\n\n        // 麥克風串流\n        this.micStream = null;\n\n        // 錄音狀態\n        this.isRecording = false;\n        this.isPaused = false;\n        this.isInitialized = false;\n\n        // 時間戳記\n        this.recordStartTime = 0;\n        this.recordStopTime = 0;\n        this.recordWallStartMs = 0;\n        this.recordWallStopMs = 0;\n\n        // 最後的錄音結果\n        this.latestBlob = null;\n        this.latestUrl = null;\n\n        // 事件監聽器\n        this._eventListeners = {};\n    }\n\n    /**\n     * 初始化音訊引擎\n     * 創建 AudioContext、Analyser、Gain 節點等\n     * @returns {Promise<void>}\n     */\n    async initialize() {\n        if (this.isInitialized) {\n            return;\n        }\n\n        try {\n            // 創建 AudioContext\n            const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n            this.audioContext = new AudioContextClass({ sampleRate: this.config.sampleRate });\n\n            // 創建分析器節點\n            this.analyser = this.audioContext.createAnalyser();\n            this.analyser.fftSize = 256;\n\n            // 創建前級增益節點\n            this.preGainNode = this.audioContext.createGain();\n            this.preGainNode.gain.value = this.config.micGain;\n\n            // 創建 MediaStreamDestination（供 RecordRTC 使用）\n            this.mediaDest = this.audioContext.createMediaStreamDestination();\n\n            // 連接節點：preGain -> analyser -> silencer -> destination\n            this.preGainNode.connect(this.analyser);\n            this.preGainNode.connect(this.mediaDest);\n\n            // 創建靜音節點（避免回授）\n            this.analyserSilencer = this.audioContext.createGain();\n            this.analyserSilencer.gain.value = 0;\n            this.analyser.connect(this.analyserSilencer);\n            this.analyserSilencer.connect(this.audioContext.destination);\n\n            // 檢測 AudioWorklet 支援\n            this.workletSupported = !!(\n                this.audioContext.audioWorklet && \n                window.AudioWorkletNode\n            );\n\n            // 載入 AudioWorklet 模組（如果支援且偏好使用）\n            if (this.workletSupported && this.config.preferWorklet) {\n                try {\n                    await this.audioContext.audioWorklet.addModule(this.config.workletPath);\n                    this.workletLoaded = true;\n                    this._emit('worklet-loaded', { path: this.config.workletPath });\n                } catch (error) {\n                    console.warn('載入 AudioWorklet 模組失敗，將回退到 RecordRTC:', error);\n                    this.workletLoaded = false;\n                    this._emit('worklet-load-failed', { error });\n                }\n            }\n\n            // 恢復 AudioContext（如果暫停）\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            this.isInitialized = true;\n            this._emit('initialized', {\n                sampleRate: this.audioContext.sampleRate,\n                state: this.audioContext.state,\n                workletSupported: this.workletSupported,\n                workletLoaded: this.workletLoaded\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'initialize', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 開始錄音\n     * @returns {Promise<void>}\n     */\n    async startRecording() {\n        if (!this.isInitialized) {\n            throw new Error('AudioEngine 尚未初始化，請先調用 initialize()');\n        }\n\n        if (this.isRecording) {\n            throw new Error('已經在錄音中');\n        }\n\n        try {\n            // 確保 AudioContext 是活躍狀態\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            // 獲取麥克風\n            await this._captureMicrophone();\n\n            // 重置 PCM 數據收集\n            this.pcmChunks = [];\n            this.pcmTotalSamples = 0;\n\n            // 清理舊的錄音結果\n            if (this.latestUrl) {\n                URL.revokeObjectURL(this.latestUrl);\n                this.latestUrl = null;\n            }\n            this.latestBlob = null;\n\n            // 記錄開始時間\n            this.recordStartTime = Date.now();\n            this.recordWallStartMs = performance.now();\n            this.recordStopTime = 0;\n            this.recordWallStopMs = 0;\n\n            // 決定使用 AudioWorklet 或 RecordRTC\n            const useWorklet = this.workletLoaded && this.config.preferWorklet;\n\n            if (useWorklet) {\n                await this._startWorkletRecording();\n            } else {\n                await this._startRecordRTCRecording();\n            }\n\n            this.isRecording = true;\n            this.isPaused = false;\n\n            this._emit('recording-start', {\n                timestamp: this.recordStartTime,\n                mode: useWorklet ? 'worklet' : 'recordrtc',\n                sampleRate: this.audioContext.sampleRate\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'start-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 停止錄音\n     * @returns {Promise<Blob>} 錄音的 Blob\n     */\n    async stopRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        try {\n            this.isRecording = false;\n            this.recordStopTime = Date.now();\n            this.recordWallStopMs = performance.now();\n\n            let blob;\n\n            if (this.usingWorklet) {\n                blob = await this._stopWorkletRecording();\n            } else if (this.recorder) {\n                blob = await this._stopRecordRTCRecording();\n            } else {\n                throw new Error('沒有可用的錄音器');\n            }\n\n            // 停止麥克風\n            this._stopMicrophone();\n\n            // 儲存結果\n            this.latestBlob = blob;\n            this.latestUrl = URL.createObjectURL(blob);\n\n            const duration = (this.recordStopTime - this.recordStartTime) / 1000;\n\n            this._emit('recording-stop', {\n                blob,\n                url: this.latestUrl,\n                duration,\n                samples: this.pcmTotalSamples,\n                sampleRate: this.audioContext.sampleRate\n            });\n\n            return blob;\n\n        } catch (error) {\n            this._emit('error', { stage: 'stop-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 暫停錄音（僅 RecordRTC 模式支援）\n     */\n    pauseRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        if (this.usingWorklet) {\n            throw new Error('AudioWorklet 模式不支援暫停功能');\n        }\n\n        if (this.recorder && typeof this.recorder.pauseRecording === 'function') {\n            this.recorder.pauseRecording();\n            this.isPaused = true;\n            this._emit('recording-paused', { timestamp: Date.now() });\n        } else {\n            throw new Error('暫停功能不可用');\n        }\n    }\n\n    /**\n     * 繼續錄音（僅 RecordRTC 模式支援）\n     */\n    resumeRecording() {\n        if (!this.isPaused) {\n            throw new Error('錄音沒有暫停');\n        }\n\n        if (this.recorder && typeof this.recorder.resumeRecording === 'function') {\n            this.recorder.resumeRecording();\n            this.isPaused = false;\n            this._emit('recording-resumed', { timestamp: Date.now() });\n        } else {\n            throw new Error('繼續錄音功能不可用');\n        }\n    }\n\n    /**\n     * 取得最新的錄音數據\n     * @returns {Object} { blob, url, duration, samples }\n     */\n    getLatestRecording() {\n        return {\n            blob: this.latestBlob,\n            url: this.latestUrl,\n            duration: this.latestBlob ? (this.recordStopTime - this.recordStartTime) / 1000 : 0,\n            samples: this.pcmTotalSamples,\n            sampleRate: this.audioContext ? this.audioContext.sampleRate : 0\n        };\n    }\n\n    /**\n     * 取得 PCM 數據視窗（僅 AudioWorklet 模式）\n     * @param {number} start - 起始樣本索引\n     * @param {number} count - 樣本數量\n     * @returns {Float32Array|null}\n     */\n    getPcmWindow(start, count) {\n        if (!this.usingWorklet || !this.pcmChunks.length) {\n            return null;\n        }\n\n        if (start < 0) start = 0;\n        const total = this.pcmTotalSamples;\n        if (start >= total) return new Float32Array(0);\n\n        const end = Math.min(total, start + count);\n        const out = new Float32Array(end - start);\n        let offset = 0;\n        let passed = 0;\n\n        for (let i = 0; i < this.pcmChunks.length && passed < end; i++) {\n            const chunk = this.pcmChunks[i];\n            if (!chunk || !chunk.length) continue;\n\n            const cLen = chunk.length;\n            const cStart = passed;\n            const cEnd = passed + cLen;\n\n            if (cEnd <= start) {\n                passed = cEnd;\n                continue;\n            }\n\n            const segStart = Math.max(start, cStart);\n            const segEnd = Math.min(end, cEnd);\n\n            if (segEnd > segStart) {\n                const localStart = segStart - cStart;\n                const slice = chunk.subarray(localStart, localStart + (segEnd - segStart));\n                out.set(slice, offset);\n                offset += slice.length;\n            }\n\n            passed = cEnd;\n            if (segEnd >= end) break;\n        }\n\n        return out;\n    }\n\n    /**\n     * 取得 Analyser 節點（供外部波形顯示使用）\n     * @returns {AnalyserNode|null}\n     */\n    getAnalyser() {\n        return this.analyser;\n    }\n\n    /**\n     * 取得 AudioContext\n     * @returns {AudioContext|null}\n     */\n    getAudioContext() {\n        return this.audioContext;\n    }\n\n    /**\n     * 取得麥克風媒體流\n     * @returns {MediaStream|null}\n     */\n    get microphoneStream() {\n        return this.micStream;\n    }\n\n    /**\n     * 設定前級增益\n     * @param {number} gain - 增益值 (1.0-6.0)\n     */\n    setMicGain(gain) {\n        gain = Math.max(1.0, Math.min(6.0, gain));\n        this.config.micGain = gain;\n\n        if (this.preGainNode) {\n            this.preGainNode.gain.value = gain;\n        }\n\n        this._emit('mic-gain-changed', { gain });\n    }\n\n    /**\n     * 釋放資源\n     */\n    dispose() {\n        if (this.isRecording) {\n            this.stopRecording().catch(console.error);\n        }\n\n        this._stopMicrophone();\n        this._stopPcmCapture();\n\n        if (this.latestUrl) {\n            URL.revokeObjectURL(this.latestUrl);\n            this.latestUrl = null;\n        }\n\n        if (this.audioContext) {\n            this.audioContext.close().catch(console.error);\n            this.audioContext = null;\n        }\n\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n        this.pcmCollectorNode = null;\n        this.recorder = null;\n\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        this.isInitialized = false;\n\n        this._emit('disposed');\n    }\n\n    // ============================================================\n    // 事件系統\n    // ============================================================\n\n    /**\n     * 註冊事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    on(event, handler) {\n        if (!this._eventListeners[event]) {\n            this._eventListeners[event] = [];\n        }\n        this._eventListeners[event].push(handler);\n    }\n\n    /**\n     * 移除事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    off(event, handler) {\n        if (!this._eventListeners[event]) return;\n\n        const index = this._eventListeners[event].indexOf(handler);\n        if (index > -1) {\n            this._eventListeners[event].splice(index, 1);\n        }\n    }\n\n    /**\n     * 觸發事件（內部使用）\n     * @private\n     */\n    _emit(event, data) {\n        if (!this._eventListeners[event]) return;\n\n        this._eventListeners[event].forEach(handler => {\n            try {\n                handler(data);\n            } catch (error) {\n                console.error(`事件處理器錯誤 [${event}]:`, error);\n            }\n        });\n    }\n\n    // ============================================================\n    // 私有方法 - 麥克風捕獲\n    // ============================================================\n\n    async _captureMicrophone() {\n        const constraints = {\n            audio: {\n                echoCancellation: this.config.echoCancellation,\n                noiseSuppression: this.config.noiseSuppression,\n                autoGainControl: this.config.autoGainControl\n            },\n            video: false\n        };\n\n        // 加入設備 ID 限制（如果有指定）\n        if (this.config.deviceId) {\n            constraints.audio.deviceId = { exact: this.config.deviceId };\n        }\n\n        try {\n            this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n            // iOS 自動增益調整\n            this._applyIOSMicGainAdjustment();\n\n            // 連接麥克風到前級增益節點\n            const source = this.audioContext.createMediaStreamSource(this.micStream);\n            source.connect(this.preGainNode);\n\n            this._emit('microphone-captured', {\n                deviceId: this.config.deviceId,\n                constraints\n            });\n\n        } catch (error) {\n            // 如果指定設備失敗，嘗試使用預設設備\n            if (error.name === 'OverconstrainedError' || error.name === 'NotFoundError') {\n                console.warn('指定的麥克風無法使用，嘗試預設設備');\n\n                delete constraints.audio.deviceId;\n                this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n                this._applyIOSMicGainAdjustment();\n\n                const source = this.audioContext.createMediaStreamSource(this.micStream);\n                source.connect(this.preGainNode);\n\n                this._emit('microphone-captured-fallback', { constraints });\n            } else {\n                throw error;\n            }\n        }\n    }\n\n    _stopMicrophone() {\n        if (this.micStream) {\n            this.micStream.getTracks().forEach(track => {\n                try {\n                    track.stop();\n                } catch (error) {\n                    console.warn('停止麥克風軌道失敗:', error);\n                }\n            });\n            this.micStream = null;\n        }\n    }\n\n    _applyIOSMicGainAdjustment() {\n        // iOS 上 AGC 關閉時音量偏低，自動提升增益\n        try {\n            const ua = navigator.userAgent || '';\n            const isIOS = /iphone|ipad|ipod/i.test(ua);\n\n            if (isIOS && !this.config.autoGainControl) {\n                if (Math.abs(this.config.micGain - 1.0) < 0.0001) {\n                    this.setMicGain(3.5);\n                    this._emit('ios-gain-adjusted', { gain: 3.5 });\n                }\n            }\n        } catch (error) {\n            console.warn('iOS 增益調整失敗:', error);\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - AudioWorklet 錄音\n    // ============================================================\n\n    async _startWorkletRecording() {\n        try {\n            // 創建 AudioWorkletNode\n            this.pcmCollectorNode = new AudioWorkletNode(\n                this.audioContext,\n                'pcm-collector-processor'\n            );\n\n            // 監聽 PCM 數據\n            this.pcmCollectorNode.port.onmessage = (event) => {\n                const { type, pcmData } = event.data;\n\n                if (type === 'pcm-data' && pcmData) {\n                    this.pcmChunks.push(new Float32Array(pcmData));\n                    this.pcmTotalSamples += pcmData.length;\n\n                    this._emit('data-available', {\n                        pcmData: new Float32Array(pcmData),\n                        totalSamples: this.pcmTotalSamples,\n                        mode: 'worklet'\n                    });\n                }\n            };\n\n            // 連接節點：preGain -> pcmCollector -> analyser\n            this.preGainNode.connect(this.pcmCollectorNode);\n            this.pcmCollectorNode.connect(this.audioContext.destination);\n\n            this.usingWorklet = true;\n\n        } catch (error) {\n            console.error('AudioWorklet 啟動失敗，回退到 RecordRTC:', error);\n            this.usingWorklet = false;\n            await this._startRecordRTCRecording();\n        }\n    }\n\n    async _stopWorkletRecording() {\n        try {\n            // 斷開 AudioWorkletNode\n            if (this.pcmCollectorNode) {\n                this.pcmCollectorNode.port.onmessage = null;\n                this.preGainNode.disconnect(this.pcmCollectorNode);\n                this.pcmCollectorNode.disconnect();\n                this.pcmCollectorNode = null;\n            }\n\n            // 合併 PCM 數據並轉換為 WAV\n            if (this.pcmChunks.length === 0) {\n                throw new Error('沒有錄音數據');\n            }\n\n            const merged = new Float32Array(this.pcmTotalSamples);\n            let offset = 0;\n\n            for (const chunk of this.pcmChunks) {\n                merged.set(chunk, offset);\n                offset += chunk.length;\n            }\n\n            // 轉換為 16-bit PCM WAV\n            const wavBuffer = this._buildWavFromFloat32Mono(\n                merged,\n                this.audioContext.sampleRate\n            );\n\n            const blob = new Blob([wavBuffer], { type: 'audio/wav' });\n\n            this.usingWorklet = false;\n\n            return blob;\n\n        } catch (error) {\n            console.error('AudioWorklet 停止失敗:', error);\n            throw error;\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - RecordRTC 錄音\n    // ============================================================\n\n    async _startRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                // 檢查 RecordRTC 是否可用\n                if (typeof RecordRTC === 'undefined') {\n                    reject(new Error('RecordRTC 未載入'));\n                    return;\n                }\n\n                const recordStream = this.mediaDest.stream || this.micStream;\n\n                this.recorder = RecordRTC(recordStream, {\n                    type: 'audio',\n                    mimeType: 'audio/wav',\n                    recorderType: StereoAudioRecorder,\n                    numberOfAudioChannels: 1,\n                    bufferSize: 4096,\n                    timeSlice: 100,\n                    ondataavailable: (blob) => {\n                        this._emit('data-available', {\n                            blob,\n                            mode: 'recordrtc'\n                        });\n                    }\n                });\n\n                this.recorder.startRecording();\n                this.usingWorklet = false;\n\n                // 啟動 PCM 數據採集循環（用於累積波形）\n                this._startPcmCapture();\n\n                resolve();\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    async _stopRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                if (!this.recorder) {\n                    reject(new Error('RecordRTC 錄音器不存在'));\n                    return;\n                }\n\n                // 停止 PCM 數據採集循環\n                this._stopPcmCapture();\n\n                this.recorder.stopRecording(() => {\n                    try {\n                        const blob = this.recorder.getBlob();\n\n                        // 清理錄音器\n                        this.recorder = null;\n\n                        resolve(blob);\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    /**\n     * 啟動 PCM 數據採集（RecordRTC 模式使用）\n     * @private\n     */\n    _startPcmCapture() {\n        if (!this.analyser) return;\n\n        const bufferLength = this.analyser.fftSize;\n        const dataArray = new Float32Array(bufferLength);\n        \n        // 每 100ms 採集一次 PCM 數據\n        this._pcmCaptureInterval = setInterval(() => {\n            if (!this.isRecording || !this.analyser) {\n                return;\n            }\n\n            // 從 AnalyserNode 讀取時域數據\n            this.analyser.getFloatTimeDomainData(dataArray);\n            \n            // 複製數據以避免被覆蓋\n            const pcmChunk = new Float32Array(dataArray);\n            \n            // 儲存到 pcmChunks\n            this.pcmChunks.push(pcmChunk);\n            this.pcmTotalSamples += pcmChunk.length;\n\n            // 發送事件給 WaveformRenderer\n            this._emit('data-available', {\n                pcmData: pcmChunk,\n                totalSamples: this.pcmTotalSamples,\n                mode: 'recordrtc-pcm'\n            });\n        }, 100);\n    }\n\n    /**\n     * 停止 PCM 數據採集\n     * @private\n     */\n    _stopPcmCapture() {\n        if (this._pcmCaptureInterval) {\n            clearInterval(this._pcmCaptureInterval);\n            this._pcmCaptureInterval = null;\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - WAV 格式轉換\n    // ============================================================\n\n    _buildWavFromFloat32Mono(float32Data, sampleRate) {\n        const numSamples = float32Data.length;\n        const buffer = new ArrayBuffer(44 + numSamples * 2);\n        const view = new DataView(buffer);\n\n        // WAV Header\n        this._writeString(view, 0, 'RIFF');\n        view.setUint32(4, 36 + numSamples * 2, true);\n        this._writeString(view, 8, 'WAVE');\n        this._writeString(view, 12, 'fmt ');\n        view.setUint32(16, 16, true); // fmt chunk size\n        view.setUint16(20, 1, true);  // audio format (PCM)\n        view.setUint16(22, 1, true);  // number of channels\n        view.setUint32(24, sampleRate, true);\n        view.setUint32(28, sampleRate * 2, true); // byte rate\n        view.setUint16(32, 2, true);  // block align\n        view.setUint16(34, 16, true); // bits per sample\n        this._writeString(view, 36, 'data');\n        view.setUint32(40, numSamples * 2, true);\n\n        // PCM Data (float32 -> int16)\n        let offset = 44;\n        for (let i = 0; i < numSamples; i++) {\n            const sample = Math.max(-1, Math.min(1, float32Data[i]));\n            const int16 = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;\n            view.setInt16(offset, int16, true);\n            offset += 2;\n        }\n\n        return buffer;\n    }\n\n    _writeString(view, offset, string) {\n        for (let i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n}\n\nexport default AudioEngine;\n","/**\n * WaveformRenderer.js\n * 波形渲染模組 - 整合即時波形、累積波形、概覽波形和 VU Meter\n * \n * @module WaveformRenderer\n * @description 提供完整的波形可視化功能，包含：\n * - LiveWaveform: 即時波形顯示（從 AnalyserNode）\n * - VUMeter: 音量表顯示（RMS/Peak dBFS）\n * - AccumulatedWaveform: 累積波形（使用 Worker 加速）\n * - OverviewWaveform: 全局概覽波形\n */\n\n/**\n * WaveformRenderer - 波形渲染管理器\n * 統一管理所有波形組件的初始化、更新和銷毀\n */\nexport class WaveformRenderer {\n    /**\n     * @param {Object} options - 配置選項\n     * @param {HTMLCanvasElement} options.liveCanvas - 即時波形 Canvas\n     * @param {HTMLCanvasElement} options.vuMeterCanvas - VU Meter Canvas\n     * @param {HTMLCanvasElement} options.accumulatedCanvas - 累積波形 Canvas\n     * @param {HTMLCanvasElement} options.overviewCanvas - 概覽波形 Canvas\n     * @param {AnalyserNode} options.analyserNode - Web Audio AnalyserNode\n     * @param {Object} options.audioEngine - AudioEngine 實例（可選，會自動獲取 analyserNode）\n     * @param {string} [options.workerPath] - Worker 腳本路徑\n     * @param {boolean} [options.useWorker=true] - 是否使用 Worker\n     * @param {boolean} [options.showClipMarks=true] - 是否顯示削波標記\n     */\n    constructor(options = {}) {\n        this.options = {\n            workerPath: options.workerPath || 'workers/wf-worker.js',\n            useWorker: options.useWorker !== false,\n            showClipMarks: options.showClipMarks !== false,\n            ...options\n        };\n        \n        // 支援從 audioEngine 獲取 analyserNode\n        this.audioEngine = options.audioEngine;\n        \n        this.liveWaveform = null;\n        this.vuMeter = null;\n        this.accumulatedWaveform = null;\n        this.overviewWaveform = null;\n        \n        this.isVerticalMode = false;\n        this._overviewUpdateScheduled = false;\n        \n        // 如果提供了 audioEngine，監聽錄音事件\n        if (this.audioEngine) {\n            this._setupAudioEngineListeners();\n        }\n    }\n    \n    /**\n     * 設置 AudioEngine 事件監聽\n     * @private\n     */\n    _setupAudioEngineListeners() {\n        if (!this.audioEngine) return;\n        \n        // 錄音開始時自動啟動波形\n        this.audioEngine.on('recording-start', () => {\n            this.start();\n        });\n        \n        // 錄音停止時停止波形\n        this.audioEngine.on('recording-stop', () => {\n            this.stopLive();\n        });\n        \n        // PCM 數據到達時更新累積波形\n        this.audioEngine.on('data-available', (data) => {\n            if (data.pcmData && this.accumulatedWaveform) {\n                this.appendPCM(data.pcmData);\n            }\n        });\n    }\n    \n    /**\n     * 初始化所有波形組件\n     */\n    async initialize() {\n        const { liveCanvas, vuMeterCanvas, accumulatedCanvas, overviewCanvas } = this.options;\n        \n        // 從 audioEngine 或 options 獲取 analyserNode\n        let analyserNode = this.options.analyserNode;\n        if (!analyserNode && this.audioEngine && typeof this.audioEngine.getAnalyser === 'function') {\n            analyserNode = this.audioEngine.getAnalyser();\n        }\n        \n        // 初始化即時波形\n        if (liveCanvas && analyserNode) {\n            this.liveWaveform = new LiveWaveform(liveCanvas, analyserNode);\n        }\n        \n        // 初始化 VU Meter\n        if (vuMeterCanvas && analyserNode) {\n            this.vuMeter = new VUMeter(vuMeterCanvas, analyserNode);\n        }\n        \n        // 初始化累積波形\n        if (accumulatedCanvas) {\n            this.accumulatedWaveform = new AccumulatedWaveform(accumulatedCanvas, {\n                workerPath: this.options.workerPath,\n                useWorker: this.options.useWorker,\n                showClipMarks: this.options.showClipMarks\n            });\n        }\n        \n        // 初始化概覽波形\n        if (overviewCanvas && this.accumulatedWaveform) {\n            this.overviewWaveform = new OverviewWaveform(overviewCanvas, this.accumulatedWaveform);\n        }\n    }\n    \n    /**\n     * 開始即時波形顯示\n     * @param {MediaStream} stream - 麥克風媒體流\n     * @param {AudioContext} audioContext - Web Audio Context\n     * @param {GainNode} [preGainNode] - 前級增益節點（可選）\n     */\n    startLive(stream, audioContext, preGainNode) {\n        if (this.liveWaveform) {\n            this.liveWaveform.start(stream, audioContext, preGainNode);\n        }\n        if (this.vuMeter) {\n            this.vuMeter.start();\n        }\n    }\n    \n    /**\n     * 開始波形顯示（簡化版，從 audioEngine 自動獲取資訊）\n     */\n    start() {\n        if (!this.audioEngine) {\n            console.warn('No audioEngine provided, cannot start waveform rendering');\n            return;\n        }\n        \n        // 獲取必要資訊\n        const stream = this.audioEngine.microphoneStream;\n        const audioContext = this.audioEngine.audioContext;\n        const preGainNode = this.audioEngine.preGainNode;\n        \n        if (stream && audioContext) {\n            this.startLive(stream, audioContext, preGainNode);\n        }\n    }\n    \n    /**\n     * 停止即時波形顯示\n     */\n    stopLive() {\n        if (this.liveWaveform) {\n            this.liveWaveform.stop();\n        }\n        if (this.vuMeter) {\n            this.vuMeter.stop();\n        }\n    }\n    \n    /**\n     * 附加 PCM 數據到累積波形\n     * @param {Float32Array} pcmData - PCM 音訊數據\n     */\n    appendPCM(pcmData) {\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.append(pcmData);\n            \n            // 同時更新 OverviewWaveform\n            if (this.overviewWaveform) {\n                // 使用 requestAnimationFrame 避免過度繪製\n                if (!this._overviewUpdateScheduled) {\n                    this._overviewUpdateScheduled = true;\n                    requestAnimationFrame(() => {\n                        if (this.overviewWaveform) {\n                            this.overviewWaveform.draw();\n                        }\n                        this._overviewUpdateScheduled = false;\n                    });\n                }\n            }\n        }\n    }\n    \n    /**\n     * 重置所有波形\n     */\n    reset() {\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.reset();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.clear();\n        }\n    }\n    \n    /**\n     * 清除所有波形\n     */\n    clear() {\n        if (this.liveWaveform) {\n            this.liveWaveform.canvasContext.clearRect(0, 0, this.liveWaveform.width, this.liveWaveform.height);\n        }\n        if (this.vuMeter) {\n            this.vuMeter.clear();\n        }\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.clear();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.clear();\n        }\n    }\n    \n    /**\n     * 設定垂直/水平模式\n     * @param {boolean} isVertical - 是否為垂直模式\n     */\n    setVerticalMode(isVertical) {\n        this.isVerticalMode = isVertical;\n        \n        // 通知 Worker 模式變更\n        if (this.accumulatedWaveform && this.accumulatedWaveform._worker) {\n            this.accumulatedWaveform._worker.postMessage({\n                type: 'setVerticalMode',\n                verticalMode: isVertical\n            });\n        }\n    }\n    \n    /**\n     * 調整 Canvas 尺寸\n     */\n    resize() {\n        if (this.liveWaveform) {\n            this.liveWaveform.width = this.liveWaveform.canvas.width;\n            this.liveWaveform.height = this.liveWaveform.canvas.height;\n        }\n        if (this.vuMeter) {\n            this.vuMeter.resize();\n        }\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.width = this.accumulatedWaveform.canvas.width;\n            this.accumulatedWaveform.height = this.accumulatedWaveform.canvas.height;\n            if (this.accumulatedWaveform._worker) {\n                this.accumulatedWaveform._worker.postMessage({\n                    type: 'resize',\n                    width: this.accumulatedWaveform.width,\n                    height: this.accumulatedWaveform.height\n                });\n            }\n            this.accumulatedWaveform.draw();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.width = this.overviewWaveform.canvas.width;\n            this.overviewWaveform.height = this.overviewWaveform.canvas.height;\n            this.overviewWaveform.draw();\n        }\n    }\n    \n    /**\n     * 銷毀所有組件，釋放資源\n     */\n    destroy() {\n        this.stopLive();\n        \n        if (this.accumulatedWaveform && this.accumulatedWaveform._worker) {\n            this.accumulatedWaveform._worker.terminate();\n        }\n        \n        this.liveWaveform = null;\n        this.vuMeter = null;\n        this.accumulatedWaveform = null;\n        this.overviewWaveform = null;\n    }\n}\n\n/* ================================================================\n * LiveWaveform 類 - 即時波形顯示\n * 從 AnalyserNode 取得時域數據並即時繪製波形\n * 支援水平和垂直模式\n * ================================================================ */\nexport class LiveWaveform {\n    constructor(canvas, analyserNode) {\n        this.canvas = canvas;\n        this.canvasContext = canvas.getContext('2d');\n        this.analyser = analyserNode;\n        this.mediaStreamSource = null;\n        this.animationId = null;\n        this.isRunning = false;\n\n        this.width = canvas.width;\n        this.height = canvas.height;\n\n        this.bufferLength = 0;\n        this.dataArray = null;\n        \n        this.amplification = 3.0;\n\n        this._lastDataArray = null;\n        this._verticalScrollOffset = 0;\n    }\n\n    /**\n     * 開始即時波形顯示\n     * @param {MediaStream} stream - 麥克風媒體流\n     * @param {AudioContext} audioContext - Web Audio Context\n     * @param {GainNode} [preGainNode] - 前級增益節點（可選）\n     */\n    start(stream, audioContext, preGainNode) {\n        if (this.isRunning || !audioContext || !this.analyser) {\n            console.warn('LiveWaveform.start() 條件不滿足:', {\n                isRunning: this.isRunning,\n                hasAudioContext: !!audioContext,\n                hasAnalyser: !!this.analyser\n            });\n            return;\n        }\n\n        console.log('✅ LiveWaveform 開始啟動...');\n        this.isRunning = true;\n        \n        const self = this;\n\n        // 確保 AudioContext 處於運行狀態\n        let contextReady = Promise.resolve();\n        if (audioContext.state === 'suspended') {\n            contextReady = audioContext.resume().catch(function(err) {\n                console.warn('Unable to resume AudioContext:', err);\n            });\n        }\n\n        // 等待 AudioContext 就緒後再連接麥克風\n        contextReady.then(function() {\n            // 為避免重複連線先清除舊的 source\n            if (self.mediaStreamSource) {\n                self.mediaStreamSource.disconnect();\n            }\n\n            // 連接麥克風\n            self.mediaStreamSource = audioContext.createMediaStreamSource(stream);\n            if (preGainNode) {\n                try { \n                    self.mediaStreamSource.connect(preGainNode); \n                } catch(e) { \n                    console.warn('connect preGainNode failed', e); \n                }\n            } else {\n                self.mediaStreamSource.connect(self.analyser);\n            }\n\n            // 設定 FFT 參數\n            self.analyser.fftSize = 1024;\n            self.bufferLength = self.analyser.fftSize;\n            self.dataArray = new Uint8Array(self.bufferLength);\n\n            console.log('✅ LiveWaveform 音訊連接完成，開始繪製');\n            \n            // 立即開始繪製\n            self.draw(false); // false = 水平模式\n        });\n    }\n\n    /**\n     * 停止即時波形顯示\n     */\n    stop() {\n        if (!this.isRunning) return;\n        \n        this.isRunning = false;\n        \n        if (this.mediaStreamSource) {\n            this.mediaStreamSource.disconnect();\n            this.mediaStreamSource = null;\n        }\n\n        if (this.animationId) {\n            cancelAnimationFrame(this.animationId);\n            this.animationId = null;\n        }\n        \n        this.canvasContext.clearRect(0, 0, this.width, this.height);\n    }\n\n    /**\n     * 繪製波形（持續更新）\n     * @param {boolean} [isVertical=false] - 是否為垂直模式\n     */\n    draw(isVertical = false) {\n        if (!this.isRunning || !this.analyser || !this.dataArray) {\n            return;\n        }\n\n        this.animationId = requestAnimationFrame(() => this.draw(isVertical));\n\n        this.analyser.getByteTimeDomainData(this.dataArray);\n\n        if (!isVertical) {\n            // 水平模式\n            this.canvasContext.fillStyle = '#f0f0f0';\n            this.canvasContext.fillRect(0, 0, this.width, this.height);\n\n            this.canvasContext.lineWidth = 2;\n            this.canvasContext.strokeStyle = '#1E88E5';\n            this.canvasContext.beginPath();\n\n            const sliceWidth = this.width / this.bufferLength;\n            let x = 0;\n\n            for (let i = 0; i < this.bufferLength; i++) {\n                const v = (this.dataArray[i] / 128.0 - 1) * this.amplification;\n                const y = (v * this.height / 2) + (this.height / 2);\n\n                if (i === 0) {\n                    this.canvasContext.moveTo(x, y);\n                } else {\n                    this.canvasContext.lineTo(x, y);\n                }\n\n                x += sliceWidth;\n            }\n\n            this.canvasContext.lineTo(this.width, this.height / 2);\n            this.canvasContext.stroke();\n        } else {\n            // 垂直模式（滾動繪製）\n            const scrollSpeed = 2;\n            this._verticalScrollOffset += scrollSpeed;\n            \n            if (this._verticalScrollOffset >= this.height) {\n                this._verticalScrollOffset = 0;\n                this.canvasContext.fillStyle = '#f0f0f0';\n                this.canvasContext.fillRect(0, 0, this.width, this.height);\n            }\n\n            this.canvasContext.lineWidth = 1.5;\n            this.canvasContext.strokeStyle = '#1E88E5';\n            this.canvasContext.beginPath();\n\n            const sliceHeight = this.height / this.bufferLength;\n            let y = 0;\n\n            for (let i = 0; i < this.bufferLength; i++) {\n                const v = (this.dataArray[i] / 128.0 - 1) * this.amplification;\n                const x = (v * this.width / 2) + (this.width / 2);\n\n                if (i === 0) {\n                    this.canvasContext.moveTo(x, y);\n                } else {\n                    this.canvasContext.lineTo(x, y);\n                }\n\n                y += sliceHeight;\n            }\n\n            this.canvasContext.stroke();\n        }\n    }\n}\n\n/* ================================================================\n * VUMeter 類 - 即時音量 (RMS/Peak) 顯示\n * 計算 RMS 與 Peak，轉換為 dB 值 (-90dB ~ 0dB)\n * 提供 peak hold 功能：峰值維持一段時間後緩降\n * ================================================================ */\nexport class VUMeter {\n    constructor(canvas, analyserNode) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d');\n        this.analyser = analyserNode;\n        this.bufferLength = 2048;\n        this.timeData = new Float32Array(this.bufferLength);\n        this.levelDb = -90;\n        this.peakDb = -90;\n        this.holdPeakDb = -90;\n        this.lastPeakTime = 0;\n        this.peakHoldMillis = 1500;\n        this.fallRateDbPerSec = 20;\n        this.minDb = -90;\n        this.maxDb = 0;\n        this.animationId = null;\n        this.lastClipTime = 0;\n        this.clipHoldMillis = 2000;\n        this._lastLogTime = 0;\n    }\n\n    _computeLevels() {\n        if (!this.analyser) return { rmsDb: this.minDb, peakDb: this.minDb };\n        \n        const required = this.analyser.fftSize || this.bufferLength;\n        if (this.timeData.length !== required) {\n            this.bufferLength = required;\n            this.timeData = new Float32Array(required);\n        }\n        \n        this.analyser.getFloatTimeDomainData(this.timeData);\n        let sumSquares = 0;\n        let peak = 0;\n        let clipped = false;\n        \n        for (let i = 0; i < this.bufferLength; i++) {\n            let v = this.timeData[i];\n            if (v > 1) v = 1;\n            else if (v < -1) v = -1;\n            sumSquares += v * v;\n            const absV = Math.abs(v);\n            if (absV > peak) peak = absV;\n            if (absV >= 0.995) clipped = true;\n        }\n        \n        const rms = Math.sqrt(sumSquares / this.bufferLength);\n        let rmsDb = rms > 0 ? 20 * Math.log10(rms) : -Infinity;\n        let peakDb = peak > 0 ? 20 * Math.log10(peak) : -Infinity;\n        \n        if (rmsDb < this.minDb) rmsDb = this.minDb;\n        if (rmsDb > this.maxDb) rmsDb = this.maxDb;\n        if (peakDb < this.minDb) peakDb = this.minDb;\n        if (peakDb > this.maxDb) peakDb = this.maxDb;\n        \n        if (clipped) {\n            this.lastClipTime = performance.now ? performance.now() : Date.now();\n        }\n        \n        return { rmsDb, peakDb };\n    }\n\n    resize() {\n        this.clear();\n    }\n\n    clear() {\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    draw(currentDb) {\n        const ctx = this.ctx;\n        const w = this.canvas.width;\n        const h = this.canvas.height;\n        \n        // 背景\n        ctx.clearRect(0, 0, w, h);\n        const grd = ctx.createLinearGradient(0, 0, w, 0);\n        grd.addColorStop(0, '#2d3748');\n        grd.addColorStop(1, '#1a202c');\n        ctx.fillStyle = grd;\n        ctx.fillRect(0, 0, w, h);\n\n        // dB 對應到 0~1\n        let norm = (currentDb - this.minDb) / (this.maxDb - this.minDb);\n        if (norm < 0) norm = 0;\n        if (norm > 1) norm = 1;\n\n        // 彩色漸層 (綠->黃->紅)\n        const barGrad = ctx.createLinearGradient(0, 0, w, 0);\n        barGrad.addColorStop(0, '#38a169');\n        barGrad.addColorStop(0.6, '#d69e2e');\n        barGrad.addColorStop(0.85, '#dd6b20');\n        barGrad.addColorStop(1, '#c53030');\n        ctx.fillStyle = barGrad;\n        const barWidth = Math.round(w * norm);\n        ctx.fillRect(0, 0, barWidth, h);\n\n        // 刻度線\n        ctx.save();\n        ctx.strokeStyle = 'rgba(255,255,255,0.15)';\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        \n        for (let db = this.minDb; db <= this.maxDb; db += 10) {\n            const posNorm = (db - this.minDb) / (this.maxDb - this.minDb);\n            const xPos = Math.round(w * posNorm) + 0.5;\n            \n            if (db === 0) {\n                ctx.strokeStyle = 'rgba(255,255,255,0.35)';\n                ctx.beginPath();\n                ctx.moveTo(xPos, 0);\n                ctx.lineTo(xPos, h);\n                ctx.stroke();\n                ctx.strokeStyle = 'rgba(255,255,255,0.15)';\n            } else {\n                ctx.moveTo(xPos, 0);\n                ctx.lineTo(xPos, h * 0.4);\n                ctx.moveTo(xPos, h);\n                ctx.lineTo(xPos, h * 0.6);\n            }\n            \n            if (db % 20 === 0 || db === -10) {\n                const label = db.toString();\n                ctx.fillStyle = (db === 0) ? '#ffffff' : (db === -10 ? '#ffeb3b' : '#cbd5e0');\n                ctx.font = '10px -apple-system,Segoe UI,sans-serif';\n                ctx.textAlign = 'center';\n                ctx.textBaseline = 'top';\n                ctx.fillText(label, xPos, 1);\n            }\n        }\n        ctx.restore();\n\n        // -10dBFS 區域高亮\n        const minus10Norm = (-10 - this.minDb) / (this.maxDb - this.minDb);\n        if (minus10Norm > 0 && minus10Norm < 1) {\n            const minus10X = Math.round(w * minus10Norm);\n            ctx.save();\n            ctx.fillStyle = 'rgba(255,235,59,0.08)';\n            ctx.fillRect(minus10X - 2, 0, 4, h);\n            ctx.restore();\n        }\n\n        // 峰值 hold 指示線\n        let holdNorm = (this.holdPeakDb - this.minDb) / (this.maxDb - this.minDb);\n        if (holdNorm < 0) holdNorm = 0;\n        if (holdNorm > 1) holdNorm = 1;\n        const holdX = Math.round(w * holdNorm);\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        ctx.moveTo(holdX + 0.5, 0);\n        ctx.lineTo(holdX + 0.5, h);\n        ctx.stroke();\n\n        // 文字顯示\n        ctx.fillStyle = '#f0f0f0';\n        ctx.font = 'bold 12px -apple-system,Segoe UI,sans-serif';\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'middle';\n        const displayRms = currentDb <= this.minDb ? '-∞' : currentDb.toFixed(1);\n        const displayPeak = this.peakDb <= this.minDb ? '-∞' : this.peakDb.toFixed(1);\n        const txt = `RMS ${displayRms} dBFS   Peak ${displayPeak} dBFS`;\n        ctx.fillText(txt, 8, h / 2);\n\n        // CLIP 指示\n        const now = performance.now ? performance.now() : Date.now();\n        if (this.lastClipTime && (now - this.lastClipTime) < this.clipHoldMillis) {\n            ctx.save();\n            ctx.fillStyle = '#B00020';\n            const badgeW = 42, badgeH = 18;\n            ctx.fillRect(w - badgeW - 8, 4, badgeW, badgeH);\n            ctx.fillStyle = '#fff';\n            ctx.font = 'bold 12px -apple-system,Segoe UI,sans-serif';\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n            ctx.fillText('CLIP', w - badgeW / 2 - 8, 4 + badgeH / 2 + 0.5);\n            ctx.restore();\n        }\n    }\n\n    update() {\n        const levels = this._computeLevels();\n        this.levelDb = levels.rmsDb;\n        this.peakDb = levels.peakDb;\n\n        const now = performance.now();\n        \n        // 更新 peak hold\n        if (this.peakDb > this.holdPeakDb + 0.5) {\n            this.holdPeakDb = this.peakDb;\n            this.lastPeakTime = now;\n        } else {\n            const elapsed = now - this.lastPeakTime;\n            if (elapsed > this.peakHoldMillis) {\n                const fallSeconds = (elapsed - this.peakHoldMillis) / 1000;\n                const fallAmount = this.fallRateDbPerSec * fallSeconds;\n                this.holdPeakDb = Math.max(this.peakDb, this.holdPeakDb - fallAmount);\n            }\n        }\n        \n        this.draw(this.levelDb);\n    }\n\n    start() {\n        this.stop();\n        \n        if (this.analyser) {\n            const required = this.analyser.fftSize || 2048;\n            if (this.timeData.length !== required) {\n                this.bufferLength = required;\n                this.timeData = new Float32Array(required);\n            }\n        }\n        \n        const self = this;\n        function loop() {\n            self.update();\n            self.animationId = requestAnimationFrame(loop);\n        }\n        loop();\n    }\n\n    stop() {\n        if (this.animationId) {\n            cancelAnimationFrame(this.animationId);\n            this.animationId = null;\n        }\n        this.clear();\n    }\n}\n\n/* ================================================================\n * AccumulatedWaveform 類 - 累積音訊波形顯示\n * 持續繪製目前錄製完成的音訊波形\n * 支援 OffscreenCanvas + Worker 加速\n * 支援縮放、平移、播放位置顯示\n * ================================================================ */\nexport class AccumulatedWaveform {\n    constructor(canvas, options = {}) {\n        this.canvas = canvas;\n        this.canvasContext = null;\n        this.width = canvas.width;\n        this.height = canvas.height;\n\n        this.targetSampleRate = 5000;\n        this.sourceSampleRate = 48000;\n        this.decimationFactor = 10;\n\n        this.sampleMin = [];\n        this.sampleMax = [];\n        this.sampleCount = 0;\n\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        \n        this.playbackPosition = 0;\n        this.isPlaying = false;\n        this.playbackStartTime = 0;\n        this.playbackStartSample = 0;\n\n        this.rawZoomMode = false;\n        this.rawViewStart = 0;\n        this.rawVisibleRaw = 0;\n\n        this._useWorker = options.useWorker !== false;\n        this._worker = null;\n        this._appendBatchMin = [];\n        this._appendBatchMax = [];\n        this._appendFlushScheduled = false;\n        this.lastDetail = null;\n        this.lastDensity = null;\n        \n        // 嘗試使用 OffscreenCanvas + Worker\n        if (this._useWorker && canvas.transferControlToOffscreen && typeof Worker !== 'undefined') {\n            try {\n                const off = canvas.transferControlToOffscreen();\n                this._worker = new Worker(options.workerPath || 'workers/wf-worker.js');\n                \n                this._worker.postMessage({\n                    type: 'init',\n                    canvas: off,\n                    width: this.width,\n                    height: this.height,\n                    verticalMode: false,\n                    showClipMarks: options.showClipMarks !== false,\n                    sourceSampleRate: this.sourceSampleRate,\n                    decimationFactor: this.decimationFactor\n                }, [off]);\n                \n                const self = this;\n                this._worker.onmessage = function(ev) {\n                    const msg = ev.data;\n                    if (!msg) return;\n                    if (msg.type === 'detailUpdate') {\n                        self.lastDetail = msg.detail;\n                        self.lastDensity = msg.density;\n                    }\n                };\n            } catch(e) {\n                console.warn('OffscreenCanvas 初始化失敗，使用主線程繪製:', e);\n                this._useWorker = false;\n            }\n        } else {\n            this._useWorker = false;\n        }\n        \n        // 如果沒有使用 Worker，獲取 2D context\n        if (!this._useWorker) {\n            try {\n                this.canvasContext = canvas.getContext('2d');\n            } catch(e) {\n                console.warn('無法獲取 canvas context:', e);\n            }\n        }\n        \n        // 設置滑鼠互動\n        this._setupMouseInteraction();\n        \n        this.clear();\n    }\n    \n    /**\n     * 設置滑鼠互動（平移、縮放、點擊定位）\n     * @private\n     */\n    _setupMouseInteraction() {\n        if (!this.canvas) return;\n        \n        let isDragging = false;\n        let dragStartX = 0;\n        let dragStartViewStart = 0;\n        \n        // 滑鼠按下\n        this.canvas.addEventListener('mousedown', (e) => {\n            isDragging = true;\n            dragStartX = e.offsetX;\n            dragStartViewStart = this.viewStart;\n            this.isAutoScroll = false;\n            this.canvas.style.cursor = 'grabbing';\n        });\n        \n        // 滑鼠移動（拖曳）\n        this.canvas.addEventListener('mousemove', (e) => {\n            if (!isDragging) return;\n            \n            const deltaX = e.offsetX - dragStartX;\n            const info = this.getVisibleSamples();\n            const samplesPerPixel = info.visible / this.width;\n            const sampleDelta = Math.round(-deltaX * samplesPerPixel);\n            \n            this.viewStart = dragStartViewStart + sampleDelta;\n            this._enforceViewBounds();\n            this.draw();\n        });\n        \n        // 滑鼠放開\n        this.canvas.addEventListener('mouseup', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'grab';\n            }\n        });\n        \n        // 滑鼠離開 canvas\n        this.canvas.addEventListener('mouseleave', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'default';\n            }\n        });\n        \n        // 滑鼠滾輪（縮放）\n        this.canvas.addEventListener('wheel', (e) => {\n            e.preventDefault();\n            \n            // 計算滑鼠位置相對於 canvas 的比例\n            const rect = this.canvas.getBoundingClientRect();\n            const x = e.clientX - rect.left;\n            const anchorRatio = x / this.width;\n            \n            // 根據滾輪方向縮放\n            const zoomSteps = e.deltaY > 0 ? -1 : 1;\n            this.zoomBySteps(zoomSteps, anchorRatio);\n        });\n        \n        // 點擊定位（跳到播放位置）\n        this.canvas.addEventListener('click', (e) => {\n            if (isDragging) return; // 如果是拖曳結束，不觸發點擊\n            \n            const info = this.getVisibleSamples();\n            const clickRatio = e.offsetX / this.width;\n            const clickedSample = Math.floor(info.start + clickRatio * info.visible);\n            \n            // 觸發自定義事件，讓外部處理播放跳轉\n            const event = new CustomEvent('waveform-seek', {\n                detail: {\n                    sample: clickedSample,\n                    time: clickedSample / this.sourceSampleRate\n                }\n            });\n            this.canvas.dispatchEvent(event);\n        });\n        \n        // 設置 cursor 樣式\n        this.canvas.style.cursor = 'grab';\n    }\n\n    clear() {\n        if (this._useWorker && this._worker) {\n            this._worker.postMessage({ type: 'reset' });\n            return;\n        }\n        if (!this.canvasContext) return;\n        \n        this.canvasContext.clearRect(0, 0, this.width, this.height);\n        this.canvasContext.fillStyle = '#f0f0f0';\n        this.canvasContext.fillRect(0, 0, this.width, this.height);\n        this.canvasContext.lineWidth = 1;\n        this.canvasContext.strokeStyle = '#d0d0d0';\n        this.canvasContext.beginPath();\n        this.canvasContext.moveTo(0, this.height / 2);\n        this.canvasContext.lineTo(this.width, this.height / 2);\n        this.canvasContext.stroke();\n    }\n\n    reset() {\n        this.sampleMin.length = 0;\n        this.sampleMax.length = 0;\n        this.sampleCount = 0;\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        this.clear();\n    }\n\n    append(audioSamples) {\n        if (!audioSamples || !audioSamples.length) {\n            return;\n        }\n\n        const factor = this.decimationFactor;\n        const total = audioSamples.length;\n        const appendedMin = [];\n        const appendedMax = [];\n        \n        // 每秒記錄一次\n        if (!this._lastAppendLog) this._lastAppendLog = 0;\n        const now = Date.now();\n        if (now - this._lastAppendLog > 1000) {\n            console.log('📈 AccumulatedWaveform.append():', total, '樣本 →', \n                        Math.floor(total / factor), '區塊');\n            this._lastAppendLog = now;\n        }\n        \n        for (let i = 0; i < total; i += factor) {\n            let blockMin = 1.0;\n            let blockMax = -1.0;\n            let blockSum = 0;\n            let blockCount = 0;\n\n            for (let j = 0; j < factor && (i + j) < total; j++) {\n                const sample = audioSamples[i + j];\n                blockSum += sample;\n                blockCount++;\n            }\n\n            const blockMean = blockCount ? (blockSum / blockCount) : 0;\n\n            for (let k = 0; k < blockCount; k++) {\n                const centeredSample = audioSamples[i + k] - blockMean;\n                if (centeredSample < blockMin) {\n                    blockMin = centeredSample;\n                }\n                if (centeredSample > blockMax) {\n                    blockMax = centeredSample;\n                }\n            }\n\n            if (!blockCount) {\n                continue;\n            }\n\n            if (blockMin > blockMax) {\n                blockMin = blockMax = 0;\n            }\n\n            this.sampleMin.push(blockMin);\n            this.sampleMax.push(blockMax);\n            appendedMin.push(blockMin);\n            appendedMax.push(blockMax);\n            this.sampleCount++;\n        }\n\n        if (this.isAutoScroll) {\n            this.scrollToLatest();\n        } else {\n            this._enforceViewBounds();\n        }\n\n        if (this._useWorker && this._worker) {\n            this._appendBatchMin.push(...appendedMin);\n            this._appendBatchMax.push(...appendedMax);\n            if (!this._appendFlushScheduled) {\n                this._appendFlushScheduled = true;\n                const self = this;\n                const flush = () => self._flushAppendBatch();\n                if (typeof requestAnimationFrame === 'function') {\n                    requestAnimationFrame(flush);\n                } else {\n                    setTimeout(flush, 32);\n                }\n            }\n        }\n        \n        this.draw();\n    }\n\n    _flushAppendBatch() {\n        if (!this._worker || this._appendBatchMin.length === 0) {\n            this._appendFlushScheduled = false;\n            return;\n        }\n        \n        this._worker.postMessage({\n            type: 'append',\n            minArr: this._appendBatchMin,\n            maxArr: this._appendBatchMax\n        });\n        \n        this._appendBatchMin = [];\n        this._appendBatchMax = [];\n        this._appendFlushScheduled = false;\n    }\n\n    draw() {\n        if (this._useWorker && this._worker) {\n            this._worker.postMessage({\n                type: 'draw',\n                zoomFactor: this.zoomFactor,\n                viewStart: this.viewStart,\n                playbackPosition: this.playbackPosition,\n                isPlaying: this.isPlaying\n            });\n            return;\n        }\n        \n        if (!this.canvasContext) return;\n        \n        // 主線程繪製\n        this.clear();\n        \n        const total = this.sampleMin.length;\n        if (!total) return;\n        \n        const visibleSamples = Math.min(total, Math.round(total / this.zoomFactor));\n        const start = Math.min(this.viewStart, Math.max(0, total - visibleSamples));\n        const end = Math.min(total, start + visibleSamples);\n        const centerY = this.height / 2;\n        \n        // 繪製波形 - 批次處理\n        this.canvasContext.strokeStyle = '#1E88E5';\n        this.canvasContext.lineWidth = 1;\n        this.canvasContext.beginPath();\n        \n        for (let i = start; i < end; i++) {\n            const x = Math.floor(((i - start) / visibleSamples) * this.width) + 0.5;\n            const yMin = Math.floor(centerY - (this.sampleMax[i] * centerY * 0.95));\n            const yMax = Math.floor(centerY - (this.sampleMin[i] * centerY * 0.95));\n            \n            // 繪製垂直線段\n            this.canvasContext.moveTo(x, yMin);\n            this.canvasContext.lineTo(x, yMax);\n        }\n        \n        this.canvasContext.stroke();\n        \n        // 繪製中線\n        this.canvasContext.strokeStyle = '#d0d0d0';\n        this.canvasContext.lineWidth = 1;\n        this.canvasContext.beginPath();\n        this.canvasContext.moveTo(0, centerY + 0.5);\n        this.canvasContext.lineTo(this.width, centerY + 0.5);\n        this.canvasContext.stroke();\n    }\n\n    getVisibleSamples() {\n        const total = this.sampleCount;\n        if (total === 0) return { start: 0, end: 0, visible: 0 };\n        \n        const minVis = this._getMinVisibleSamples(total);\n        let visible = Math.max(minVis, Math.round(total / this.zoomFactor));\n        if (visible > total) visible = total;\n        \n        let start = this.viewStart;\n        if (start + visible > total) start = total - visible;\n        if (start < 0) start = 0;\n        \n        const end = Math.min(total, start + visible);\n        return { start, end, visible };\n    }\n\n    _getMinVisibleSamples(total) {\n        return Math.max(1, Math.floor(this.width / 2));\n    }\n\n    _enforceViewBounds() {\n        const info = this.getVisibleSamples();\n        this.viewStart = info.start;\n    }\n\n    scrollToLatest() {\n        const total = this.sampleCount;\n        if (total === 0) return;\n        \n        const minVis = this._getMinVisibleSamples(total);\n        let visible = Math.max(minVis, Math.round(total / this.zoomFactor));\n        if (visible > total) visible = total;\n        \n        this.viewStart = total - visible;\n        if (this.viewStart < 0) this.viewStart = 0;\n    }\n\n    setZoom(targetZoom, anchorSample) {\n        if (targetZoom < 1) targetZoom = 1;\n        const maxZoom = Math.max(1, this.sampleCount / this._getMinVisibleSamples(this.sampleCount));\n        if (targetZoom > maxZoom) targetZoom = maxZoom;\n        \n        const oldInfo = this.getVisibleSamples();\n        this.zoomFactor = targetZoom;\n        const newInfo = this.getVisibleSamples();\n        \n        if (typeof anchorSample === 'number' && anchorSample >= 0) {\n            const oldRatio = (anchorSample - oldInfo.start) / oldInfo.visible;\n            const desiredStart = anchorSample - oldRatio * newInfo.visible;\n            this.viewStart = Math.max(0, Math.min(this.sampleCount - newInfo.visible, desiredStart));\n        }\n        \n        this._enforceViewBounds();\n        this.draw();\n    }\n\n    zoomBySteps(stepCount, anchorRatio = 0.5) {\n        if (stepCount === 0) return;\n        \n        const zoomStep = 1.2;\n        const oldInfo = this.getVisibleSamples();\n        const anchorSample = oldInfo.start + anchorRatio * oldInfo.visible;\n        \n        let newZoom = this.zoomFactor;\n        if (stepCount > 0) {\n            newZoom *= Math.pow(zoomStep, stepCount);\n        } else {\n            newZoom /= Math.pow(zoomStep, -stepCount);\n        }\n        \n        this.setZoom(newZoom, anchorSample);\n    }\n\n    panBySamples(sampleDelta) {\n        if (sampleDelta === 0) return;\n        \n        this.isAutoScroll = false;\n        this.viewStart += sampleDelta;\n        this._enforceViewBounds();\n        this.draw();\n    }\n\n    panByPixels(pixelDelta) {\n        if (pixelDelta === 0) return;\n        \n        const info = this.getVisibleSamples();\n        const samplesPerPixel = info.visible / this.width;\n        const totalDelta = pixelDelta * samplesPerPixel + this._panRemainder;\n        const intDelta = Math.round(totalDelta);\n        this._panRemainder = totalDelta - intDelta;\n        \n        this.panBySamples(intDelta);\n    }\n\n    resetView() {\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        this.scrollToLatest();\n        this.draw();\n    }\n\n    setSourceSampleRate(sampleRate) {\n        this.sourceSampleRate = sampleRate || 48000;\n        this.decimationFactor = Math.max(1, Math.round(this.sourceSampleRate / this.targetSampleRate));\n        \n        if (this._worker) {\n            this._worker.postMessage({\n                type: 'setSampleRate',\n                sourceSampleRate: this.sourceSampleRate,\n                decimationFactor: this.decimationFactor\n            });\n        }\n    }\n\n    _getSamplePair(index) {\n        if (index < 0 || index >= this.sampleCount) {\n            return { min: 0, max: 0 };\n        }\n        return {\n            min: this.sampleMin[index],\n            max: this.sampleMax[index]\n        };\n    }\n\n    setPlaybackPosition(sampleIndex) {\n        this.playbackPosition = sampleIndex;\n        this.draw();\n    }\n\n    setRawZoomMode(enabled) {\n        this.rawZoomMode = !!enabled;\n    }\n\n    startPlayback(startSample, sampleRate) {\n        this.isPlaying = true;\n        this.playbackStartSample = startSample || 0;\n        this.playbackStartTime = performance.now ? performance.now() : Date.now();\n        this.playbackPosition = this.playbackStartSample;\n        \n        const self = this;\n        const sr = sampleRate || this.sourceSampleRate;\n        \n        function updatePosition() {\n            if (!self.isPlaying) return;\n            \n            const now = performance.now ? performance.now() : Date.now();\n            const elapsed = (now - self.playbackStartTime) / 1000;\n            const rawSamples = elapsed * sr;\n            const decimatedPos = self.playbackStartSample + Math.floor(rawSamples / self.decimationFactor);\n            \n            self.playbackPosition = decimatedPos;\n            self.draw();\n            \n            requestAnimationFrame(updatePosition);\n        }\n        \n        requestAnimationFrame(updatePosition);\n    }\n\n    stopPlayback() {\n        this.isPlaying = false;\n        this.playbackPosition = 0;\n        this.draw();\n    }\n\n    _updatePlaybackPosition() {\n        if (!this.isPlaying) return;\n        \n        const now = performance.now ? performance.now() : Date.now();\n        const elapsed = (now - this.playbackStartTime) / 1000;\n        const rawSamples = elapsed * this.sourceSampleRate;\n        const decimatedPos = this.playbackStartSample + Math.floor(rawSamples / this.decimationFactor);\n        \n        this.playbackPosition = decimatedPos;\n    }\n}\n\n/* ================================================================\n * OverviewWaveform 類 - 全局波形概覽\n * 顯示整個錄音的波形概覽，並標示當前可視範圍\n * ================================================================ */\nexport class OverviewWaveform {\n    constructor(canvas, accumulatedWaveform) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d');\n        this.accumulatedWaveform = accumulatedWaveform;\n        this.width = canvas.width;\n        this.height = canvas.height;\n        \n        // 暫時禁用 Worker 模式，使用主線程繪製\n        this._useWorker = false;\n        this._workerRef = null;\n        this._warnedNoData = false;\n        this._lastTotal = 0;\n        \n        // 設置滑鼠互動\n        this._setupMouseInteraction();\n        \n        // 注意：如果要啟用 Worker，需要確保 canvas 尚未獲取 context\n        // 且 accumulatedWaveform 已成功轉移其 canvas 控制權\n    }\n    \n    /**\n     * 設置滑鼠互動（點擊跳轉、拖曳可視範圍）\n     * @private\n     */\n    _setupMouseInteraction() {\n        if (!this.canvas) return;\n        \n        let isDragging = false;\n        \n        // 滑鼠按下 - 點擊或開始拖曳\n        this.canvas.addEventListener('mousedown', (e) => {\n            const acc = this.accumulatedWaveform;\n            if (!acc || acc.sampleCount === 0) return;\n            \n            isDragging = true;\n            this._handleSeek(e.offsetX);\n            this.canvas.style.cursor = 'grabbing';\n        });\n        \n        // 滑鼠移動 - 拖曳更新\n        this.canvas.addEventListener('mousemove', (e) => {\n            if (!isDragging) return;\n            this._handleSeek(e.offsetX);\n        });\n        \n        // 滑鼠放開\n        this.canvas.addEventListener('mouseup', () => {\n            isDragging = false;\n            this.canvas.style.cursor = 'pointer';\n        });\n        \n        // 滑鼠離開\n        this.canvas.addEventListener('mouseleave', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'pointer';\n            }\n        });\n        \n        // 設置 cursor 樣式\n        this.canvas.style.cursor = 'pointer';\n    }\n    \n    /**\n     * 處理點擊/拖曳跳轉\n     * @private\n     */\n    _handleSeek(clickX) {\n        const acc = this.accumulatedWaveform;\n        if (!acc || acc.sampleCount === 0) return;\n        \n        const total = acc.sampleCount;\n        const clickRatio = Math.max(0, Math.min(1, clickX / this.width));\n        const targetSample = Math.floor(clickRatio * total);\n        \n        // 更新 accumulated waveform 的視圖位置\n        const info = acc.getVisibleSamples();\n        const halfVisible = Math.floor(info.visible / 2);\n        acc.viewStart = Math.max(0, Math.min(total - info.visible, targetSample - halfVisible));\n        acc.isAutoScroll = false;\n        acc._enforceViewBounds();\n        acc.draw();\n        \n        // 重繪 overview 以更新可視範圍指示器\n        this.draw();\n        \n        // 觸發自定義事件\n        const event = new CustomEvent('overview-seek', {\n            detail: {\n                sample: targetSample,\n                time: targetSample / acc.sourceSampleRate\n            }\n        });\n        this.canvas.dispatchEvent(event);\n    }\n\n    clear() {\n        if (this._useWorker && this._workerRef) {\n            this._workerRef.postMessage({ type: 'clearOverview' });\n            return;\n        }\n        \n        this.ctx.clearRect(0, 0, this.width, this.height);\n        this.ctx.fillStyle = '#f5f5f5';\n        this.ctx.fillRect(0, 0, this.width, this.height);\n    }\n\n    draw() {\n        if (this._useWorker && this._workerRef) {\n            // Worker 會自動同步繪製 overview\n            return;\n        }\n        \n        // 主線程繪製\n        this.clear();\n        \n        const acc = this.accumulatedWaveform;\n        if (!acc || acc.sampleCount === 0) {\n            console.log('⚠️ OverviewWaveform: 沒有數據可顯示', {\n                hasAcc: !!acc,\n                sampleCount: acc ? acc.sampleCount : 0\n            });\n            return;\n        }\n        \n        const total = acc.sampleCount;\n        const info = acc.getVisibleSamples();\n        \n        console.log('📊 OverviewWaveform 繪製:', {\n            total,\n            visibleStart: info.start,\n            visibleEnd: info.end,\n            canvasWidth: this.width,\n            canvasHeight: this.height\n        });\n        \n        // 繪製全局波形\n        this.ctx.strokeStyle = '#64b5f6';\n        this.ctx.lineWidth = 1;\n        \n        const samplesPerPixel = total / this.width;\n        for (let x = 0; x < this.width; x++) {\n            const sampleIndex = Math.floor(x * samplesPerPixel);\n            if (sampleIndex >= total) break;\n            \n            const sample = acc._getSamplePair(sampleIndex);\n            const centerY = this.height / 2;\n            const yMin = Math.floor(centerY - (sample.max * centerY * 0.9));\n            const yMax = Math.floor(centerY - (sample.min * centerY * 0.9));\n            \n            // 繪製垂直線\n            this.ctx.beginPath();\n            this.ctx.moveTo(x, yMin);\n            this.ctx.lineTo(x, yMax);\n            this.ctx.stroke();\n        }\n        \n        // 繪製中線\n        this.ctx.strokeStyle = '#e0e0e0';\n        this.ctx.lineWidth = 1;\n        this.ctx.beginPath();\n        this.ctx.moveTo(0, this.height / 2);\n        this.ctx.lineTo(this.width, this.height / 2);\n        this.ctx.stroke();\n        \n        // 繪製可視範圍指示器\n        const viewStartX = Math.floor((info.start / total) * this.width);\n        const viewEndX = Math.floor((info.end / total) * this.width);\n        const viewWidth = Math.max(2, viewEndX - viewStartX);\n        \n        // 半透明覆蓋\n        this.ctx.fillStyle = 'rgba(33, 150, 243, 0.15)';\n        this.ctx.fillRect(viewStartX, 0, viewWidth, this.height);\n        \n        // 邊框\n        this.ctx.strokeStyle = '#2196F3';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(viewStartX, 0, viewWidth, this.height);\n        \n        console.log('✅ OverviewWaveform 繪製完成');\n    }\n}\n\n// 導出所有類別\nexport default WaveformRenderer;\n","/**\n * RecorderUI.js\n * VoiceBank Recorder 主 UI 控制器\n * \n * 職責：\n * - 管理所有 UI 元素和狀態\n * - 協調 AudioEngine 和 WaveformRenderer\n * - 處理用戶交互事件\n * - 更新 UI 顯示\n * \n * @module RecorderUI\n * @requires AudioEngine\n * @requires WaveformRenderer\n */\n\n/**\n * RecorderUI 類 - 主 UI 控制器\n */\nexport class RecorderUI {\n  /**\n   * 建構函數\n   * @param {string|HTMLElement} container - 容器選擇器或元素\n   * @param {Object} options - 配置選項\n   * @param {AudioEngine} options.audioEngine - 音訊引擎實例\n   * @param {WaveformRenderer} options.waveformRenderer - 波形渲染器實例\n   * @param {Object} options.callbacks - 回調函數\n   */\n  constructor(container, options = {}) {\n    // 容器元素\n    this.container = typeof container === 'string' \n      ? document.querySelector(container) \n      : container;\n    \n    if (!this.container) {\n      throw new Error('Container element not found');\n    }\n    \n    // 核心模組引用\n    this.audioEngine = options.audioEngine;\n    this.waveformRenderer = options.waveformRenderer;\n    \n    // 配置選項\n    this.options = {\n      layout: options.layout || 'auto', // 'horizontal', 'vertical', 'auto'\n      theme: options.theme || 'light',  // 'light', 'dark'\n      showOverview: options.showOverview !== false,\n      ...options\n    };\n    \n    // 回調函數\n    this.callbacks = {\n      onRecordStart: options.onRecordStart || (() => {}),\n      onRecordStop: options.onRecordStop || (() => {}),\n      onPlayStart: options.onPlayStart || (() => {}),\n      onPlayStop: options.onPlayStop || (() => {}),\n      onError: options.onError || ((error) => console.error('UI Error:', error)),\n      ...options.callbacks\n    };\n    \n    // UI 元素引用（初始化後填充）\n    this.elements = {};\n    \n    // 狀態\n    this.state = {\n      isRecording: false,\n      isPlaying: false,\n      isPaused: false,\n      hasRecording: false,\n      duration: 0,\n      sampleCount: 0\n    };\n    \n    // 子控制器（可選）\n    this.controlPanel = null;\n    this.playbackController = null;\n    this.layoutManager = null;\n  }\n  \n  /**\n   * 初始化 UI\n   */\n  async initialize() {\n    try {\n      // 1. 渲染 UI 結構\n      this.renderUI();\n      \n      // 2. 獲取 DOM 元素引用\n      this.cacheElements();\n      \n      // 3. 綁定事件處理器\n      this.bindEvents();\n      \n      // 4. 初始化子控制器（如果需要）\n      this.initializeSubControllers();\n      \n      // 5. 應用初始設定\n      this.applyInitialSettings();\n      \n      // 6. 連接核心模組事件\n      this.connectCoreModules();\n      \n      console.log('✅ RecorderUI initialized');\n    } catch (error) {\n      this.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 渲染 UI 結構\n   * 注意：這是簡化版，實際應該從 public/index.html 提取完整 HTML\n   */\n  renderUI() {\n    this.container.innerHTML = `\n      <div class=\"voicebank-recorder\" data-layout=\"${this.options.layout}\" data-theme=\"${this.options.theme}\">\n        <!-- 控制面板 -->\n        <div class=\"recorder-controls\">\n          <button id=\"vbr-btn-record\" class=\"btn-record\">\n            <span class=\"icon\">●</span>\n            <span class=\"label\">開始錄音</span>\n          </button>\n          \n          <div class=\"recording-info\">\n            <span id=\"vbr-recording-duration\">00:00.0</span>\n            <span id=\"vbr-sample-count\">0 samples</span>\n          </div>\n        </div>\n        \n        <!-- 波形容器 -->\n        <div class=\"waveform-wrapper\" id=\"vbr-waveform-wrapper\">\n          <!-- 即時波形 -->\n          <div class=\"waveform-section\">\n            <label>即時波形</label>\n            <canvas id=\"vbr-live-waveform\" width=\"800\" height=\"120\"></canvas>\n          </div>\n          \n          <!-- VU Meter -->\n          <div class=\"waveform-section\">\n            <label>音量表</label>\n            <canvas id=\"vbr-vu-meter\" width=\"800\" height=\"50\"></canvas>\n          </div>\n          \n          <!-- 累積波形 -->\n          <div class=\"waveform-section\">\n            <label>累積波形</label>\n            <canvas id=\"vbr-accumulated-waveform\" width=\"800\" height=\"200\"></canvas>\n          </div>\n          \n          <!-- 概覽波形 -->\n          ${this.options.showOverview ? `\n          <div class=\"waveform-section\">\n            <label>概覽波形</label>\n            <canvas id=\"vbr-overview-waveform\" width=\"800\" height=\"80\"></canvas>\n          </div>\n          ` : ''}\n        </div>\n        \n        <!-- 播放控制 -->\n        <div class=\"playback-controls\">\n          <button id=\"vbr-btn-play\" class=\"btn-play\" disabled>\n            <span class=\"icon\">▶</span>\n            <span class=\"label\">播放</span>\n          </button>\n          <button id=\"vbr-btn-pause\" class=\"btn-pause\" disabled>\n            <span class=\"icon\">⏸</span>\n            <span class=\"label\">暫停</span>\n          </button>\n          <button id=\"vbr-btn-stop\" class=\"btn-stop\" disabled>\n            <span class=\"icon\">⏹</span>\n            <span class=\"label\">停止</span>\n          </button>\n        </div>\n        \n        <!-- 工具列 -->\n        <div class=\"toolbar\">\n          <button id=\"vbr-btn-save\" class=\"btn-save\" disabled>\n            <span class=\"icon\">💾</span>\n            <span class=\"label\">儲存</span>\n          </button>\n          <button id=\"vbr-btn-clear\" class=\"btn-clear\" disabled>\n            <span class=\"icon\">🗑️</span>\n            <span class=\"label\">清除</span>\n          </button>\n          <button id=\"vbr-btn-layout-toggle\" class=\"btn-layout-toggle\">\n            <span class=\"icon\">🔄</span>\n            <span class=\"label\">切換佈局</span>\n          </button>\n        </div>\n      </div>\n    `;\n  }\n  \n  /**\n   * 緩存 DOM 元素引用\n   */\n  cacheElements() {\n    this.elements = {\n      // 按鈕\n      btnRecord: document.getElementById('vbr-btn-record'),\n      btnPlay: document.getElementById('vbr-btn-play'),\n      btnPause: document.getElementById('vbr-btn-pause'),\n      btnStop: document.getElementById('vbr-btn-stop'),\n      btnSave: document.getElementById('vbr-btn-save'),\n      btnClear: document.getElementById('vbr-btn-clear'),\n      btnLayoutToggle: document.getElementById('vbr-btn-layout-toggle'),\n      \n      // 顯示元素\n      recordingDuration: document.getElementById('vbr-recording-duration'),\n      sampleCount: document.getElementById('vbr-sample-count'),\n      waveformWrapper: document.getElementById('vbr-waveform-wrapper'),\n      \n      // Canvas 元素\n      liveCanvas: document.getElementById('vbr-live-waveform'),\n      vuMeterCanvas: document.getElementById('vbr-vu-meter'),\n      accumulatedCanvas: document.getElementById('vbr-accumulated-waveform'),\n      overviewCanvas: document.getElementById('vbr-overview-waveform')\n    };\n  }\n  \n  /**\n   * 綁定事件處理器\n   */\n  bindEvents() {\n    // 錄音按鈕\n    if (this.elements.btnRecord) {\n      this.elements.btnRecord.addEventListener('click', () => {\n        this.handleRecordToggle();\n      });\n    }\n    \n    // 播放控制按鈕\n    if (this.elements.btnPlay) {\n      this.elements.btnPlay.addEventListener('click', () => {\n        this.handlePlay();\n      });\n    }\n    \n    if (this.elements.btnPause) {\n      this.elements.btnPause.addEventListener('click', () => {\n        this.handlePause();\n      });\n    }\n    \n    if (this.elements.btnStop) {\n      this.elements.btnStop.addEventListener('click', () => {\n        this.handleStop();\n      });\n    }\n    \n    // 工具按鈕\n    if (this.elements.btnSave) {\n      this.elements.btnSave.addEventListener('click', () => {\n        this.handleSave();\n      });\n    }\n    \n    if (this.elements.btnClear) {\n      this.elements.btnClear.addEventListener('click', () => {\n        this.handleClear();\n      });\n    }\n    \n    if (this.elements.btnLayoutToggle) {\n      this.elements.btnLayoutToggle.addEventListener('click', () => {\n        this.handleLayoutToggle();\n      });\n    }\n    \n    // 視窗大小變更\n    window.addEventListener('resize', () => {\n      this.handleResize();\n    });\n  }\n  \n  /**\n   * 初始化子控制器（可選）\n   */\n  initializeSubControllers() {\n    // 這裡可以初始化其他 UI 子控制器\n    // 例如：this.controlPanel = new ControlPanel(this);\n    // 目前先保持簡單\n  }\n  \n  /**\n   * 應用初始設定\n   */\n  applyInitialSettings() {\n    // 應用佈局\n    this.applyLayout(this.options.layout);\n    \n    // 應用主題\n    this.applyTheme(this.options.theme);\n    \n    // 初始化按鈕狀態\n    this.updateButtonStates();\n  }\n  \n  /**\n   * 連接核心模組事件\n   */\n  connectCoreModules() {\n    if (!this.audioEngine || !this.waveformRenderer) {\n      console.warn('Core modules not provided, UI will have limited functionality');\n      return;\n    }\n    \n    // AudioEngine 事件\n    this.audioEngine.on('recording-start', () => {\n      this.onRecordingStart();\n    });\n    \n    this.audioEngine.on('recording-stop', (data) => {\n      this.onRecordingStop(data);\n    });\n    \n    this.audioEngine.on('data-available', (data) => {\n      this.onDataAvailable(data);\n    });\n    \n    this.audioEngine.on('error', (error) => {\n      this.onAudioError(error);\n    });\n  }\n  \n  // ==================== 事件處理器 ====================\n  \n  /**\n   * 處理錄音按鈕切換\n   */\n  async handleRecordToggle() {\n    try {\n      if (this.state.isRecording) {\n        // 停止錄音\n        await this.audioEngine.stopRecording();\n      } else {\n        // 開始錄音\n        await this.audioEngine.startRecording();\n      }\n    } catch (error) {\n      this.callbacks.onError(error);\n      this.showError('錄音操作失敗：' + error.message);\n    }\n  }\n  \n  /**\n   * 處理播放\n   */\n  async handlePlay() {\n    try {\n      // TODO: 實現播放邏輯\n      console.log('Play recording');\n      this.callbacks.onPlayStart();\n    } catch (error) {\n      this.callbacks.onError(error);\n    }\n  }\n  \n  /**\n   * 處理暫停\n   */\n  async handlePause() {\n    try {\n      // TODO: 實現暫停邏輯\n      console.log('Pause playback');\n    } catch (error) {\n      this.callbacks.onError(error);\n    }\n  }\n  \n  /**\n   * 處理停止\n   */\n  async handleStop() {\n    try {\n      // TODO: 實現停止邏輯\n      console.log('Stop playback');\n      this.callbacks.onPlayStop();\n    } catch (error) {\n      this.callbacks.onError(error);\n    }\n  }\n  \n  /**\n   * 處理儲存\n   */\n  async handleSave() {\n    try {\n      // TODO: 實現儲存邏輯\n      console.log('Save recording');\n    } catch (error) {\n      this.callbacks.onError(error);\n    }\n  }\n  \n  /**\n   * 處理清除\n   */\n  async handleClear() {\n    if (!confirm('確定要清除當前錄音嗎？')) {\n      return;\n    }\n    \n    try {\n      // 清除波形\n      if (this.waveformRenderer) {\n        this.waveformRenderer.reset();\n      }\n      \n      // 重置狀態\n      this.state.hasRecording = false;\n      this.state.duration = 0;\n      this.state.sampleCount = 0;\n      \n      // 更新顯示\n      this.updateDurationDisplay();\n      this.updateButtonStates();\n      \n      console.log('Recording cleared');\n    } catch (error) {\n      this.callbacks.onError(error);\n    }\n  }\n  \n  /**\n   * 處理佈局切換\n   */\n  handleLayoutToggle() {\n    const currentLayout = this.container.dataset.layout;\n    const newLayout = currentLayout === 'horizontal' ? 'vertical' : 'horizontal';\n    this.applyLayout(newLayout);\n  }\n  \n  /**\n   * 處理視窗大小變更\n   */\n  handleResize() {\n    // 調整 Canvas 尺寸\n    if (this.waveformRenderer) {\n      this.waveformRenderer.resize();\n    }\n  }\n  \n  // ==================== 核心模組事件回調 ====================\n  \n  /**\n   * 錄音開始回調\n   */\n  onRecordingStart() {\n    this.state.isRecording = true;\n    this.state.hasRecording = true;\n    \n    // 更新 UI\n    this.setRecordingState(true);\n    this.updateButtonStates();\n    \n    // 啟動波形顯示\n    if (this.waveformRenderer) {\n      // WaveformRenderer 會自動從 AudioEngine 獲取數據\n    }\n    \n    // 回調\n    this.callbacks.onRecordStart();\n    \n    console.log('🎙️ Recording started');\n  }\n  \n  /**\n   * 錄音停止回調\n   */\n  onRecordingStop(data) {\n    this.state.isRecording = false;\n    \n    // 更新 UI\n    this.setRecordingState(false);\n    this.updateButtonStates();\n    \n    // 回調\n    this.callbacks.onRecordStop(data);\n    \n    console.log('⏹️ Recording stopped', data);\n  }\n  \n  /**\n   * 數據可用回調\n   */\n  onDataAvailable(data) {\n    // 更新時長和樣本數\n    if (data.duration !== undefined) {\n      this.state.duration = data.duration;\n    }\n    if (data.sampleCount !== undefined) {\n      this.state.sampleCount = data.sampleCount;\n    }\n    \n    // 更新顯示\n    this.updateDurationDisplay();\n  }\n  \n  /**\n   * 音訊錯誤回調\n   */\n  onAudioError(error) {\n    this.showError('音訊錯誤：' + error.message);\n    this.callbacks.onError(error);\n  }\n  \n  // ==================== UI 更新方法 ====================\n  \n  /**\n   * 設定錄音狀態\n   * @param {boolean} isRecording - 是否正在錄音\n   */\n  setRecordingState(isRecording) {\n    const btn = this.elements.btnRecord;\n    if (!btn) return;\n    \n    if (isRecording) {\n      btn.classList.add('recording');\n      btn.querySelector('.icon').textContent = '⏹';\n      btn.querySelector('.label').textContent = '停止錄音';\n    } else {\n      btn.classList.remove('recording');\n      btn.querySelector('.icon').textContent = '●';\n      btn.querySelector('.label').textContent = '開始錄音';\n    }\n  }\n  \n  /**\n   * 更新按鈕狀態\n   */\n  updateButtonStates() {\n    const { isRecording, isPlaying, isPaused, hasRecording } = this.state;\n    \n    // 錄音按鈕：播放時禁用\n    if (this.elements.btnRecord) {\n      this.elements.btnRecord.disabled = isPlaying;\n    }\n    \n    // 播放控制按鈕：沒有錄音時禁用\n    if (this.elements.btnPlay) {\n      this.elements.btnPlay.disabled = !hasRecording || isRecording || isPlaying;\n    }\n    \n    if (this.elements.btnPause) {\n      this.elements.btnPause.disabled = !isPlaying || isPaused;\n    }\n    \n    if (this.elements.btnStop) {\n      this.elements.btnStop.disabled = !isPlaying && !isPaused;\n    }\n    \n    // 工具按鈕\n    if (this.elements.btnSave) {\n      this.elements.btnSave.disabled = !hasRecording || isRecording;\n    }\n    \n    if (this.elements.btnClear) {\n      this.elements.btnClear.disabled = !hasRecording || isRecording;\n    }\n  }\n  \n  /**\n   * 更新時長顯示\n   */\n  updateDurationDisplay() {\n    if (this.elements.recordingDuration) {\n      this.elements.recordingDuration.textContent = this.formatDuration(this.state.duration);\n    }\n    \n    if (this.elements.sampleCount) {\n      this.elements.sampleCount.textContent = `${this.state.sampleCount.toLocaleString()} samples`;\n    }\n  }\n  \n  /**\n   * 格式化時長\n   * @param {number} seconds - 秒數\n   * @returns {string} 格式化後的時長 (MM:SS.S)\n   */\n  formatDuration(seconds) {\n    const minutes = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    const decimal = Math.floor((seconds % 1) * 10);\n    \n    return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}.${decimal}`;\n  }\n  \n  /**\n   * 應用佈局\n   * @param {string} layout - 'horizontal', 'vertical', 'auto'\n   */\n  applyLayout(layout) {\n    if (layout === 'auto') {\n      // 自動偵測\n      layout = window.innerWidth > window.innerHeight ? 'horizontal' : 'vertical';\n    }\n    \n    this.container.dataset.layout = layout;\n    this.options.layout = layout;\n    \n    // 通知 WaveformRenderer\n    if (this.waveformRenderer) {\n      this.waveformRenderer.setVerticalMode(layout === 'vertical');\n    }\n    \n    console.log(`📐 Layout changed to: ${layout}`);\n  }\n  \n  /**\n   * 應用主題\n   * @param {string} theme - 'light', 'dark'\n   */\n  applyTheme(theme) {\n    this.container.dataset.theme = theme;\n    this.options.theme = theme;\n    \n    console.log(`🎨 Theme changed to: ${theme}`);\n  }\n  \n  /**\n   * 顯示錯誤訊息\n   * @param {string} message - 錯誤訊息\n   */\n  showError(message) {\n    // 簡單的錯誤顯示（可以擴展為更好的 UI）\n    alert('錯誤：' + message);\n  }\n  \n  /**\n   * 顯示通知\n   * @param {string} message - 通知訊息\n   * @param {number} duration - 持續時間（毫秒）\n   */\n  showNotice(message, duration = 3000) {\n    // 簡單的通知顯示（可以擴展為更好的 UI）\n    console.log('📢 Notice:', message);\n  }\n  \n  // ==================== 公開 API ====================\n  \n  /**\n   * 取得當前狀態\n   * @returns {Object} 狀態物件\n   */\n  getState() {\n    return { ...this.state };\n  }\n  \n  /**\n   * 設定選項\n   * @param {Object} options - 選項物件\n   */\n  setOptions(options) {\n    this.options = { ...this.options, ...options };\n    \n    // 應用變更\n    if (options.layout) {\n      this.applyLayout(options.layout);\n    }\n    if (options.theme) {\n      this.applyTheme(options.theme);\n    }\n  }\n  \n  /**\n   * 銷毀 UI\n   */\n  destroy() {\n    // 移除事件監聽器\n    // （簡化版，實際應該記錄所有監聽器並逐一移除）\n    \n    // 清空容器\n    if (this.container) {\n      this.container.innerHTML = '';\n    }\n    \n    // 清空引用\n    this.elements = {};\n    this.audioEngine = null;\n    this.waveformRenderer = null;\n    \n    console.log('🗑️ RecorderUI destroyed');\n  }\n}\n\nexport default RecorderUI;\n","/**\n * StorageAdapter - 儲存適配器基類\n * 定義統一的儲存介面，支援多種儲存後端\n */\n\nexport class StorageAdapter {\n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob 物件\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID 或 URL\n   */\n  async save(blob, filename, metadata = {}) {\n    throw new Error('save() must be implemented by subclass');\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<Blob>} 音訊 Blob 物件\n   */\n  async load(id) {\n    throw new Error('load() must be implemented by subclass');\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>} 是否成功刪除\n   */\n  async delete(id) {\n    throw new Error('delete() must be implemented by subclass');\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>} 檔案列表\n   */\n  async list() {\n    throw new Error('list() must be implemented by subclass');\n  }\n  \n  /**\n   * 檢查檔案是否存在\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>}\n   */\n  async exists(id) {\n    try {\n      await this.load(id);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n  \n  /**\n   * 清空所有檔案（謹慎使用）\n   * @returns {Promise<number>} 刪除的檔案數量\n   */\n  async clear() {\n    const files = await this.list();\n    let count = 0;\n    \n    for (const file of files) {\n      try {\n        await this.delete(file.id || file.filename);\n        count++;\n      } catch (error) {\n        console.error('Failed to delete file:', file, error);\n      }\n    }\n    \n    return count;\n  }\n}\n\nexport default StorageAdapter;\n","/**\n * IndexedDBAdapter - IndexedDB 儲存實現\n * 用於瀏覽器端本地儲存，無需伺服器\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class IndexedDBAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} dbName - 資料庫名稱\n   * @param {string} storeName - 儲存區名稱\n   * @param {number} version - 資料庫版本\n   */\n  constructor(dbName = 'VoiceBankDB', storeName = 'recordings', version = 1) {\n    super();\n    this.dbName = dbName;\n    this.storeName = storeName;\n    this.version = version;\n    this.db = null;\n  }\n  \n  /**\n   * 初始化資料庫\n   * @returns {Promise<IDBDatabase>}\n   */\n  async initialize() {\n    if (this.db) {\n      return this.db;\n    }\n    \n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.version);\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to open IndexedDB: ${request.error}`));\n      };\n      \n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(this.db);\n      };\n      \n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        \n        // 創建物件儲存區（如果不存在）\n        if (!db.objectStoreNames.contains(this.storeName)) {\n          const store = db.createObjectStore(this.storeName, { \n            keyPath: 'id', \n            autoIncrement: true \n          });\n          \n          // 創建索引\n          store.createIndex('filename', 'filename', { unique: false });\n          store.createIndex('timestamp', 'timestamp', { unique: false });\n          store.createIndex('duration', 'duration', { unique: false });\n        }\n      };\n    });\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      const record = {\n        filename: filename,\n        blob: blob,\n        size: blob.size,\n        type: blob.type,\n        timestamp: Date.now(),\n        metadata: metadata\n      };\n      \n      const request = store.add(record);\n      \n      request.onsuccess = () => {\n        resolve(String(request.result));\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to save recording: ${request.error}`));\n      };\n      \n      transaction.onerror = () => {\n        reject(new Error(`Transaction failed: ${transaction.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async load(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.get(Number(id));\n      \n      request.onsuccess = () => {\n        const record = request.result;\n        if (record && record.blob) {\n          resolve(record.blob);\n        } else {\n          reject(new Error(`Recording not found: ${id}`));\n        }\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to load recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async delete(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.delete(Number(id));\n      \n      request.onsuccess = () => {\n        resolve(true);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to delete recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.getAll();\n      \n      request.onsuccess = () => {\n        const records = request.result.map(record => ({\n          id: String(record.id),\n          filename: record.filename,\n          size: record.size,\n          type: record.type,\n          timestamp: record.timestamp,\n          date: new Date(record.timestamp),\n          metadata: record.metadata || {}\n        }));\n        resolve(records);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to list recordings: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 根據檔名搜尋\n   * @param {string} filename - 檔案名稱（支援部分匹配）\n   * @returns {Promise<Array>}\n   */\n  async searchByFilename(filename) {\n    const allRecords = await this.list();\n    return allRecords.filter(record => \n      record.filename.toLowerCase().includes(filename.toLowerCase())\n    );\n  }\n  \n  /**\n   * 取得儲存空間使用情況\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const records = await this.list();\n    const totalSize = records.reduce((sum, record) => sum + record.size, 0);\n    \n    return {\n      count: records.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      records: records\n    };\n  }\n  \n  /**\n   * 清空所有錄音\n   * @returns {Promise<number>} 刪除的數量\n   */\n  async clear() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      // 先取得數量\n      const countRequest = store.count();\n      \n      countRequest.onsuccess = () => {\n        const count = countRequest.result;\n        \n        // 清空儲存區\n        const clearRequest = store.clear();\n        \n        clearRequest.onsuccess = () => {\n          resolve(count);\n        };\n        \n        clearRequest.onerror = () => {\n          reject(new Error(`Failed to clear recordings: ${clearRequest.error}`));\n        };\n      };\n      \n      countRequest.onerror = () => {\n        reject(new Error(`Failed to count recordings: ${countRequest.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 取得瀏覽器儲存空間配額資訊（如果可用）\n   * @returns {Promise<Object|null>}\n   */\n  async getStorageEstimate() {\n    if ('storage' in navigator && 'estimate' in navigator.storage) {\n      try {\n        const estimate = await navigator.storage.estimate();\n        return {\n          usage: estimate.usage,\n          quota: estimate.quota,\n          usageMB: (estimate.usage / (1024 * 1024)).toFixed(2),\n          quotaMB: (estimate.quota / (1024 * 1024)).toFixed(2),\n          usagePercent: ((estimate.usage / estimate.quota) * 100).toFixed(2)\n        };\n      } catch (error) {\n        console.warn('Failed to get storage estimate:', error);\n        return null;\n      }\n    }\n    return null;\n  }\n  \n  /**\n   * 關閉資料庫連接\n   */\n  close() {\n    if (this.db) {\n      this.db.close();\n      this.db = null;\n    }\n  }\n}\n\nexport default IndexedDBAdapter;\n","/**\n * ServerAdapter - 伺服器儲存適配器\n * 支援 PHP/Node.js 等後端儲存方案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ServerAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {Object} config - 配置選項\n   * @param {string} config.baseURL - 基礎 URL\n   * @param {string} config.saveEndpoint - 上傳端點\n   * @param {string} config.loadEndpoint - 下載端點\n   * @param {string} config.deleteEndpoint - 刪除端點\n   * @param {string} config.listEndpoint - 列表端點（可選）\n   */\n  constructor(config = {}) {\n    super();\n    this.baseURL = config.baseURL || '';\n    this.saveEndpoint = config.saveEndpoint || '/backend/save.php';\n    this.loadEndpoint = config.loadEndpoint || '/public/uploads/';\n    this.deleteEndpoint = config.deleteEndpoint || '/backend/delete.php';\n    this.listEndpoint = config.listEndpoint || '/api/recordings';\n    this.headers = config.headers || {};\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    const formData = new FormData();\n    formData.append('audio-blob', blob);\n    formData.append('audio-filename', filename);\n    \n    if (metadata && Object.keys(metadata).length > 0) {\n      formData.append('metadata', JSON.stringify(metadata));\n    }\n    \n    try {\n      const response = await fetch(this.baseURL + this.saveEndpoint, {\n        method: 'POST',\n        body: formData,\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Upload failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      \n      // 檢查 PHP 端點的回應（通常是 'success'）\n      if (result.toLowerCase().includes('success')) {\n        return filename;\n      } else {\n        throw new Error(`Server error: ${result}`);\n      }\n    } catch (error) {\n      console.error('Save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    try {\n      const url = this.baseURL + this.loadEndpoint + filename;\n      const response = await fetch(url, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Load failed: ${response.status} ${response.statusText}`);\n      }\n      \n      return await response.blob();\n    } catch (error) {\n      console.error('Load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    try {\n      const response = await fetch(this.baseURL + this.deleteEndpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...this.headers\n        },\n        body: JSON.stringify({ filename })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Delete failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      return result.toLowerCase().includes('success');\n    } catch (error) {\n      console.error('Delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    try {\n      const response = await fetch(this.baseURL + this.listEndpoint, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`List failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      return Array.isArray(data) ? data : [];\n    } catch (error) {\n      console.error('List error:', error);\n      // 如果後端不支援 list 操作，返回空陣列\n      return [];\n    }\n  }\n  \n  /**\n   * 使用 XMLHttpRequest 上傳（帶進度回調）\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @param {Function} onProgress - 進度回調 (percent)\n   * @returns {Promise<string>}\n   */\n  async saveWithProgress(blob, filename, metadata = {}, onProgress = null) {\n    return new Promise((resolve, reject) => {\n      const formData = new FormData();\n      formData.append('audio-blob', blob);\n      formData.append('audio-filename', filename);\n      \n      if (metadata && Object.keys(metadata).length > 0) {\n        formData.append('metadata', JSON.stringify(metadata));\n      }\n      \n      const xhr = new XMLHttpRequest();\n      \n      // 進度事件\n      if (onProgress) {\n        xhr.upload.addEventListener('progress', (e) => {\n          if (e.lengthComputable) {\n            const percent = (e.loaded / e.total) * 100;\n            onProgress(percent);\n          }\n        });\n      }\n      \n      // 完成事件\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const result = xhr.responseText;\n          if (result.toLowerCase().includes('success')) {\n            resolve(filename);\n          } else {\n            reject(new Error(`Server error: ${result}`));\n          }\n        } else {\n          reject(new Error(`Upload failed: ${xhr.status} ${xhr.statusText}`));\n        }\n      });\n      \n      // 錯誤事件\n      xhr.addEventListener('error', () => {\n        reject(new Error('Network error during upload'));\n      });\n      \n      // 取消事件\n      xhr.addEventListener('abort', () => {\n        reject(new Error('Upload cancelled'));\n      });\n      \n      // 發送請求\n      xhr.open('POST', this.baseURL + this.saveEndpoint);\n      \n      // 設定自定義 headers\n      Object.keys(this.headers).forEach(key => {\n        xhr.setRequestHeader(key, this.headers[key]);\n      });\n      \n      xhr.send(formData);\n    });\n  }\n}\n\nexport default ServerAdapter;\n","/**\n * ElectronAdapter - Electron 檔案系統儲存適配器\n * 使用 Electron 的 IPC 通訊與主進程進行檔案操作\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ElectronAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} savePath - 預設儲存路徑（相對於用戶文件目錄）\n   */\n  constructor(savePath = 'recordings') {\n    super();\n    this.savePath = savePath;\n    \n    // 檢查 Electron API 是否可用\n    if (typeof window === 'undefined' || !window.electronAPI) {\n      throw new Error('Electron API not available. Make sure preload script is properly configured.');\n    }\n    \n    this.electronAPI = window.electronAPI;\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案路徑\n   */\n  async save(blob, filename, metadata = {}) {\n    try {\n      // 將 Blob 轉換為 ArrayBuffer\n      const arrayBuffer = await blob.arrayBuffer();\n      \n      // 轉換為普通陣列（以便通過 IPC 傳遞）\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      // 呼叫 Electron API\n      const result = await this.electronAPI.saveRecording({\n        filename,\n        buffer,\n        metadata: {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        }\n      });\n      \n      if (result.success) {\n        return result.id || result.path;\n      } else {\n        throw new Error(result.error || 'Save failed');\n      }\n    } catch (error) {\n      console.error('Electron save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<Blob>}\n   */\n  async load(filePath) {\n    try {\n      // 從 Electron 讀取檔案\n      const buffer = await this.electronAPI.loadRecording(filePath);\n      \n      // 將 Buffer 轉換為 Blob\n      const uint8Array = new Uint8Array(buffer);\n      return new Blob([uint8Array], { type: 'audio/wav' });\n    } catch (error) {\n      console.error('Electron load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async delete(filePath) {\n    try {\n      const result = await this.electronAPI.deleteRecording(filePath);\n      return result.success;\n    } catch (error) {\n      console.error('Electron delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @param {string} directory - 目錄路徑（可選）\n   * @returns {Promise<Array>}\n   */\n  async list(directory = null) {\n    try {\n      const recordings = await this.electronAPI.listRecordings(directory);\n      return recordings || [];\n    } catch (error) {\n      console.error('Electron list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 開啟檔案選擇對話框\n   * @returns {Promise<string|null>} 選擇的檔案路徑\n   */\n  async openFile() {\n    try {\n      if (this.electronAPI.openFile) {\n        return await this.electronAPI.openFile();\n      }\n      throw new Error('openFile API not available');\n    } catch (error) {\n      console.error('Electron openFile error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 開啟另存為對話框\n   * @param {Blob} blob - 要儲存的 Blob\n   * @param {string} defaultFilename - 預設檔案名稱\n   * @returns {Promise<string|null>} 儲存的檔案路徑\n   */\n  async saveAs(blob, defaultFilename = 'recording.wav') {\n    try {\n      const arrayBuffer = await blob.arrayBuffer();\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      if (this.electronAPI.saveAs) {\n        const result = await this.electronAPI.saveAs({\n          filename: defaultFilename,\n          buffer\n        });\n        \n        return result.success ? result.path : null;\n      }\n      \n      // 如果沒有 saveAs API，使用預設的 save\n      return await this.save(blob, defaultFilename);\n    } catch (error) {\n      console.error('Electron saveAs error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 在檔案管理器中顯示檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async showInFolder(filePath) {\n    try {\n      if (this.electronAPI.showInFolder) {\n        await this.electronAPI.showInFolder(filePath);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Electron showInFolder error:', error);\n      return false;\n    }\n  }\n}\n\nexport default ElectronAdapter;\n","/**\n * CapacitorAdapter - Capacitor 檔案系統儲存適配器\n * 使用 Capacitor Filesystem Plugin 在移動裝置上儲存檔案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class CapacitorAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} directory - 儲存目錄名稱\n   */\n  constructor(directory = 'recordings') {\n    super();\n    this.directory = directory;\n    \n    // 檢查 Capacitor 是否可用\n    if (typeof window === 'undefined' || !window.Capacitor) {\n      throw new Error('Capacitor not available. Make sure Capacitor is properly initialized.');\n    }\n    \n    this.Capacitor = window.Capacitor;\n    this.initialized = false;\n  }\n  \n  /**\n   * 初始化（確保目錄存在）\n   * @returns {Promise<void>}\n   */\n  async initialize() {\n    if (this.initialized) return;\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 嘗試讀取目錄，如果不存在則創建\n      try {\n        await Filesystem.readdir({\n          path: this.directory,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 目錄不存在，創建它\n        await Filesystem.mkdir({\n          path: this.directory,\n          directory: Directory.Documents,\n          recursive: true\n        });\n      }\n      \n      this.initialized = true;\n    } catch (error) {\n      console.error('Capacitor initialization error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 轉換 Blob 為 base64\n      const base64Data = await this.blobToBase64(blob);\n      \n      // 儲存音訊檔案\n      await Filesystem.writeFile({\n        path: `${this.directory}/${filename}`,\n        data: base64Data,\n        directory: Directory.Documents\n      });\n      \n      // 儲存元數據\n      if (metadata && Object.keys(metadata).length > 0) {\n        const metadataWithDefaults = {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        };\n        \n        await Filesystem.writeFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          data: JSON.stringify(metadataWithDefaults),\n          directory: Directory.Documents,\n          encoding: 'utf8'\n        });\n      }\n      \n      return filename;\n    } catch (error) {\n      console.error('Capacitor save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 將 base64 轉換為 Blob\n      return this.base64ToBlob(result.data, 'audio/wav');\n    } catch (error) {\n      console.error('Capacitor load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 刪除音訊檔案\n      await Filesystem.deleteFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 嘗試刪除元數據（如果存在）\n      try {\n        await Filesystem.deleteFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 元數據可能不存在，忽略錯誤\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Capacitor delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readdir({\n        path: this.directory,\n        directory: Directory.Documents\n      });\n      \n      // 過濾掉元數據檔案，只保留音訊檔案\n      const audioFiles = result.files.filter(f => !f.endsWith('.meta.json'));\n      \n      // 為每個檔案載入元數據\n      const recordings = await Promise.all(\n        audioFiles.map(async (filename) => {\n          let metadata = {};\n          \n          try {\n            const metaResult = await Filesystem.readFile({\n              path: `${this.directory}/${filename}.meta.json`,\n              directory: Directory.Documents,\n              encoding: 'utf8'\n            });\n            metadata = JSON.parse(metaResult.data);\n          } catch (e) {\n            // 沒有元數據\n          }\n          \n          return {\n            id: filename,\n            filename: filename,\n            metadata: metadata,\n            timestamp: metadata.timestamp || 0,\n            date: metadata.timestamp ? new Date(metadata.timestamp) : null,\n            size: metadata.size || 0,\n            type: metadata.type || 'audio/wav'\n          };\n        })\n      );\n      \n      // 按時間排序（最新的在前）\n      recordings.sort((a, b) => b.timestamp - a.timestamp);\n      \n      return recordings;\n    } catch (error) {\n      console.error('Capacitor list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 取得檔案的 URI（用於播放）\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<string>} 檔案 URI\n   */\n  async getUri(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.getUri({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      return result.uri;\n    } catch (error) {\n      console.error('Capacitor getUri error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * Blob 轉 base64\n   * @param {Blob} blob\n   * @returns {Promise<string>}\n   */\n  blobToBase64(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // 移除 data:audio/wav;base64, 前綴\n        const base64 = reader.result.split(',')[1];\n        resolve(base64);\n      };\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n  \n  /**\n   * base64 轉 Blob\n   * @param {string} base64\n   * @param {string} mimeType\n   * @returns {Blob}\n   */\n  base64ToBlob(base64, mimeType = 'audio/wav') {\n    const byteCharacters = atob(base64);\n    const byteNumbers = new Array(byteCharacters.length);\n    \n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    \n    const byteArray = new Uint8Array(byteNumbers);\n    return new Blob([byteArray], { type: mimeType });\n  }\n  \n  /**\n   * 取得儲存空間資訊\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const recordings = await this.list();\n    const totalSize = recordings.reduce((sum, r) => sum + (r.size || 0), 0);\n    \n    return {\n      count: recordings.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      recordings: recordings\n    };\n  }\n}\n\nexport default CapacitorAdapter;\n","/**\n * Storage Module - 儲存模組統一入口\n * 匯出所有儲存適配器\n */\n\nexport { StorageAdapter } from './StorageAdapter.js';\nexport { IndexedDBAdapter } from './IndexedDBAdapter.js';\nexport { ServerAdapter } from './ServerAdapter.js';\nexport { ElectronAdapter } from './ElectronAdapter.js';\nexport { CapacitorAdapter } from './CapacitorAdapter.js';\n\n/**\n * StorageFactory - 儲存適配器工廠\n * 根據配置自動創建適當的儲存適配器\n */\nexport class StorageFactory {\n  /**\n   * 創建儲存適配器\n   * @param {Object} config - 配置選項\n   * @param {string} config.type - 儲存類型 ('browser'|'electron'|'capacitor'|'server'|'auto')\n   * @param {Object} config.options - 適配器特定選項\n   * @returns {StorageAdapter}\n   */\n  static create(config = {}) {\n    const type = config.type || 'auto';\n    const options = config.options || {};\n    \n    // 自動偵測\n    if (type === 'auto') {\n      return this.createAuto(options);\n    }\n    \n    // 根據類型創建\n    switch (type.toLowerCase()) {\n      case 'browser':\n      case 'indexeddb':\n        const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n        return new IndexedDBAdapter(\n          options.dbName,\n          options.storeName,\n          options.version\n        );\n      \n      case 'electron':\n        const { ElectronAdapter } = require('./ElectronAdapter.js');\n        return new ElectronAdapter(options.savePath);\n      \n      case 'capacitor':\n        const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n        return new CapacitorAdapter(options.directory);\n      \n      case 'server':\n      case 'php':\n      case 'nodejs':\n        const { ServerAdapter } = require('./ServerAdapter.js');\n        return new ServerAdapter(options);\n      \n      default:\n        throw new Error(`Unknown storage type: ${type}`);\n    }\n  }\n  \n  /**\n   * 自動創建適配器（根據環境）\n   * @param {Object} options - 選項\n   * @returns {StorageAdapter}\n   */\n  static createAuto(options = {}) {\n    // 檢查 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      const { ElectronAdapter } = require('./ElectronAdapter.js');\n      return new ElectronAdapter(options.savePath);\n    }\n    \n    // 檢查 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n      return new CapacitorAdapter(options.directory);\n    }\n    \n    // 預設使用 IndexedDB（瀏覽器）\n    const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n    return new IndexedDBAdapter(\n      options.dbName,\n      options.storeName,\n      options.version\n    );\n  }\n}\n\nexport default StorageFactory;\n","/**\n * PlatformDetector - 平台偵測工具\n * 自動偵測當前運行環境（Browser/Electron/Capacitor）\n */\n\nexport class PlatformDetector {\n  /**\n   * 偵測當前平台\n   * @returns {string} 'browser' | 'electron' | 'capacitor'\n   */\n  static detect() {\n    // 檢查是否為 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Electron（另一種方式）\n    if (typeof process !== 'undefined' && process.versions && process.versions.electron) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      return 'capacitor';\n    }\n    \n    // 預設為瀏覽器\n    return 'browser';\n  }\n  \n  /**\n   * 檢查是否為 Electron 環境\n   * @returns {boolean}\n   */\n  static isElectron() {\n    return this.detect() === 'electron';\n  }\n  \n  /**\n   * 檢查是否為 Capacitor 環境\n   * @returns {boolean}\n   */\n  static isCapacitor() {\n    return this.detect() === 'capacitor';\n  }\n  \n  /**\n   * 檢查是否為瀏覽器環境\n   * @returns {boolean}\n   */\n  static isBrowser() {\n    return this.detect() === 'browser';\n  }\n  \n  /**\n   * 檢查是否為移動裝置\n   * @returns {boolean}\n   */\n  static isMobile() {\n    if (typeof window === 'undefined' || !window.navigator) {\n      return false;\n    }\n    \n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      window.navigator.userAgent\n    );\n  }\n  \n  /**\n   * 檢查是否支援 AudioWorklet\n   * @returns {boolean}\n   */\n  static supportsAudioWorklet() {\n    if (typeof window === 'undefined' || !window.AudioContext) {\n      return false;\n    }\n    \n    const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n    return 'audioWorklet' in AudioContextClass.prototype;\n  }\n  \n  /**\n   * 檢查是否支援 OffscreenCanvas\n   * @returns {boolean}\n   */\n  static supportsOffscreenCanvas() {\n    return typeof OffscreenCanvas !== 'undefined';\n  }\n  \n  /**\n   * 取得平台資訊\n   * @returns {Object}\n   */\n  static getInfo() {\n    return {\n      platform: this.detect(),\n      isElectron: this.isElectron(),\n      isCapacitor: this.isCapacitor(),\n      isBrowser: this.isBrowser(),\n      isMobile: this.isMobile(),\n      supportsAudioWorklet: this.supportsAudioWorklet(),\n      supportsOffscreenCanvas: this.supportsOffscreenCanvas(),\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown'\n    };\n  }\n}\n\nexport default PlatformDetector;\n","/**\n * VoiceBank Recorder - 主入口點\n * 跨平台音訊錄音庫\n * \n * @version 1.0.0\n * @author VoiceBank Team\n * @license MIT\n */\n\n// 匯出核心模組\nexport { AudioEngine } from './core/AudioEngine.js';\nexport { WaveformRenderer } from './core/WaveformRenderer.js';\n\n// 匯出 UI 模組\nexport { RecorderUI } from './ui/RecorderUI.js';\n\n// 匯出儲存模組\nexport {\n  StorageAdapter,\n  IndexedDBAdapter,\n  ServerAdapter,\n  ElectronAdapter,\n  CapacitorAdapter,\n  StorageFactory\n} from './storage/index.js';\n\n// 匯出工具模組\nexport { PlatformDetector } from './utils/PlatformDetector.js';\n\n/**\n * VoiceBankRecorder - 主類別\n * 提供統一的 API 介面\n */\nexport class VoiceBankRecorder {\n  /**\n   * 建構函數\n   * @param {Object} options - 配置選項\n   * @param {string|HTMLElement} options.container - 容器選擇器或元素\n   * @param {string} options.layout - 佈局模式 ('horizontal'|'vertical'|'auto')\n   * @param {string} options.theme - 主題 ('light'|'dark')\n   * @param {Object} options.audio - 音訊配置\n   * @param {Object} options.waveform - 波形配置\n   * @param {Object} options.storage - 儲存配置\n   * @param {Object} options.callbacks - 事件回調\n   */\n  constructor(options = {}) {\n    this.options = this.mergeOptions(options);\n    this.initialized = false;\n    \n    // 初始化儲存適配器\n    this.storage = this.createStorageAdapter(this.options.storage);\n    \n    // 狀態\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    // 如果提供了容器，初始化 UI\n    if (this.options.container) {\n      this.initializeUI();\n    }\n  }\n  \n  /**\n   * 合併配置選項\n   * @param {Object} options - 用戶選項\n   * @returns {Object} 合併後的選項\n   */\n  mergeOptions(options) {\n    const defaults = {\n      container: null,\n      layout: 'auto',\n      theme: 'light',\n      \n      audio: {\n        sampleRate: 48000,\n        channels: 1,\n        agc: false,\n        gain: 1.0\n      },\n      \n      waveform: {\n        showOverview: true,\n        showAccumulated: true,\n        showLive: true,\n        decimation: 10,\n        colors: {\n          waveform: '#1E88E5',\n          selection: '#4CAF50',\n          playback: '#FF0000'\n        }\n      },\n      \n      storage: {\n        type: 'auto'\n      },\n      \n      callbacks: {\n        onRecordStart: () => {},\n        onRecordStop: () => {},\n        onRecordPause: () => {},\n        onRecordResume: () => {},\n        onPlayStart: () => {},\n        onPlayStop: () => {},\n        onError: (error) => console.error('VoiceBankRecorder error:', error)\n      }\n    };\n    \n    // 深度合併\n    return this.deepMerge(defaults, options);\n  }\n  \n  /**\n   * 深度合併物件\n   * @param {Object} target - 目標物件\n   * @param {Object} source - 來源物件\n   * @returns {Object}\n   */\n  deepMerge(target, source) {\n    const result = { ...target };\n    \n    for (const key in source) {\n      if (source[key] instanceof Object && !Array.isArray(source[key])) {\n        result[key] = this.deepMerge(result[key] || {}, source[key]);\n      } else {\n        result[key] = source[key];\n      }\n    }\n    \n    return result;\n  }\n  \n  /**\n   * 創建儲存適配器\n   * @param {Object} storageConfig - 儲存配置\n   * @returns {StorageAdapter}\n   */\n  createStorageAdapter(storageConfig) {\n    const { StorageFactory } = require('./storage/index.js');\n    return StorageFactory.create({\n      type: storageConfig.type || 'auto',\n      options: storageConfig\n    });\n  }\n  \n  /**\n   * 初始化 UI\n   */\n  initializeUI() {\n    // TODO: 實作 UI 初始化\n    // 這將在後續階段實作\n    console.log('UI initialization - to be implemented');\n  }\n  \n  /**\n   * 開始錄音\n   * @returns {Promise<void>}\n   */\n  async startRecording() {\n    try {\n      if (this.isRecording) {\n        throw new Error('Already recording');\n      }\n      \n      // TODO: 實作錄音邏輯\n      this.isRecording = true;\n      this.options.callbacks.onRecordStart();\n      \n      console.log('Recording started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止錄音\n   * @returns {Promise<Blob>}\n   */\n  async stopRecording() {\n    try {\n      if (!this.isRecording) {\n        throw new Error('Not recording');\n      }\n      \n      // TODO: 實作停止錄音邏輯\n      this.isRecording = false;\n      \n      // 模擬返回 Blob（實際會從 AudioEngine 獲取）\n      this.currentBlob = null; // TODO: 實際的 Blob\n      \n      this.options.callbacks.onRecordStop(this.currentBlob);\n      \n      console.log('Recording stopped');\n      return this.currentBlob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 暫停錄音\n   * @returns {Promise<void>}\n   */\n  async pauseRecording() {\n    try {\n      if (!this.isRecording || this.isPaused) {\n        throw new Error('Cannot pause');\n      }\n      \n      this.isPaused = true;\n      this.options.callbacks.onRecordPause();\n      \n      console.log('Recording paused');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 恢復錄音\n   * @returns {Promise<void>}\n   */\n  async resumeRecording() {\n    try {\n      if (!this.isRecording || !this.isPaused) {\n        throw new Error('Cannot resume');\n      }\n      \n      this.isPaused = false;\n      this.options.callbacks.onRecordResume();\n      \n      console.log('Recording resumed');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 播放錄音\n   * @returns {Promise<void>}\n   */\n  async play() {\n    try {\n      // TODO: 實作播放邏輯\n      this.options.callbacks.onPlayStart();\n      \n      console.log('Playback started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止播放\n   * @returns {Promise<void>}\n   */\n  async stop() {\n    try {\n      // TODO: 實作停止播放邏輯\n      this.options.callbacks.onPlayStop();\n      \n      console.log('Playback stopped');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存錄音\n   * @param {Blob} blob - 音訊 Blob（可選，使用當前錄音）\n   * @param {string} filename - 檔案名稱（可選，自動生成）\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async saveRecording(blob = null, filename = null, metadata = {}) {\n    try {\n      const blobToSave = blob || this.currentBlob;\n      \n      if (!blobToSave) {\n        throw new Error('No recording to save');\n      }\n      \n      const filenameToUse = filename || `recording-${Date.now()}.wav`;\n      \n      const id = await this.storage.save(blobToSave, filenameToUse, metadata);\n      \n      console.log('Recording saved:', id);\n      return id;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async loadRecording(id) {\n    try {\n      const blob = await this.storage.load(id);\n      this.currentBlob = blob;\n      \n      console.log('Recording loaded:', id);\n      return blob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async deleteRecording(id) {\n    try {\n      const result = await this.storage.delete(id);\n      \n      console.log('Recording deleted:', id);\n      return result;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有錄音\n   * @returns {Promise<Array>}\n   */\n  async listRecordings() {\n    try {\n      const recordings = await this.storage.list();\n      \n      console.log('Recordings listed:', recordings.length);\n      return recordings;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 取得當前錄音 Blob\n   * @returns {Blob|null}\n   */\n  getCurrentBlob() {\n    return this.currentBlob;\n  }\n  \n  /**\n   * 銷毀實例\n   */\n  destroy() {\n    // TODO: 清理資源\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    if (this.storage && typeof this.storage.close === 'function') {\n      this.storage.close();\n    }\n    \n    console.log('VoiceBankRecorder destroyed');\n  }\n}\n\n// 預設導出\nexport default VoiceBankRecorder;\n\n/**\n * 版本資訊\n */\nexport const VERSION = '1.0.0';\n\n/**\n * 建置資訊\n */\nexport const BUILD_INFO = {\n  version: VERSION,\n  date: new Date().toISOString(),\n  name: 'VoiceBank Recorder'\n};\n"],"names":["AudioEngine","constructor","options","config","sampleRate","autoGainControl","undefined","echoCancellation","noiseSuppression","micGain","deviceId","workletPath","preferWorklet","audioContext","analyser","preGainNode","mediaDest","analyserSilencer","workletSupported","workletLoaded","pcmCollectorNode","usingWorklet","pcmChunks","pcmTotalSamples","recorder","_pcmCaptureInterval","micStream","isRecording","isPaused","isInitialized","recordStartTime","recordStopTime","recordWallStartMs","recordWallStopMs","latestBlob","latestUrl","_eventListeners","initialize","AudioContextClass","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","createGain","gain","value","createMediaStreamDestination","connect","destination","audioWorklet","AudioWorkletNode","addModule","_emit","path","error","console","warn","state","resume","stage","startRecording","Error","_captureMicrophone","URL","revokeObjectURL","Date","now","performance","useWorklet","_startWorkletRecording","_startRecordRTCRecording","timestamp","mode","stopRecording","blob","_stopWorkletRecording","_stopRecordRTCRecording","_stopMicrophone","createObjectURL","duration","url","samples","pauseRecording","resumeRecording","getLatestRecording","getPcmWindow","start","count","length","total","Float32Array","end","Math","min","out","offset","passed","i","chunk","cLen","cStart","cEnd","segStart","max","segEnd","localStart","slice","subarray","set","getAnalyser","getAudioContext","microphoneStream","setMicGain","dispose","catch","_stopPcmCapture","close","on","event","handler","push","off","index","indexOf","splice","data","forEach","constraints","audio","video","exact","navigator","mediaDevices","getUserMedia","_applyIOSMicGainAdjustment","source","createMediaStreamSource","name","getTracks","track","stop","ua","userAgent","isIOS","test","abs","port","onmessage","type","pcmData","totalSamples","disconnect","merged","wavBuffer","_buildWavFromFloat32Mono","Blob","Promise","resolve","reject","RecordRTC","recordStream","stream","mimeType","recorderType","StereoAudioRecorder","numberOfAudioChannels","bufferSize","timeSlice","ondataavailable","_startPcmCapture","getBlob","bufferLength","dataArray","setInterval","getFloatTimeDomainData","pcmChunk","clearInterval","float32Data","numSamples","buffer","ArrayBuffer","view","DataView","_writeString","setUint32","setUint16","sample","int16","setInt16","string","setUint8","charCodeAt","WaveformRenderer","workerPath","useWorker","showClipMarks","audioEngine","liveWaveform","vuMeter","accumulatedWaveform","overviewWaveform","isVerticalMode","_overviewUpdateScheduled","_setupAudioEngineListeners","stopLive","appendPCM","liveCanvas","vuMeterCanvas","accumulatedCanvas","overviewCanvas","analyserNode","LiveWaveform","VUMeter","AccumulatedWaveform","OverviewWaveform","startLive","append","requestAnimationFrame","draw","reset","clear","canvasContext","clearRect","width","height","setVerticalMode","isVertical","_worker","postMessage","verticalMode","resize","canvas","destroy","terminate","getContext","mediaStreamSource","animationId","isRunning","amplification","_lastDataArray","_verticalScrollOffset","hasAudioContext","hasAnalyser","log","self","contextReady","err","then","e","Uint8Array","cancelAnimationFrame","getByteTimeDomainData","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","sliceWidth","x","v","y","moveTo","lineTo","stroke","scrollSpeed","sliceHeight","ctx","timeData","levelDb","peakDb","holdPeakDb","lastPeakTime","peakHoldMillis","fallRateDbPerSec","minDb","maxDb","lastClipTime","clipHoldMillis","_lastLogTime","_computeLevels","rmsDb","required","sumSquares","peak","clipped","absV","rms","sqrt","log10","Infinity","currentDb","w","h","grd","createLinearGradient","addColorStop","norm","barGrad","barWidth","round","save","db","posNorm","xPos","label","toString","font","textAlign","textBaseline","fillText","restore","minus10Norm","minus10X","holdNorm","holdX","displayRms","toFixed","displayPeak","txt","badgeW","badgeH","update","levels","elapsed","fallSeconds","fallAmount","loop","targetSampleRate","sourceSampleRate","decimationFactor","sampleMin","sampleMax","sampleCount","zoomFactor","viewStart","isAutoScroll","_panRemainder","playbackPosition","isPlaying","playbackStartTime","playbackStartSample","rawZoomMode","rawViewStart","rawVisibleRaw","_useWorker","_appendBatchMin","_appendBatchMax","_appendFlushScheduled","lastDetail","lastDensity","transferControlToOffscreen","Worker","ev","msg","detail","density","_setupMouseInteraction","isDragging","dragStartX","dragStartViewStart","addEventListener","offsetX","style","cursor","deltaX","info","getVisibleSamples","samplesPerPixel","visible","sampleDelta","_enforceViewBounds","preventDefault","rect","getBoundingClientRect","clientX","left","anchorRatio","zoomSteps","deltaY","zoomBySteps","clickRatio","clickedSample","floor","CustomEvent","time","dispatchEvent","audioSamples","factor","appendedMin","appendedMax","_lastAppendLog","blockMin","blockMax","blockSum","blockCount","j","blockMean","k","centeredSample","scrollToLatest","flush","_flushAppendBatch","setTimeout","minArr","maxArr","visibleSamples","centerY","yMin","yMax","minVis","_getMinVisibleSamples","setZoom","targetZoom","anchorSample","maxZoom","oldInfo","newInfo","oldRatio","desiredStart","stepCount","zoomStep","newZoom","pow","panBySamples","panByPixels","pixelDelta","totalDelta","intDelta","resetView","setSourceSampleRate","_getSamplePair","setPlaybackPosition","sampleIndex","setRawZoomMode","enabled","startPlayback","startSample","sr","updatePosition","rawSamples","decimatedPos","stopPlayback","_updatePlaybackPosition","_workerRef","_warnedNoData","_lastTotal","acc","_handleSeek","clickX","targetSample","halfVisible","hasAcc","visibleStart","visibleEnd","canvasWidth","canvasHeight","viewStartX","viewEndX","viewWidth","strokeRect","RecorderUI","container","document","querySelector","waveformRenderer","layout","theme","showOverview","callbacks","onRecordStart","onRecordStop","onPlayStart","onPlayStop","onError","elements","hasRecording","controlPanel","playbackController","layoutManager","renderUI","cacheElements","bindEvents","initializeSubControllers","applyInitialSettings","connectCoreModules","innerHTML","btnRecord","getElementById","btnPlay","btnPause","btnStop","btnSave","btnClear","btnLayoutToggle","recordingDuration","waveformWrapper","handleRecordToggle","handlePlay","handlePause","handleStop","handleSave","handleClear","handleLayoutToggle","handleResize","applyLayout","applyTheme","updateButtonStates","onRecordingStart","onRecordingStop","onDataAvailable","onAudioError","showError","message","confirm","updateDurationDisplay","currentLayout","dataset","newLayout","setRecordingState","btn","classList","add","textContent","remove","disabled","formatDuration","toLocaleString","seconds","minutes","secs","decimal","padStart","innerWidth","innerHeight","alert","showNotice","getState","setOptions","StorageAdapter","filename","metadata","load","id","delete","list","exists","files","file","IndexedDBAdapter","dbName","storeName","version","request","indexedDB","open","onerror","onsuccess","result","onupgradeneeded","target","objectStoreNames","contains","store","createObjectStore","keyPath","autoIncrement","createIndex","unique","transaction","objectStore","record","size","String","get","Number","getAll","records","map","date","searchByFilename","allRecords","filter","toLowerCase","includes","getStorageInfo","totalSize","reduce","sum","totalSizeMB","countRequest","clearRequest","getStorageEstimate","storage","estimate","usage","quota","usageMB","quotaMB","usagePercent","ServerAdapter","baseURL","saveEndpoint","loadEndpoint","deleteEndpoint","listEndpoint","headers","formData","FormData","Object","keys","JSON","stringify","response","fetch","method","body","ok","status","statusText","text","json","Array","isArray","saveWithProgress","onProgress","xhr","XMLHttpRequest","upload","lengthComputable","percent","loaded","responseText","key","setRequestHeader","send","ElectronAdapter","savePath","electronAPI","arrayBuffer","from","saveRecording","success","filePath","loadRecording","uint8Array","deleteRecording","directory","recordings","listRecordings","openFile","saveAs","defaultFilename","showInFolder","CapacitorAdapter","Capacitor","initialized","Filesystem","Directory","Plugins","readdir","Documents","mkdir","recursive","base64Data","blobToBase64","writeFile","metadataWithDefaults","encoding","readFile","base64ToBlob","deleteFile","audioFiles","f","endsWith","all","metaResult","parse","sort","a","b","getUri","uri","reader","FileReader","onloadend","base64","split","readAsDataURL","byteCharacters","atob","byteNumbers","byteArray","r","StorageFactory","create","createAuto","require","PlatformDetector","detect","process","versions","electron","isElectron","isCapacitor","isBrowser","isMobile","supportsAudioWorklet","prototype","supportsOffscreenCanvas","OffscreenCanvas","getInfo","platform","VoiceBankRecorder","mergeOptions","createStorageAdapter","currentBlob","initializeUI","defaults","channels","agc","waveform","showAccumulated","showLive","decimation","colors","selection","playback","onRecordPause","onRecordResume","deepMerge","storageConfig","play","blobToSave","filenameToUse","getCurrentBlob","VERSION","BUILD_INFO","toISOString"],"mappings":"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AkB,GAAG,IAAI;IAC9B,IAAI,CAACC,aAAa,GAAG,IAAI;AAC3B,EAAA;;AAEA;AACF;AACA;EACE,MAAM1b,UAAUA,GAAG;IACjB,IAAI;AACF;MACA,IAAI,CAAC2b,QAAQ,EAAE;;AAEf;MACA,IAAI,CAACC,aAAa,EAAE;;AAEpB;MACA,IAAI,CAACC,UAAU,EAAE;;AAEjB;MACA,IAAI,CAACC,wBAAwB,EAAE;;AAE/B;MACA,IAAI,CAACC,oBAAoB,EAAE;;AAE3B;MACA,IAAI,CAACC,kBAAkB,EAAE;AAEzB7a,MAAAA,OAAO,CAAC4L,GAAG,CAAC,0BAA0B,CAAC;IACzC,CAAC,CAAC,OAAO7L,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC7B,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACEya,EAAAA,QAAQA,GAAG;AACT,IAAA,IAAI,CAAClB,SAAS,CAACwB,SAAS,GAAG;AAC/B,mDAAA,EAAqD,IAAI,CAACpe,OAAO,CAACgd,MAAM,iBAAiB,IAAI,CAAChd,OAAO,CAACid,KAAK,CAAA;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAA,EAAY,IAAI,CAACjd,OAAO,CAACkd,YAAY,GAAG;AACxC;AACA;AACA;AACA;AACA,UAAA,CAAW,GAAG,EAAE;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAA,CAAK;AACH,EAAA;;AAEA;AACF;AACA;AACEa,EAAAA,aAAaA,GAAG;IACd,IAAI,CAACN,QAAQ,GAAG;AACd;AACAY,MAAAA,SAAS,EAAExB,QAAQ,CAACyB,cAAc,CAAC,gBAAgB,CAAC;AACpDC,MAAAA,OAAO,EAAE1B,QAAQ,CAACyB,cAAc,CAAC,cAAc,CAAC;AAChDE,MAAAA,QAAQ,EAAE3B,QAAQ,CAACyB,cAAc,CAAC,eAAe,CAAC;AAClDG,MAAAA,OAAO,EAAE5B,QAAQ,CAACyB,cAAc,CAAC,cAAc,CAAC;AAChDI,MAAAA,OAAO,EAAE7B,QAAQ,CAACyB,cAAc,CAAC,cAAc,CAAC;AAChDK,MAAAA,QAAQ,EAAE9B,QAAQ,CAACyB,cAAc,CAAC,eAAe,CAAC;AAClDM,MAAAA,eAAe,EAAE/B,QAAQ,CAACyB,cAAc,CAAC,uBAAuB,CAAC;AAEjE;AACAO,MAAAA,iBAAiB,EAAEhC,QAAQ,CAACyB,cAAc,CAAC,wBAAwB,CAAC;AACpE3J,MAAAA,WAAW,EAAEkI,QAAQ,CAACyB,cAAc,CAAC,kBAAkB,CAAC;AACxDQ,MAAAA,eAAe,EAAEjC,QAAQ,CAACyB,cAAc,CAAC,sBAAsB,CAAC;AAEhE;AACAzR,MAAAA,UAAU,EAAEgQ,QAAQ,CAACyB,cAAc,CAAC,mBAAmB,CAAC;AACxDxR,MAAAA,aAAa,EAAE+P,QAAQ,CAACyB,cAAc,CAAC,cAAc,CAAC;AACtDvR,MAAAA,iBAAiB,EAAE8P,QAAQ,CAACyB,cAAc,CAAC,0BAA0B,CAAC;AACtEtR,MAAAA,cAAc,EAAE6P,QAAQ,CAACyB,cAAc,CAAC,uBAAuB;KAChE;AACH,EAAA;;AAEA;AACF;AACA;AACEN,EAAAA,UAAUA,GAAG;AACX;AACA,IAAA,IAAI,IAAI,CAACP,QAAQ,CAACY,SAAS,EAAE;MAC3B,IAAI,CAACZ,QAAQ,CAACY,SAAS,CAAC9H,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACtD,IAAI,CAACwI,kBAAkB,EAAE;AAC3B,MAAA,CAAC,CAAC;AACJ,IAAA;;AAEA;AACA,IAAA,IAAI,IAAI,CAACtB,QAAQ,CAACc,OAAO,EAAE;MACzB,IAAI,CAACd,QAAQ,CAACc,OAAO,CAAChI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACpD,IAAI,CAACyI,UAAU,EAAE;AACnB,MAAA,CAAC,CAAC;AACJ,IAAA;AAEA,IAAA,IAAI,IAAI,CAACvB,QAAQ,CAACe,QAAQ,EAAE;MAC1B,IAAI,CAACf,QAAQ,CAACe,QAAQ,CAACjI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACrD,IAAI,CAAC0I,WAAW,EAAE;AACpB,MAAA,CAAC,CAAC;AACJ,IAAA;AAEA,IAAA,IAAI,IAAI,CAACxB,QAAQ,CAACgB,OAAO,EAAE;MACzB,IAAI,CAAChB,QAAQ,CAACgB,OAAO,CAAClI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACpD,IAAI,CAAC2I,UAAU,EAAE;AACnB,MAAA,CAAC,CAAC;AACJ,IAAA;;AAEA;AACA,IAAA,IAAI,IAAI,CAACzB,QAAQ,CAACiB,OAAO,EAAE;MACzB,IAAI,CAACjB,QAAQ,CAACiB,OAAO,CAACnI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACpD,IAAI,CAAC4I,UAAU,EAAE;AACnB,MAAA,CAAC,CAAC;AACJ,IAAA;AAEA,IAAA,IAAI,IAAI,CAAC1B,QAAQ,CAACkB,QAAQ,EAAE;MAC1B,IAAI,CAAClB,QAAQ,CAACkB,QAAQ,CAACpI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QACrD,IAAI,CAAC6I,WAAW,EAAE;AACpB,MAAA,CAAC,CAAC;AACJ,IAAA;AAEA,IAAA,IAAI,IAAI,CAAC3B,QAAQ,CAACmB,eAAe,EAAE;MACjC,IAAI,CAACnB,QAAQ,CAACmB,eAAe,CAACrI,gBAAgB,CAAC,OAAO,EAAE,MAAM;QAC5D,IAAI,CAAC8I,kBAAkB,EAAE;AAC3B,MAAA,CAAC,CAAC;AACJ,IAAA;;AAEA;AACAhd,IAAAA,MAAM,CAACkU,gBAAgB,CAAC,QAAQ,EAAE,MAAM;MACtC,IAAI,CAAC+I,YAAY,EAAE;AACrB,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACErB,EAAAA,wBAAwBA,GAAG;AACzB;AACA;AACA;AAAA,EAAA;;AAGF;AACF;AACA;AACEC,EAAAA,oBAAoBA,GAAG;AACrB;IACA,IAAI,CAACqB,WAAW,CAAC,IAAI,CAACvf,OAAO,CAACgd,MAAM,CAAC;;AAErC;IACA,IAAI,CAACwC,UAAU,CAAC,IAAI,CAACxf,OAAO,CAACid,KAAK,CAAC;;AAEnC;IACA,IAAI,CAACwC,kBAAkB,EAAE;AAC3B,EAAA;;AAEA;AACF;AACA;AACEtB,EAAAA,kBAAkBA,GAAG;IACnB,IAAI,CAAC,IAAI,CAAChS,WAAW,IAAI,CAAC,IAAI,CAAC4Q,gBAAgB,EAAE;AAC/CzZ,MAAAA,OAAO,CAACC,IAAI,CAAC,+DAA+D,CAAC;AAC7E,MAAA;AACF,IAAA;;AAEA;AACA,IAAA,IAAI,CAAC4I,WAAW,CAAC/E,EAAE,CAAC,iBAAiB,EAAE,MAAM;MAC3C,IAAI,CAACsY,gBAAgB,EAAE;AACzB,IAAA,CAAC,CAAC;IAEF,IAAI,CAACvT,WAAW,CAAC/E,EAAE,CAAC,gBAAgB,EAAGQ,IAAI,IAAK;AAC9C,MAAA,IAAI,CAAC+X,eAAe,CAAC/X,IAAI,CAAC;AAC5B,IAAA,CAAC,CAAC;IAEF,IAAI,CAACuE,WAAW,CAAC/E,EAAE,CAAC,gBAAgB,EAAGQ,IAAI,IAAK;AAC9C,MAAA,IAAI,CAACgY,eAAe,CAAChY,IAAI,CAAC;AAC5B,IAAA,CAAC,CAAC;IAEF,IAAI,CAACuE,WAAW,CAAC/E,EAAE,CAAC,OAAO,EAAG/D,KAAK,IAAK;AACtC,MAAA,IAAI,CAACwc,YAAY,CAACxc,KAAK,CAAC;AAC1B,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;;AAEA;AACF;AACA;EACE,MAAM0b,kBAAkBA,GAAG;IACzB,IAAI;AACF,MAAA,IAAI,IAAI,CAACvb,KAAK,CAAC/B,WAAW,EAAE;AAC1B;AACA,QAAA,MAAM,IAAI,CAAC0K,WAAW,CAAC3H,aAAa,EAAE;AACxC,MAAA,CAAC,MAAM;AACL;AACA,QAAA,MAAM,IAAI,CAAC2H,WAAW,CAACxI,cAAc,EAAE;AACzC,MAAA;IACF,CAAC,CAAC,OAAON,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;MAC7B,IAAI,CAACyc,SAAS,CAAC,SAAS,GAAGzc,KAAK,CAAC0c,OAAO,CAAC;AAC3C,IAAA;AACF,EAAA;;AAEA;AACF;AACA;EACE,MAAMf,UAAUA,GAAG;IACjB,IAAI;AACF;AACA1b,MAAAA,OAAO,CAAC4L,GAAG,CAAC,gBAAgB,CAAC;AAC7B,MAAA,IAAI,CAACiO,SAAS,CAACG,WAAW,EAAE;IAC9B,CAAC,CAAC,OAAOja,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,IAAA;AACF,EAAA;;AAEA;AACF;AACA;EACE,MAAM4b,WAAWA,GAAG;IAClB,IAAI;AACF;AACA3b,MAAAA,OAAO,CAAC4L,GAAG,CAAC,gBAAgB,CAAC;IAC/B,CAAC,CAAC,OAAO7L,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,IAAA;AACF,EAAA;;AAEA;AACF;AACA;EACE,MAAM6b,UAAUA,GAAG;IACjB,IAAI;AACF;AACA5b,MAAAA,OAAO,CAAC4L,GAAG,CAAC,eAAe,CAAC;AAC5B,MAAA,IAAI,CAACiO,SAAS,CAACI,UAAU,EAAE;IAC7B,CAAC,CAAC,OAAOla,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,IAAA;AACF,EAAA;;AAEA;AACF;AACA;EACE,MAAM8b,UAAUA,GAAG;IACjB,IAAI;AACF;AACA7b,MAAAA,OAAO,CAAC4L,GAAG,CAAC,gBAAgB,CAAC;IAC/B,CAAC,CAAC,OAAO7L,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,IAAA;AACF,EAAA;;AAEA;AACF;AACA;EACE,MAAM+b,WAAWA,GAAG;AAClB,IAAA,IAAI,CAACY,OAAO,CAAC,aAAa,CAAC,EAAE;AAC3B,MAAA;AACF,IAAA;IAEA,IAAI;AACF;MACA,IAAI,IAAI,CAACjD,gBAAgB,EAAE;AACzB,QAAA,IAAI,CAACA,gBAAgB,CAACrP,KAAK,EAAE;AAC/B,MAAA;;AAEA;AACA,MAAA,IAAI,CAAClK,KAAK,CAACka,YAAY,GAAG,KAAK;AAC/B,MAAA,IAAI,CAACla,KAAK,CAACsB,QAAQ,GAAG,CAAC;AACvB,MAAA,IAAI,CAACtB,KAAK,CAACmR,WAAW,GAAG,CAAC;;AAE1B;MACA,IAAI,CAACsL,qBAAqB,EAAE;MAC5B,IAAI,CAACR,kBAAkB,EAAE;AAEzBnc,MAAAA,OAAO,CAAC4L,GAAG,CAAC,mBAAmB,CAAC;IAClC,CAAC,CAAC,OAAO7L,KAAK,EAAE;AACd,MAAA,IAAI,CAAC8Z,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACEgc,EAAAA,kBAAkBA,GAAG;IACnB,MAAMa,aAAa,GAAG,IAAI,CAACtD,SAAS,CAACuD,OAAO,CAACnD,MAAM;IACnD,MAAMoD,SAAS,GAAGF,aAAa,KAAK,YAAY,GAAG,UAAU,GAAG,YAAY;AAC5E,IAAA,IAAI,CAACX,WAAW,CAACa,SAAS,CAAC;AAC7B,EAAA;;AAEA;AACF;AACA;AACEd,EAAAA,YAAYA,GAAG;AACb;IACA,IAAI,IAAI,CAACvC,gBAAgB,EAAE;AACzB,MAAA,IAAI,CAACA,gBAAgB,CAAC1O,MAAM,EAAE;AAChC,IAAA;AACF,EAAA;;AAEA;;AAEA;AACF;AACA;AACEqR,EAAAA,gBAAgBA,GAAG;AACjB,IAAA,IAAI,CAAClc,KAAK,CAAC/B,WAAW,GAAG,IAAI;AAC7B,IAAA,IAAI,CAAC+B,KAAK,CAACka,YAAY,GAAG,IAAI;;AAE9B;AACA,IAAA,IAAI,CAAC2C,iBAAiB,CAAC,IAAI,CAAC;IAC5B,IAAI,CAACZ,kBAAkB,EAAE;;AAEzB;IACA,IAAI,IAAI,CAAC1C,gBAAgB,EAAE;;AAI3B;AACA,IAAA,IAAI,CAACI,SAAS,CAACC,aAAa,EAAE;AAE9B9Z,IAAAA,OAAO,CAAC4L,GAAG,CAAC,uBAAuB,CAAC;AACtC,EAAA;;AAEA;AACF;AACA;EACEyQ,eAAeA,CAAC/X,IAAI,EAAE;AACpB,IAAA,IAAI,CAACpE,KAAK,CAAC/B,WAAW,GAAG,KAAK;;AAE9B;AACA,IAAA,IAAI,CAAC4e,iBAAiB,CAAC,KAAK,CAAC;IAC7B,IAAI,CAACZ,kBAAkB,EAAE;;AAEzB;AACA,IAAA,IAAI,CAACtC,SAAS,CAACE,YAAY,CAACzV,IAAI,CAAC;AAEjCtE,IAAAA,OAAO,CAAC4L,GAAG,CAAC,sBAAsB,EAAEtH,IAAI,CAAC;AAC3C,EAAA;;AAEA;AACF;AACA;EACEgY,eAAeA,CAAChY,IAAI,EAAE;AACpB;AACA,IAAA,IAAIA,IAAI,CAAC9C,QAAQ,KAAK1E,SAAS,EAAE;AAC/B,MAAA,IAAI,CAACoD,KAAK,CAACsB,QAAQ,GAAG8C,IAAI,CAAC9C,QAAQ;AACrC,IAAA;AACA,IAAA,IAAI8C,IAAI,CAAC+M,WAAW,KAAKvU,SAAS,EAAE;AAClC,MAAA,IAAI,CAACoD,KAAK,CAACmR,WAAW,GAAG/M,IAAI,CAAC+M,WAAW;AAC3C,IAAA;;AAEA;IACA,IAAI,CAACsL,qBAAqB,EAAE;AAC9B,EAAA;;AAEA;AACF;AACA;EACEJ,YAAYA,CAACxc,KAAK,EAAE;IAClB,IAAI,CAACyc,SAAS,CAAC,OAAO,GAAGzc,KAAK,CAAC0c,OAAO,CAAC;AACvC,IAAA,IAAI,CAAC5C,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AAC/B,EAAA;;AAEA;;AAEA;AACF;AACA;AACA;EACEgd,iBAAiBA,CAAC5e,WAAW,EAAE;AAC7B,IAAA,MAAM6e,GAAG,GAAG,IAAI,CAAC7C,QAAQ,CAACY,SAAS;IACnC,IAAI,CAACiC,GAAG,EAAE;AAEV,IAAA,IAAI7e,WAAW,EAAE;AACf6e,MAAAA,GAAG,CAACC,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MAC9BF,GAAG,CAACxD,aAAa,CAAC,OAAO,CAAC,CAAC2D,WAAW,GAAG,GAAG;MAC5CH,GAAG,CAACxD,aAAa,CAAC,QAAQ,CAAC,CAAC2D,WAAW,GAAG,MAAM;AAClD,IAAA,CAAC,MAAM;AACLH,MAAAA,GAAG,CAACC,SAAS,CAACG,MAAM,CAAC,WAAW,CAAC;MACjCJ,GAAG,CAACxD,aAAa,CAAC,OAAO,CAAC,CAAC2D,WAAW,GAAG,GAAG;MAC5CH,GAAG,CAACxD,aAAa,CAAC,QAAQ,CAAC,CAAC2D,WAAW,GAAG,MAAM;AAClD,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACEhB,EAAAA,kBAAkBA,GAAG;IACnB,MAAM;MAAEhe,WAAW;MAAEwT,SAAS;MAAEvT,QAAQ;AAAEgc,MAAAA;KAAc,GAAG,IAAI,CAACla,KAAK;;AAErE;AACA,IAAA,IAAI,IAAI,CAACia,QAAQ,CAACY,SAAS,EAAE;AAC3B,MAAA,IAAI,CAACZ,QAAQ,CAACY,SAAS,CAACsC,QAAQ,GAAG1L,SAAS;AAC9C,IAAA;;AAEA;AACA,IAAA,IAAI,IAAI,CAACwI,QAAQ,CAACc,OAAO,EAAE;AACzB,MAAA,IAAI,CAACd,QAAQ,CAACc,OAAO,CAACoC,QAAQ,GAAG,CAACjD,YAAY,IAAIjc,WAAW,IAAIwT,SAAS;AAC5E,IAAA;AAEA,IAAA,IAAI,IAAI,CAACwI,QAAQ,CAACe,QAAQ,EAAE;MAC1B,IAAI,CAACf,QAAQ,CAACe,QAAQ,CAACmC,QAAQ,GAAG,CAAC1L,SAAS,IAAIvT,QAAQ;AAC1D,IAAA;AAEA,IAAA,IAAI,IAAI,CAAC+b,QAAQ,CAACgB,OAAO,EAAE;MACzB,IAAI,CAAChB,QAAQ,CAACgB,OAAO,CAACkC,QAAQ,GAAG,CAAC1L,SAAS,IAAI,CAACvT,QAAQ;AAC1D,IAAA;;AAEA;AACA,IAAA,IAAI,IAAI,CAAC+b,QAAQ,CAACiB,OAAO,EAAE;MACzB,IAAI,CAACjB,QAAQ,CAACiB,OAAO,CAACiC,QAAQ,GAAG,CAACjD,YAAY,IAAIjc,WAAW;AAC/D,IAAA;AAEA,IAAA,IAAI,IAAI,CAACgc,QAAQ,CAACkB,QAAQ,EAAE;MAC1B,IAAI,CAAClB,QAAQ,CAACkB,QAAQ,CAACgC,QAAQ,GAAG,CAACjD,YAAY,IAAIjc,WAAW;AAChE,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACEwe,EAAAA,qBAAqBA,GAAG;AACtB,IAAA,IAAI,IAAI,CAACxC,QAAQ,CAACoB,iBAAiB,EAAE;AACnC,MAAA,IAAI,CAACpB,QAAQ,CAACoB,iBAAiB,CAAC4B,WAAW,GAAG,IAAI,CAACG,cAAc,CAAC,IAAI,CAACpd,KAAK,CAACsB,QAAQ,CAAC;AACxF,IAAA;AAEA,IAAA,IAAI,IAAI,CAAC2Y,QAAQ,CAAC9I,WAAW,EAAE;AAC7B,MAAA,IAAI,CAAC8I,QAAQ,CAAC9I,WAAW,CAAC8L,WAAW,GAAG,CAAA,EAAG,IAAI,CAACjd,KAAK,CAACmR,WAAW,CAACkM,cAAc,EAAE,CAAA,QAAA,CAAU;AAC9F,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACED,cAAcA,CAACE,OAAO,EAAE;IACtB,MAAMC,OAAO,GAAGpb,IAAI,CAACkS,KAAK,CAACiJ,OAAO,GAAG,EAAE,CAAC;IACxC,MAAME,IAAI,GAAGrb,IAAI,CAACkS,KAAK,CAACiJ,OAAO,GAAG,EAAE,CAAC;IACrC,MAAMG,OAAO,GAAGtb,IAAI,CAACkS,KAAK,CAAEiJ,OAAO,GAAG,CAAC,GAAI,EAAE,CAAC;AAE9C,IAAA,OAAO,CAAA,EAAGC,OAAO,CAAC/N,QAAQ,EAAE,CAACkO,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAAA,CAAA,EAAIF,IAAI,CAAChO,QAAQ,EAAE,CAACkO,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAAA,CAAA,EAAID,OAAO,CAAA,CAAE;AAChG,EAAA;;AAEA;AACF;AACA;AACA;EACE1B,WAAWA,CAACvC,MAAM,EAAE;IAClB,IAAIA,MAAM,KAAK,MAAM,EAAE;AACrB;MACAA,MAAM,GAAG3a,MAAM,CAAC8e,UAAU,GAAG9e,MAAM,CAAC+e,WAAW,GAAG,YAAY,GAAG,UAAU;AAC7E,IAAA;AAEA,IAAA,IAAI,CAACxE,SAAS,CAACuD,OAAO,CAACnD,MAAM,GAAGA,MAAM;AACtC,IAAA,IAAI,CAAChd,OAAO,CAACgd,MAAM,GAAGA,MAAM;;AAE5B;IACA,IAAI,IAAI,CAACD,gBAAgB,EAAE;MACzB,IAAI,CAACA,gBAAgB,CAAC/O,eAAe,CAACgP,MAAM,KAAK,UAAU,CAAC;AAC9D,IAAA;AAEA1Z,IAAAA,OAAO,CAAC4L,GAAG,CAAC,CAAA,sBAAA,EAAyB8N,MAAM,EAAE,CAAC;AAChD,EAAA;;AAEA;AACF;AACA;AACA;EACEwC,UAAUA,CAACvC,KAAK,EAAE;AAChB,IAAA,IAAI,CAACL,SAAS,CAACuD,OAAO,CAAClD,KAAK,GAAGA,KAAK;AACpC,IAAA,IAAI,CAACjd,OAAO,CAACid,KAAK,GAAGA,KAAK;AAE1B3Z,IAAAA,OAAO,CAAC4L,GAAG,CAAC,CAAA,qBAAA,EAAwB+N,KAAK,EAAE,CAAC;AAC9C,EAAA;;AAEA;AACF;AACA;AACA;EACE6C,SAASA,CAACC,OAAO,EAAE;AACjB;AACAsB,IAAAA,KAAK,CAAC,KAAK,GAAGtB,OAAO,CAAC;AACxB,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACEuB,EAAAA,UAAUA,CAACvB,OAAO,EAAEjb,QAAQ,GAAG,IAAI,EAAE;AACnC;AACAxB,IAAAA,OAAO,CAAC4L,GAAG,CAAC,YAAY,EAAE6Q,OAAO,CAAC;AACpC,EAAA;;AAEA;;AAEA;AACF;AACA;AACA;AACEwB,EAAAA,QAAQA,GAAG;IACT,OAAO;AAAE,MAAA,GAAG,IAAI,CAAC/d;KAAO;AAC1B,EAAA;;AAEA;AACF;AACA;AACA;EACEge,UAAUA,CAACxhB,OAAO,EAAE;IAClB,IAAI,CAACA,OAAO,GAAG;MAAE,GAAG,IAAI,CAACA,OAAO;MAAE,GAAGA;KAAS;;AAE9C;IACA,IAAIA,OAAO,CAACgd,MAAM,EAAE;AAClB,MAAA,IAAI,CAACuC,WAAW,CAACvf,OAAO,CAACgd,MAAM,CAAC;AAClC,IAAA;IACA,IAAIhd,OAAO,CAACid,KAAK,EAAE;AACjB,MAAA,IAAI,CAACuC,UAAU,CAACxf,OAAO,CAACid,KAAK,CAAC;AAChC,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACE1O,EAAAA,OAAOA,GAAG;AACR;AACA;;AAEA;IACA,IAAI,IAAI,CAACqO,SAAS,EAAE;AAClB,MAAA,IAAI,CAACA,SAAS,CAACwB,SAAS,GAAG,EAAE;AAC/B,IAAA;;AAEA;AACA,IAAA,IAAI,CAACX,QAAQ,GAAG,EAAE;IAClB,IAAI,CAACtR,WAAW,GAAG,IAAI;IACvB,IAAI,CAAC4Q,gBAAgB,GAAG,IAAI;AAE5BzZ,IAAAA,OAAO,CAAC4L,GAAG,CAAC,0BAA0B,CAAC;AACzC,EAAA;AACF;;AC3qBA;AACA;AACA;AACA;;AAEO,MAAMuS,cAAc,CAAC;AAC1B;AACF;AACA;AACA;AACA;AACA;AACA;EACE,MAAM9O,IAAIA,CAAClO,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAE;AACxC,IAAA,MAAM,IAAI/d,KAAK,CAAC,wCAAwC,CAAC;AAC3D,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMge,IAAIA,CAACC,EAAE,EAAE;AACb,IAAA,MAAM,IAAIje,KAAK,CAAC,wCAAwC,CAAC;AAC3D,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMke,MAAMA,CAACD,EAAE,EAAE;AACf,IAAA,MAAM,IAAIje,KAAK,CAAC,0CAA0C,CAAC;AAC7D,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMme,IAAIA,GAAG;AACX,IAAA,MAAM,IAAIne,KAAK,CAAC,wCAAwC,CAAC;AAC3D,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMoe,MAAMA,CAACH,EAAE,EAAE;IACf,IAAI;AACF,MAAA,MAAM,IAAI,CAACD,IAAI,CAACC,EAAE,CAAC;AACnB,MAAA,OAAO,IAAI;IACb,CAAC,CAAC,OAAOxe,KAAK,EAAE;AACd,MAAA,OAAO,KAAK;AACd,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMsK,KAAKA,GAAG;AACZ,IAAA,MAAMsU,KAAK,GAAG,MAAM,IAAI,CAACF,IAAI,EAAE;IAC/B,IAAIzc,KAAK,GAAG,CAAC;AAEb,IAAA,KAAK,MAAM4c,IAAI,IAAID,KAAK,EAAE;MACxB,IAAI;QACF,MAAM,IAAI,CAACH,MAAM,CAACI,IAAI,CAACL,EAAE,IAAIK,IAAI,CAACR,QAAQ,CAAC;AAC3Cpc,QAAAA,KAAK,EAAE;MACT,CAAC,CAAC,OAAOjC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAE6e,IAAI,EAAE7e,KAAK,CAAC;AACtD,MAAA;AACF,IAAA;AAEA,IAAA,OAAOiC,KAAK;AACd,EAAA;AACF;;AC5EA;AACA;AACA;AACA;;AAIO,MAAM6c,gBAAgB,SAASV,cAAc,CAAC;AACnD;AACF;AACA;AACA;AACA;AACA;AACE1hB,EAAAA,WAAWA,CAACqiB,MAAM,GAAG,aAAa,EAAEC,SAAS,GAAG,YAAY,EAAEC,OAAO,GAAG,CAAC,EAAE;AACzE,IAAA,KAAK,EAAE;IACP,IAAI,CAACF,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAAC1P,EAAE,GAAG,IAAI;AAChB,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMzQ,UAAUA,GAAG;IACjB,IAAI,IAAI,CAACyQ,EAAE,EAAE;MACX,OAAO,IAAI,CAACA,EAAE;AAChB,IAAA;AAEA,IAAA,OAAO,IAAIjJ,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Y,OAAO,GAAGC,SAAS,CAACC,IAAI,CAAC,IAAI,CAACL,MAAM,EAAE,IAAI,CAACE,OAAO,CAAC;MAEzDC,OAAO,CAACG,OAAO,GAAG,MAAM;QACtB7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,0BAAA,EAA6B2e,OAAO,CAAClf,KAAK,CAAA,CAAE,CAAC,CAAC;MACjE,CAAC;MAEDkf,OAAO,CAACI,SAAS,GAAG,MAAM;AACxB,QAAA,IAAI,CAAC/P,EAAE,GAAG2P,OAAO,CAACK,MAAM;AACxBhZ,QAAAA,OAAO,CAAC,IAAI,CAACgJ,EAAE,CAAC;MAClB,CAAC;AAED2P,MAAAA,OAAO,CAACM,eAAe,GAAIxb,KAAK,IAAK;AACnC,QAAA,MAAMuL,EAAE,GAAGvL,KAAK,CAACyb,MAAM,CAACF,MAAM;;AAE9B;QACA,IAAI,CAAChQ,EAAE,CAACmQ,gBAAgB,CAACC,QAAQ,CAAC,IAAI,CAACX,SAAS,CAAC,EAAE;UACjD,MAAMY,KAAK,GAAGrQ,EAAE,CAACsQ,iBAAiB,CAAC,IAAI,CAACb,SAAS,EAAE;AACjDc,YAAAA,OAAO,EAAE,IAAI;AACbC,YAAAA,aAAa,EAAE;AACjB,WAAC,CAAC;;AAEF;AACAH,UAAAA,KAAK,CAACI,WAAW,CAAC,UAAU,EAAE,UAAU,EAAE;AAAEC,YAAAA,MAAM,EAAE;AAAM,WAAC,CAAC;AAC5DL,UAAAA,KAAK,CAACI,WAAW,CAAC,WAAW,EAAE,WAAW,EAAE;AAAEC,YAAAA,MAAM,EAAE;AAAM,WAAC,CAAC;AAC9DL,UAAAA,KAAK,CAACI,WAAW,CAAC,UAAU,EAAE,UAAU,EAAE;AAAEC,YAAAA,MAAM,EAAE;AAAM,WAAC,CAAC;AAC9D,QAAA;MACF,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,MAAM3Q,IAAIA,CAAClO,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAE;AACxC,IAAA,MAAM,IAAI,CAACxf,UAAU,EAAE;AAEvB,IAAA,OAAO,IAAIwH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Z,WAAW,GAAG,IAAI,CAAC3Q,EAAE,CAAC2Q,WAAW,CAAC,CAAC,IAAI,CAAClB,SAAS,CAAC,EAAE,WAAW,CAAC;MACtE,MAAMY,KAAK,GAAGM,WAAW,CAACC,WAAW,CAAC,IAAI,CAACnB,SAAS,CAAC;AAErD,MAAA,MAAMoB,MAAM,GAAG;AACb/B,QAAAA,QAAQ,EAAEA,QAAQ;AAClBjd,QAAAA,IAAI,EAAEA,IAAI;QACVif,IAAI,EAAEjf,IAAI,CAACif,IAAI;QACfva,IAAI,EAAE1E,IAAI,CAAC0E,IAAI;AACf7E,QAAAA,SAAS,EAAEN,IAAI,CAACC,GAAG,EAAE;AACrB0d,QAAAA,QAAQ,EAAEA;OACX;AAED,MAAA,MAAMY,OAAO,GAAGU,KAAK,CAACzC,GAAG,CAACiD,MAAM,CAAC;MAEjClB,OAAO,CAACI,SAAS,GAAG,MAAM;AACxB/Y,QAAAA,OAAO,CAAC+Z,MAAM,CAACpB,OAAO,CAACK,MAAM,CAAC,CAAC;MACjC,CAAC;MAEDL,OAAO,CAACG,OAAO,GAAG,MAAM;QACtB7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,0BAAA,EAA6B2e,OAAO,CAAClf,KAAK,CAAA,CAAE,CAAC,CAAC;MACjE,CAAC;MAEDkgB,WAAW,CAACb,OAAO,GAAG,MAAM;QAC1B7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,oBAAA,EAAuB2f,WAAW,CAAClgB,KAAK,CAAA,CAAE,CAAC,CAAC;MAC/D,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMue,IAAIA,CAACC,EAAE,EAAE;AACb,IAAA,MAAM,IAAI,CAAC1f,UAAU,EAAE;AAEvB,IAAA,OAAO,IAAIwH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Z,WAAW,GAAG,IAAI,CAAC3Q,EAAE,CAAC2Q,WAAW,CAAC,CAAC,IAAI,CAAClB,SAAS,CAAC,EAAE,UAAU,CAAC;MACrE,MAAMY,KAAK,GAAGM,WAAW,CAACC,WAAW,CAAC,IAAI,CAACnB,SAAS,CAAC;MACrD,MAAME,OAAO,GAAGU,KAAK,CAACW,GAAG,CAACC,MAAM,CAAChC,EAAE,CAAC,CAAC;MAErCU,OAAO,CAACI,SAAS,GAAG,MAAM;AACxB,QAAA,MAAMc,MAAM,GAAGlB,OAAO,CAACK,MAAM;AAC7B,QAAA,IAAIa,MAAM,IAAIA,MAAM,CAAChf,IAAI,EAAE;AACzBmF,UAAAA,OAAO,CAAC6Z,MAAM,CAAChf,IAAI,CAAC;AACtB,QAAA,CAAC,MAAM;UACLoF,MAAM,CAAC,IAAIjG,KAAK,CAAC,wBAAwBie,EAAE,CAAA,CAAE,CAAC,CAAC;AACjD,QAAA;MACF,CAAC;MAEDU,OAAO,CAACG,OAAO,GAAG,MAAM;QACtB7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,0BAAA,EAA6B2e,OAAO,CAAClf,KAAK,CAAA,CAAE,CAAC,CAAC;MACjE,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMye,MAAMA,CAACD,EAAE,EAAE;AACf,IAAA,MAAM,IAAI,CAAC1f,UAAU,EAAE;AAEvB,IAAA,OAAO,IAAIwH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Z,WAAW,GAAG,IAAI,CAAC3Q,EAAE,CAAC2Q,WAAW,CAAC,CAAC,IAAI,CAAClB,SAAS,CAAC,EAAE,WAAW,CAAC;MACtE,MAAMY,KAAK,GAAGM,WAAW,CAACC,WAAW,CAAC,IAAI,CAACnB,SAAS,CAAC;MACrD,MAAME,OAAO,GAAGU,KAAK,CAACnB,MAAM,CAAC+B,MAAM,CAAChC,EAAE,CAAC,CAAC;MAExCU,OAAO,CAACI,SAAS,GAAG,MAAM;QACxB/Y,OAAO,CAAC,IAAI,CAAC;MACf,CAAC;MAED2Y,OAAO,CAACG,OAAO,GAAG,MAAM;QACtB7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,4BAAA,EAA+B2e,OAAO,CAAClf,KAAK,CAAA,CAAE,CAAC,CAAC;MACnE,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM0e,IAAIA,GAAG;AACX,IAAA,MAAM,IAAI,CAAC5f,UAAU,EAAE;AAEvB,IAAA,OAAO,IAAIwH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Z,WAAW,GAAG,IAAI,CAAC3Q,EAAE,CAAC2Q,WAAW,CAAC,CAAC,IAAI,CAAClB,SAAS,CAAC,EAAE,UAAU,CAAC;MACrE,MAAMY,KAAK,GAAGM,WAAW,CAACC,WAAW,CAAC,IAAI,CAACnB,SAAS,CAAC;AACrD,MAAA,MAAME,OAAO,GAAGU,KAAK,CAACa,MAAM,EAAE;MAE9BvB,OAAO,CAACI,SAAS,GAAG,MAAM;QACxB,MAAMoB,OAAO,GAAGxB,OAAO,CAACK,MAAM,CAACoB,GAAG,CAACP,MAAM,KAAK;AAC5C5B,UAAAA,EAAE,EAAE8B,MAAM,CAACF,MAAM,CAAC5B,EAAE,CAAC;UACrBH,QAAQ,EAAE+B,MAAM,CAAC/B,QAAQ;UACzBgC,IAAI,EAAED,MAAM,CAACC,IAAI;UACjBva,IAAI,EAAEsa,MAAM,CAACta,IAAI;UACjB7E,SAAS,EAAEmf,MAAM,CAACnf,SAAS;AAC3B2f,UAAAA,IAAI,EAAE,IAAIjgB,IAAI,CAACyf,MAAM,CAACnf,SAAS,CAAC;AAChCqd,UAAAA,QAAQ,EAAE8B,MAAM,CAAC9B,QAAQ,IAAI;AAC/B,SAAC,CAAC,CAAC;QACH/X,OAAO,CAACma,OAAO,CAAC;MAClB,CAAC;MAEDxB,OAAO,CAACG,OAAO,GAAG,MAAM;QACtB7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,2BAAA,EAA8B2e,OAAO,CAAClf,KAAK,CAAA,CAAE,CAAC,CAAC;MAClE,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAM6gB,gBAAgBA,CAACxC,QAAQ,EAAE;AAC/B,IAAA,MAAMyC,UAAU,GAAG,MAAM,IAAI,CAACpC,IAAI,EAAE;IACpC,OAAOoC,UAAU,CAACC,MAAM,CAACX,MAAM,IAC7BA,MAAM,CAAC/B,QAAQ,CAAC2C,WAAW,EAAE,CAACC,QAAQ,CAAC5C,QAAQ,CAAC2C,WAAW,EAAE,CAC/D,CAAC;AACH,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAME,cAAcA,GAAG;AACrB,IAAA,MAAMR,OAAO,GAAG,MAAM,IAAI,CAAChC,IAAI,EAAE;AACjC,IAAA,MAAMyC,SAAS,GAAGT,OAAO,CAACU,MAAM,CAAC,CAACC,GAAG,EAAEjB,MAAM,KAAKiB,GAAG,GAAGjB,MAAM,CAACC,IAAI,EAAE,CAAC,CAAC;IAEvE,OAAO;MACLpe,KAAK,EAAEye,OAAO,CAACxe,MAAM;AACrBif,MAAAA,SAAS,EAAEA,SAAS;AACpBG,MAAAA,WAAW,EAAE,CAACH,SAAS,IAAI,IAAI,GAAG,IAAI,CAAC,EAAE7Q,OAAO,CAAC,CAAC,CAAC;AACnDoQ,MAAAA,OAAO,EAAEA;KACV;AACH,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMpW,KAAKA,GAAG;AACZ,IAAA,MAAM,IAAI,CAACxL,UAAU,EAAE;AAEvB,IAAA,OAAO,IAAIwH,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM0Z,WAAW,GAAG,IAAI,CAAC3Q,EAAE,CAAC2Q,WAAW,CAAC,CAAC,IAAI,CAAClB,SAAS,CAAC,EAAE,WAAW,CAAC;MACtE,MAAMY,KAAK,GAAGM,WAAW,CAACC,WAAW,CAAC,IAAI,CAACnB,SAAS,CAAC;;AAErD;AACA,MAAA,MAAMuC,YAAY,GAAG3B,KAAK,CAAC3d,KAAK,EAAE;MAElCsf,YAAY,CAACjC,SAAS,GAAG,MAAM;AAC7B,QAAA,MAAMrd,KAAK,GAAGsf,YAAY,CAAChC,MAAM;;AAEjC;AACA,QAAA,MAAMiC,YAAY,GAAG5B,KAAK,CAACtV,KAAK,EAAE;QAElCkX,YAAY,CAAClC,SAAS,GAAG,MAAM;UAC7B/Y,OAAO,CAACtE,KAAK,CAAC;QAChB,CAAC;QAEDuf,YAAY,CAACnC,OAAO,GAAG,MAAM;UAC3B7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,4BAAA,EAA+BihB,YAAY,CAACxhB,KAAK,CAAA,CAAE,CAAC,CAAC;QACxE,CAAC;MACH,CAAC;MAEDuhB,YAAY,CAAClC,OAAO,GAAG,MAAM;QAC3B7Y,MAAM,CAAC,IAAIjG,KAAK,CAAC,CAAA,4BAAA,EAA+BghB,YAAY,CAACvhB,KAAK,CAAA,CAAE,CAAC,CAAC;MACxE,CAAC;AACH,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMyhB,kBAAkBA,GAAG;IACzB,IAAI,SAAS,IAAI5c,SAAS,IAAI,UAAU,IAAIA,SAAS,CAAC6c,OAAO,EAAE;MAC7D,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAM9c,SAAS,CAAC6c,OAAO,CAACC,QAAQ,EAAE;QACnD,OAAO;UACLC,KAAK,EAAED,QAAQ,CAACC,KAAK;UACrBC,KAAK,EAAEF,QAAQ,CAACE,KAAK;AACrBC,UAAAA,OAAO,EAAE,CAACH,QAAQ,CAACC,KAAK,IAAI,IAAI,GAAG,IAAI,CAAC,EAAEtR,OAAO,CAAC,CAAC,CAAC;AACpDyR,UAAAA,OAAO,EAAE,CAACJ,QAAQ,CAACE,KAAK,IAAI,IAAI,GAAG,IAAI,CAAC,EAAEvR,OAAO,CAAC,CAAC,CAAC;AACpD0R,UAAAA,YAAY,EAAE,CAAEL,QAAQ,CAACC,KAAK,GAAGD,QAAQ,CAACE,KAAK,GAAI,GAAG,EAAEvR,OAAO,CAAC,CAAC;SAClE;MACH,CAAC,CAAC,OAAOtQ,KAAK,EAAE;AACdC,QAAAA,OAAO,CAACC,IAAI,CAAC,iCAAiC,EAAEF,KAAK,CAAC;AACtD,QAAA,OAAO,IAAI;AACb,MAAA;AACF,IAAA;AACA,IAAA,OAAO,IAAI;AACb,EAAA;;AAEA;AACF;AACA;AACE8D,EAAAA,KAAKA,GAAG;IACN,IAAI,IAAI,CAACyL,EAAE,EAAE;AACX,MAAA,IAAI,CAACA,EAAE,CAACzL,KAAK,EAAE;MACf,IAAI,CAACyL,EAAE,GAAG,IAAI;AAChB,IAAA;AACF,EAAA;AACF;;ACtRA;AACA;AACA;AACA;;AAIO,MAAM0S,aAAa,SAAS7D,cAAc,CAAC;AAChD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE1hB,EAAAA,WAAWA,CAACE,MAAM,GAAG,EAAE,EAAE;AACvB,IAAA,KAAK,EAAE;AACP,IAAA,IAAI,CAACslB,OAAO,GAAGtlB,MAAM,CAACslB,OAAO,IAAI,EAAE;AACnC,IAAA,IAAI,CAACC,YAAY,GAAGvlB,MAAM,CAACulB,YAAY,IAAI,mBAAmB;AAC9D,IAAA,IAAI,CAACC,YAAY,GAAGxlB,MAAM,CAACwlB,YAAY,IAAI,kBAAkB;AAC7D,IAAA,IAAI,CAACC,cAAc,GAAGzlB,MAAM,CAACylB,cAAc,IAAI,qBAAqB;AACpE,IAAA,IAAI,CAACC,YAAY,GAAG1lB,MAAM,CAAC0lB,YAAY,IAAI,iBAAiB;IAC5D,IAAI,CAACC,OAAO,GAAG3lB,MAAM,CAAC2lB,OAAO,IAAI,EAAE;AACrC,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,MAAMjT,IAAIA,CAAClO,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAE;AACxC,IAAA,MAAMkE,QAAQ,GAAG,IAAIC,QAAQ,EAAE;AAC/BD,IAAAA,QAAQ,CAACtY,MAAM,CAAC,YAAY,EAAE9I,IAAI,CAAC;AACnCohB,IAAAA,QAAQ,CAACtY,MAAM,CAAC,gBAAgB,EAAEmU,QAAQ,CAAC;AAE3C,IAAA,IAAIC,QAAQ,IAAIoE,MAAM,CAACC,IAAI,CAACrE,QAAQ,CAAC,CAACpc,MAAM,GAAG,CAAC,EAAE;MAChDsgB,QAAQ,CAACtY,MAAM,CAAC,UAAU,EAAE0Y,IAAI,CAACC,SAAS,CAACvE,QAAQ,CAAC,CAAC;AACvD,IAAA;IAEA,IAAI;AACF,MAAA,MAAMwE,QAAQ,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACb,OAAO,GAAG,IAAI,CAACC,YAAY,EAAE;AAC7Da,QAAAA,MAAM,EAAE,MAAM;AACdC,QAAAA,IAAI,EAAET,QAAQ;QACdD,OAAO,EAAE,IAAI,CAACA;AAChB,OAAC,CAAC;AAEF,MAAA,IAAI,CAACO,QAAQ,CAACI,EAAE,EAAE;AAChB,QAAA,MAAM,IAAI3iB,KAAK,CAAC,CAAA,eAAA,EAAkBuiB,QAAQ,CAACK,MAAM,CAAA,CAAA,EAAIL,QAAQ,CAACM,UAAU,CAAA,CAAE,CAAC;AAC7E,MAAA;AAEA,MAAA,MAAM7D,MAAM,GAAG,MAAMuD,QAAQ,CAACO,IAAI,EAAE;;AAEpC;MACA,IAAI9D,MAAM,CAACyB,WAAW,EAAE,CAACC,QAAQ,CAAC,SAAS,CAAC,EAAE;AAC5C,QAAA,OAAO5C,QAAQ;AACjB,MAAA,CAAC,MAAM;AACL,QAAA,MAAM,IAAI9d,KAAK,CAAC,CAAA,cAAA,EAAiBgf,MAAM,EAAE,CAAC;AAC5C,MAAA;IACF,CAAC,CAAC,OAAOvf,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;AACnC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMue,IAAIA,CAACF,QAAQ,EAAE;IACnB,IAAI;MACF,MAAM3c,GAAG,GAAG,IAAI,CAACwgB,OAAO,GAAG,IAAI,CAACE,YAAY,GAAG/D,QAAQ;AACvD,MAAA,MAAMyE,QAAQ,GAAG,MAAMC,KAAK,CAACrhB,GAAG,EAAE;QAChC6gB,OAAO,EAAE,IAAI,CAACA;AAChB,OAAC,CAAC;AAEF,MAAA,IAAI,CAACO,QAAQ,CAACI,EAAE,EAAE;AAChB,QAAA,MAAM,IAAI3iB,KAAK,CAAC,CAAA,aAAA,EAAgBuiB,QAAQ,CAACK,MAAM,CAAA,CAAA,EAAIL,QAAQ,CAACM,UAAU,CAAA,CAAE,CAAC;AAC3E,MAAA;AAEA,MAAA,OAAO,MAAMN,QAAQ,CAAC1hB,IAAI,EAAE;IAC9B,CAAC,CAAC,OAAOpB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;AACnC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMye,MAAMA,CAACJ,QAAQ,EAAE;IACrB,IAAI;AACF,MAAA,MAAMyE,QAAQ,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACb,OAAO,GAAG,IAAI,CAACG,cAAc,EAAE;AAC/DW,QAAAA,MAAM,EAAE,MAAM;AACdT,QAAAA,OAAO,EAAE;AACP,UAAA,cAAc,EAAE,kBAAkB;AAClC,UAAA,GAAG,IAAI,CAACA;SACT;AACDU,QAAAA,IAAI,EAAEL,IAAI,CAACC,SAAS,CAAC;AAAExE,UAAAA;SAAU;AACnC,OAAC,CAAC;AAEF,MAAA,IAAI,CAACyE,QAAQ,CAACI,EAAE,EAAE;AAChB,QAAA,MAAM,IAAI3iB,KAAK,CAAC,CAAA,eAAA,EAAkBuiB,QAAQ,CAACK,MAAM,CAAA,CAAA,EAAIL,QAAQ,CAACM,UAAU,CAAA,CAAE,CAAC;AAC7E,MAAA;AAEA,MAAA,MAAM7D,MAAM,GAAG,MAAMuD,QAAQ,CAACO,IAAI,EAAE;MACpC,OAAO9D,MAAM,CAACyB,WAAW,EAAE,CAACC,QAAQ,CAAC,SAAS,CAAC;IACjD,CAAC,CAAC,OAAOjhB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM0e,IAAIA,GAAG;IACX,IAAI;AACF,MAAA,MAAMoE,QAAQ,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACb,OAAO,GAAG,IAAI,CAACI,YAAY,EAAE;QAC7DC,OAAO,EAAE,IAAI,CAACA;AAChB,OAAC,CAAC;AAEF,MAAA,IAAI,CAACO,QAAQ,CAACI,EAAE,EAAE;AAChB,QAAA,MAAM,IAAI3iB,KAAK,CAAC,CAAA,aAAA,EAAgBuiB,QAAQ,CAACK,MAAM,CAAA,CAAA,EAAIL,QAAQ,CAACM,UAAU,CAAA,CAAE,CAAC;AAC3E,MAAA;AAEA,MAAA,MAAM7e,IAAI,GAAG,MAAMue,QAAQ,CAACQ,IAAI,EAAE;MAClC,OAAOC,KAAK,CAACC,OAAO,CAACjf,IAAI,CAAC,GAAGA,IAAI,GAAG,EAAE;IACxC,CAAC,CAAC,OAAOvE,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;AACnC;AACA,MAAA,OAAO,EAAE;AACX,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACE,EAAA,MAAMyjB,gBAAgBA,CAACriB,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAEoF,UAAU,GAAG,IAAI,EAAE;AACvE,IAAA,OAAO,IAAIpd,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAMgc,QAAQ,GAAG,IAAIC,QAAQ,EAAE;AAC/BD,MAAAA,QAAQ,CAACtY,MAAM,CAAC,YAAY,EAAE9I,IAAI,CAAC;AACnCohB,MAAAA,QAAQ,CAACtY,MAAM,CAAC,gBAAgB,EAAEmU,QAAQ,CAAC;AAE3C,MAAA,IAAIC,QAAQ,IAAIoE,MAAM,CAACC,IAAI,CAACrE,QAAQ,CAAC,CAACpc,MAAM,GAAG,CAAC,EAAE;QAChDsgB,QAAQ,CAACtY,MAAM,CAAC,UAAU,EAAE0Y,IAAI,CAACC,SAAS,CAACvE,QAAQ,CAAC,CAAC;AACvD,MAAA;AAEA,MAAA,MAAMqF,GAAG,GAAG,IAAIC,cAAc,EAAE;;AAEhC;AACA,MAAA,IAAIF,UAAU,EAAE;QACdC,GAAG,CAACE,MAAM,CAAC3Q,gBAAgB,CAAC,UAAU,EAAGhH,CAAC,IAAK;UAC7C,IAAIA,CAAC,CAAC4X,gBAAgB,EAAE;YACtB,MAAMC,OAAO,GAAI7X,CAAC,CAAC8X,MAAM,GAAG9X,CAAC,CAAC/J,KAAK,GAAI,GAAG;YAC1CuhB,UAAU,CAACK,OAAO,CAAC;AACrB,UAAA;AACF,QAAA,CAAC,CAAC;AACJ,MAAA;;AAEA;AACAJ,MAAAA,GAAG,CAACzQ,gBAAgB,CAAC,MAAM,EAAE,MAAM;QACjC,IAAIyQ,GAAG,CAACR,MAAM,IAAI,GAAG,IAAIQ,GAAG,CAACR,MAAM,GAAG,GAAG,EAAE;AACzC,UAAA,MAAM5D,MAAM,GAAGoE,GAAG,CAACM,YAAY;UAC/B,IAAI1E,MAAM,CAACyB,WAAW,EAAE,CAACC,QAAQ,CAAC,SAAS,CAAC,EAAE;YAC5C1a,OAAO,CAAC8X,QAAQ,CAAC;AACnB,UAAA,CAAC,MAAM;YACL7X,MAAM,CAAC,IAAIjG,KAAK,CAAC,iBAAiBgf,MAAM,CAAA,CAAE,CAAC,CAAC;AAC9C,UAAA;AACF,QAAA,CAAC,MAAM;AACL/Y,UAAAA,MAAM,CAAC,IAAIjG,KAAK,CAAC,kBAAkBojB,GAAG,CAACR,MAAM,CAAA,CAAA,EAAIQ,GAAG,CAACP,UAAU,CAAA,CAAE,CAAC,CAAC;AACrE,QAAA;AACF,MAAA,CAAC,CAAC;;AAEF;AACAO,MAAAA,GAAG,CAACzQ,gBAAgB,CAAC,OAAO,EAAE,MAAM;AAClC1M,QAAAA,MAAM,CAAC,IAAIjG,KAAK,CAAC,6BAA6B,CAAC,CAAC;AAClD,MAAA,CAAC,CAAC;;AAEF;AACAojB,MAAAA,GAAG,CAACzQ,gBAAgB,CAAC,OAAO,EAAE,MAAM;AAClC1M,QAAAA,MAAM,CAAC,IAAIjG,KAAK,CAAC,kBAAkB,CAAC,CAAC;AACvC,MAAA,CAAC,CAAC;;AAEF;AACAojB,MAAAA,GAAG,CAACvE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC8C,OAAO,GAAG,IAAI,CAACC,YAAY,CAAC;;AAElD;MACAO,MAAM,CAACC,IAAI,CAAC,IAAI,CAACJ,OAAO,CAAC,CAAC/d,OAAO,CAAC0f,GAAG,IAAI;QACvCP,GAAG,CAACQ,gBAAgB,CAACD,GAAG,EAAE,IAAI,CAAC3B,OAAO,CAAC2B,GAAG,CAAC,CAAC;AAC9C,MAAA,CAAC,CAAC;AAEFP,MAAAA,GAAG,CAACS,IAAI,CAAC5B,QAAQ,CAAC;AACpB,IAAA,CAAC,CAAC;AACJ,EAAA;AACF;;AC/MA;AACA;AACA;AACA;;AAIO,MAAM6B,eAAe,SAASjG,cAAc,CAAC;AAClD;AACF;AACA;AACA;AACE1hB,EAAAA,WAAWA,CAAC4nB,QAAQ,GAAG,YAAY,EAAE;AACnC,IAAA,KAAK,EAAE;IACP,IAAI,CAACA,QAAQ,GAAGA,QAAQ;;AAExB;IACA,IAAI,OAAOtlB,MAAM,KAAK,WAAW,IAAI,CAACA,MAAM,CAACulB,WAAW,EAAE;AACxD,MAAA,MAAM,IAAIhkB,KAAK,CAAC,8EAA8E,CAAC;AACjG,IAAA;AAEA,IAAA,IAAI,CAACgkB,WAAW,GAAGvlB,MAAM,CAACulB,WAAW;AACvC,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,MAAMjV,IAAIA,CAAClO,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAE;IACxC,IAAI;AACF;AACA,MAAA,MAAMkG,WAAW,GAAG,MAAMpjB,IAAI,CAACojB,WAAW,EAAE;;AAE5C;MACA,MAAM3c,MAAM,GAAG0b,KAAK,CAACkB,IAAI,CAAC,IAAItY,UAAU,CAACqY,WAAW,CAAC,CAAC;;AAEtD;MACA,MAAMjF,MAAM,GAAG,MAAM,IAAI,CAACgF,WAAW,CAACG,aAAa,CAAC;QAClDrG,QAAQ;QACRxW,MAAM;AACNyW,QAAAA,QAAQ,EAAE;AACR,UAAA,GAAGA,QAAQ;UACX+B,IAAI,EAAEjf,IAAI,CAACif,IAAI;UACfva,IAAI,EAAE1E,IAAI,CAAC0E,IAAI;AACf7E,UAAAA,SAAS,EAAEN,IAAI,CAACC,GAAG;AACrB;AACF,OAAC,CAAC;MAEF,IAAI2e,MAAM,CAACoF,OAAO,EAAE;AAClB,QAAA,OAAOpF,MAAM,CAACf,EAAE,IAAIe,MAAM,CAACxf,IAAI;AACjC,MAAA,CAAC,MAAM;QACL,MAAM,IAAIQ,KAAK,CAACgf,MAAM,CAACvf,KAAK,IAAI,aAAa,CAAC;AAChD,MAAA;IACF,CAAC,CAAC,OAAOA,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;AAC5C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMue,IAAIA,CAACqG,QAAQ,EAAE;IACnB,IAAI;AACF;MACA,MAAM/c,MAAM,GAAG,MAAM,IAAI,CAAC0c,WAAW,CAACM,aAAa,CAACD,QAAQ,CAAC;;AAE7D;AACA,MAAA,MAAME,UAAU,GAAG,IAAI3Y,UAAU,CAACtE,MAAM,CAAC;AACzC,MAAA,OAAO,IAAIxB,IAAI,CAAC,CAACye,UAAU,CAAC,EAAE;AAAEhf,QAAAA,IAAI,EAAE;AAAY,OAAC,CAAC;IACtD,CAAC,CAAC,OAAO9F,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;AAC5C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMye,MAAMA,CAACmG,QAAQ,EAAE;IACrB,IAAI;MACF,MAAMrF,MAAM,GAAG,MAAM,IAAI,CAACgF,WAAW,CAACQ,eAAe,CAACH,QAAQ,CAAC;MAC/D,OAAOrF,MAAM,CAACoF,OAAO;IACvB,CAAC,CAAC,OAAO3kB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;AAC9C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACE,EAAA,MAAM0e,IAAIA,CAACsG,SAAS,GAAG,IAAI,EAAE;IAC3B,IAAI;MACF,MAAMC,UAAU,GAAG,MAAM,IAAI,CAACV,WAAW,CAACW,cAAc,CAACF,SAAS,CAAC;MACnE,OAAOC,UAAU,IAAI,EAAE;IACzB,CAAC,CAAC,OAAOjlB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;AAC5C,MAAA,OAAO,EAAE;AACX,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMmlB,QAAQA,GAAG;IACf,IAAI;AACF,MAAA,IAAI,IAAI,CAACZ,WAAW,CAACY,QAAQ,EAAE;AAC7B,QAAA,OAAO,MAAM,IAAI,CAACZ,WAAW,CAACY,QAAQ,EAAE;AAC1C,MAAA;AACA,MAAA,MAAM,IAAI5kB,KAAK,CAAC,4BAA4B,CAAC;IAC/C,CAAC,CAAC,OAAOP,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;AAChD,MAAA,OAAO,IAAI;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACE,EAAA,MAAMolB,MAAMA,CAAChkB,IAAI,EAAEikB,eAAe,GAAG,eAAe,EAAE;IACpD,IAAI;AACF,MAAA,MAAMb,WAAW,GAAG,MAAMpjB,IAAI,CAACojB,WAAW,EAAE;MAC5C,MAAM3c,MAAM,GAAG0b,KAAK,CAACkB,IAAI,CAAC,IAAItY,UAAU,CAACqY,WAAW,CAAC,CAAC;AAEtD,MAAA,IAAI,IAAI,CAACD,WAAW,CAACa,MAAM,EAAE;QAC3B,MAAM7F,MAAM,GAAG,MAAM,IAAI,CAACgF,WAAW,CAACa,MAAM,CAAC;AAC3C/G,UAAAA,QAAQ,EAAEgH,eAAe;AACzBxd,UAAAA;AACF,SAAC,CAAC;QAEF,OAAO0X,MAAM,CAACoF,OAAO,GAAGpF,MAAM,CAACxf,IAAI,GAAG,IAAI;AAC5C,MAAA;;AAEA;MACA,OAAO,MAAM,IAAI,CAACuP,IAAI,CAAClO,IAAI,EAAEikB,eAAe,CAAC;IAC/C,CAAC,CAAC,OAAOrlB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;AAC9C,MAAA,OAAO,IAAI;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMslB,YAAYA,CAACV,QAAQ,EAAE;IAC3B,IAAI;AACF,MAAA,IAAI,IAAI,CAACL,WAAW,CAACe,YAAY,EAAE;AACjC,QAAA,MAAM,IAAI,CAACf,WAAW,CAACe,YAAY,CAACV,QAAQ,CAAC;AAC7C,QAAA,OAAO,IAAI;AACb,MAAA;AACA,MAAA,OAAO,KAAK;IACd,CAAC,CAAC,OAAO5kB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;AACpD,MAAA,OAAO,KAAK;AACd,IAAA;AACF,EAAA;AACF;;AC5KA;AACA;AACA;AACA;;AAIO,MAAMulB,gBAAgB,SAASnH,cAAc,CAAC;AACnD;AACF;AACA;AACA;AACE1hB,EAAAA,WAAWA,CAACsoB,SAAS,GAAG,YAAY,EAAE;AACpC,IAAA,KAAK,EAAE;IACP,IAAI,CAACA,SAAS,GAAGA,SAAS;;AAE1B;IACA,IAAI,OAAOhmB,MAAM,KAAK,WAAW,IAAI,CAACA,MAAM,CAACwmB,SAAS,EAAE;AACtD,MAAA,MAAM,IAAIjlB,KAAK,CAAC,uEAAuE,CAAC;AAC1F,IAAA;AAEA,IAAA,IAAI,CAACilB,SAAS,GAAGxmB,MAAM,CAACwmB,SAAS;IACjC,IAAI,CAACC,WAAW,GAAG,KAAK;AAC1B,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM3mB,UAAUA,GAAG;IACjB,IAAI,IAAI,CAAC2mB,WAAW,EAAE;IAEtB,IAAI;MACF,MAAM;QAAEC,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;;AAExD;MACA,IAAI;QACF,MAAMF,UAAU,CAACG,OAAO,CAAC;UACvB9lB,IAAI,EAAE,IAAI,CAACilB,SAAS;UACpBA,SAAS,EAAEW,SAAS,CAACG;AACvB,SAAC,CAAC;MACJ,CAAC,CAAC,OAAO5Z,CAAC,EAAE;AACV;QACA,MAAMwZ,UAAU,CAACK,KAAK,CAAC;UACrBhmB,IAAI,EAAE,IAAI,CAACilB,SAAS;UACpBA,SAAS,EAAEW,SAAS,CAACG,SAAS;AAC9BE,UAAAA,SAAS,EAAE;AACb,SAAC,CAAC;AACJ,MAAA;MAEA,IAAI,CAACP,WAAW,GAAG,IAAI;IACzB,CAAC,CAAC,OAAOzlB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;AACvD,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACE,MAAMsP,IAAIA,CAAClO,IAAI,EAAEid,QAAQ,EAAEC,QAAQ,GAAG,EAAE,EAAE;AACxC,IAAA,MAAM,IAAI,CAACxf,UAAU,EAAE;IAEvB,IAAI;MACF,MAAM;QAAE4mB,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;;AAExD;MACA,MAAMK,UAAU,GAAG,MAAM,IAAI,CAACC,YAAY,CAAC9kB,IAAI,CAAC;;AAEhD;MACA,MAAMskB,UAAU,CAACS,SAAS,CAAC;AACzBpmB,QAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,CAAE;AACrC9Z,QAAAA,IAAI,EAAE0hB,UAAU;QAChBjB,SAAS,EAAEW,SAAS,CAACG;AACvB,OAAC,CAAC;;AAEF;AACA,MAAA,IAAIxH,QAAQ,IAAIoE,MAAM,CAACC,IAAI,CAACrE,QAAQ,CAAC,CAACpc,MAAM,GAAG,CAAC,EAAE;AAChD,QAAA,MAAMkkB,oBAAoB,GAAG;AAC3B,UAAA,GAAG9H,QAAQ;UACX+B,IAAI,EAAEjf,IAAI,CAACif,IAAI;UACfva,IAAI,EAAE1E,IAAI,CAAC0E,IAAI;AACf7E,UAAAA,SAAS,EAAEN,IAAI,CAACC,GAAG;SACpB;QAED,MAAM8kB,UAAU,CAACS,SAAS,CAAC;AACzBpmB,UAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,UAAA,CAAY;AAC/C9Z,UAAAA,IAAI,EAAEqe,IAAI,CAACC,SAAS,CAACuD,oBAAoB,CAAC;UAC1CpB,SAAS,EAAEW,SAAS,CAACG,SAAS;AAC9BO,UAAAA,QAAQ,EAAE;AACZ,SAAC,CAAC;AACJ,MAAA;AAEA,MAAA,OAAOhI,QAAQ;IACjB,CAAC,CAAC,OAAOre,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;AAC7C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMue,IAAIA,CAACF,QAAQ,EAAE;AACnB,IAAA,MAAM,IAAI,CAACvf,UAAU,EAAE;IAEvB,IAAI;MACF,MAAM;QAAE4mB,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;AAExD,MAAA,MAAMrG,MAAM,GAAG,MAAMmG,UAAU,CAACY,QAAQ,CAAC;AACvCvmB,QAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,CAAE;QACrC2G,SAAS,EAAEW,SAAS,CAACG;AACvB,OAAC,CAAC;;AAEF;MACA,OAAO,IAAI,CAACS,YAAY,CAAChH,MAAM,CAAChb,IAAI,EAAE,WAAW,CAAC;IACpD,CAAC,CAAC,OAAOvE,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;AAC7C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMye,MAAMA,CAACJ,QAAQ,EAAE;AACrB,IAAA,MAAM,IAAI,CAACvf,UAAU,EAAE;IAEvB,IAAI;MACF,MAAM;QAAE4mB,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;;AAExD;MACA,MAAMF,UAAU,CAACc,UAAU,CAAC;AAC1BzmB,QAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,CAAE;QACrC2G,SAAS,EAAEW,SAAS,CAACG;AACvB,OAAC,CAAC;;AAEF;MACA,IAAI;QACF,MAAMJ,UAAU,CAACc,UAAU,CAAC;AAC1BzmB,UAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,UAAA,CAAY;UAC/C2G,SAAS,EAAEW,SAAS,CAACG;AACvB,SAAC,CAAC;MACJ,CAAC,CAAC,OAAO5Z,CAAC,EAAE;AACV;AAAA,MAAA;AAGF,MAAA,OAAO,IAAI;IACb,CAAC,CAAC,OAAOlM,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;AAC/C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM0e,IAAIA,GAAG;AACX,IAAA,MAAM,IAAI,CAAC5f,UAAU,EAAE;IAEvB,IAAI;MACF,MAAM;QAAE4mB,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;AAExD,MAAA,MAAMrG,MAAM,GAAG,MAAMmG,UAAU,CAACG,OAAO,CAAC;QACtC9lB,IAAI,EAAE,IAAI,CAACilB,SAAS;QACpBA,SAAS,EAAEW,SAAS,CAACG;AACvB,OAAC,CAAC;;AAEF;AACA,MAAA,MAAMW,UAAU,GAAGlH,MAAM,CAACX,KAAK,CAACmC,MAAM,CAAC2F,CAAC,IAAI,CAACA,CAAC,CAACC,QAAQ,CAAC,YAAY,CAAC,CAAC;;AAEtE;AACA,MAAA,MAAM1B,UAAU,GAAG,MAAM3e,OAAO,CAACsgB,GAAG,CAClCH,UAAU,CAAC9F,GAAG,CAAC,MAAOtC,QAAQ,IAAK;QACjC,IAAIC,QAAQ,GAAG,EAAE;QAEjB,IAAI;AACF,UAAA,MAAMuI,UAAU,GAAG,MAAMnB,UAAU,CAACY,QAAQ,CAAC;AAC3CvmB,YAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,UAAA,CAAY;YAC/C2G,SAAS,EAAEW,SAAS,CAACG,SAAS;AAC9BO,YAAAA,QAAQ,EAAE;AACZ,WAAC,CAAC;UACF/H,QAAQ,GAAGsE,IAAI,CAACkE,KAAK,CAACD,UAAU,CAACtiB,IAAI,CAAC;QACxC,CAAC,CAAC,OAAO2H,CAAC,EAAE;AACV;AAAA,QAAA;QAGF,OAAO;AACLsS,UAAAA,EAAE,EAAEH,QAAQ;AACZA,UAAAA,QAAQ,EAAEA,QAAQ;AAClBC,UAAAA,QAAQ,EAAEA,QAAQ;AAClBrd,UAAAA,SAAS,EAAEqd,QAAQ,CAACrd,SAAS,IAAI,CAAC;AAClC2f,UAAAA,IAAI,EAAEtC,QAAQ,CAACrd,SAAS,GAAG,IAAIN,IAAI,CAAC2d,QAAQ,CAACrd,SAAS,CAAC,GAAG,IAAI;AAC9Dof,UAAAA,IAAI,EAAE/B,QAAQ,CAAC+B,IAAI,IAAI,CAAC;AACxBva,UAAAA,IAAI,EAAEwY,QAAQ,CAACxY,IAAI,IAAI;SACxB;AACH,MAAA,CAAC,CACH,CAAC;;AAED;AACAmf,MAAAA,UAAU,CAAC8B,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAChmB,SAAS,GAAG+lB,CAAC,CAAC/lB,SAAS,CAAC;AAEpD,MAAA,OAAOgkB,UAAU;IACnB,CAAC,CAAC,OAAOjlB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;AAC7C,MAAA,OAAO,EAAE;AACX,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAMknB,MAAMA,CAAC7I,QAAQ,EAAE;AACrB,IAAA,MAAM,IAAI,CAACvf,UAAU,EAAE;IAEvB,IAAI;MACF,MAAM;QAAE4mB,UAAU;AAAEC,QAAAA;AAAU,OAAC,GAAG,IAAI,CAACH,SAAS,CAACI,OAAO;AAExD,MAAA,MAAMrG,MAAM,GAAG,MAAMmG,UAAU,CAACwB,MAAM,CAAC;AACrCnnB,QAAAA,IAAI,EAAE,CAAA,EAAG,IAAI,CAACilB,SAAS,CAAA,CAAA,EAAI3G,QAAQ,CAAA,CAAE;QACrC2G,SAAS,EAAEW,SAAS,CAACG;AACvB,OAAC,CAAC;MAEF,OAAOvG,MAAM,CAAC4H,GAAG;IACnB,CAAC,CAAC,OAAOnnB,KAAK,EAAE;AACdC,MAAAA,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;AAC/C,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACEkmB,YAAYA,CAAC9kB,IAAI,EAAE;AACjB,IAAA,OAAO,IAAIkF,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AACtC,MAAA,MAAM4gB,MAAM,GAAG,IAAIC,UAAU,EAAE;MAC/BD,MAAM,CAACE,SAAS,GAAG,MAAM;AACvB;AACA,QAAA,MAAMC,MAAM,GAAGH,MAAM,CAAC7H,MAAM,CAACiI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC1CjhB,OAAO,CAACghB,MAAM,CAAC;MACjB,CAAC;MACDH,MAAM,CAAC/H,OAAO,GAAG7Y,MAAM;AACvB4gB,MAAAA,MAAM,CAACK,aAAa,CAACrmB,IAAI,CAAC;AAC5B,IAAA,CAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACEmlB,EAAAA,YAAYA,CAACgB,MAAM,EAAE3gB,QAAQ,GAAG,WAAW,EAAE;AAC3C,IAAA,MAAM8gB,cAAc,GAAGC,IAAI,CAACJ,MAAM,CAAC;IACnC,MAAMK,WAAW,GAAG,IAAIrE,KAAK,CAACmE,cAAc,CAACxlB,MAAM,CAAC;AAEpD,IAAA,KAAK,IAAIS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+kB,cAAc,CAACxlB,MAAM,EAAES,CAAC,EAAE,EAAE;MAC9CilB,WAAW,CAACjlB,CAAC,CAAC,GAAG+kB,cAAc,CAACjf,UAAU,CAAC9F,CAAC,CAAC;AAC/C,IAAA;AAEA,IAAA,MAAMklB,SAAS,GAAG,IAAI1b,UAAU,CAACyb,WAAW,CAAC;AAC7C,IAAA,OAAO,IAAIvhB,IAAI,CAAC,CAACwhB,SAAS,CAAC,EAAE;AAAE/hB,MAAAA,IAAI,EAAEc;AAAS,KAAC,CAAC;AAClD,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMsa,cAAcA,GAAG;AACrB,IAAA,MAAM+D,UAAU,GAAG,MAAM,IAAI,CAACvG,IAAI,EAAE;IACpC,MAAMyC,SAAS,GAAG8D,UAAU,CAAC7D,MAAM,CAAC,CAACC,GAAG,EAAEyG,CAAC,KAAKzG,GAAG,IAAIyG,CAAC,CAACzH,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IAEvE,OAAO;MACLpe,KAAK,EAAEgjB,UAAU,CAAC/iB,MAAM;AACxBif,MAAAA,SAAS,EAAEA,SAAS;AACpBG,MAAAA,WAAW,EAAE,CAACH,SAAS,IAAI,IAAI,GAAG,IAAI,CAAC,EAAE7Q,OAAO,CAAC,CAAC,CAAC;AACnD2U,MAAAA,UAAU,EAAEA;KACb;AACH,EAAA;AACF;;ACpSA;AACA;AACA;AACA;;;AAQA;AACA;AACA;AACA;AACO,MAAM8C,cAAc,CAAC;AAC1B;AACF;AACA;AACA;AACA;AACA;AACA;AACE,EAAA,OAAOC,MAAMA,CAACprB,MAAM,GAAG,EAAE,EAAE;AACzB,IAAA,MAAMkJ,IAAI,GAAGlJ,MAAM,CAACkJ,IAAI,IAAI,MAAM;AAClC,IAAA,MAAMnJ,OAAO,GAAGC,MAAM,CAACD,OAAO,IAAI,EAAE;;AAEpC;IACA,IAAImJ,IAAI,KAAK,MAAM,EAAE;AACnB,MAAA,OAAO,IAAI,CAACmiB,UAAU,CAACtrB,OAAO,CAAC;AACjC,IAAA;;AAEA;AACA,IAAA,QAAQmJ,IAAI,CAACkb,WAAW,EAAE;AACxB,MAAA,KAAK,SAAS;AACd,MAAA,KAAK,WAAW;QACd,MAAM;AAAElC,UAAAA;AAAiB,SAAC,GAAGoJ,OAAO,CAAC,uBAAuB,CAAC;AAC7D,QAAA,OAAO,IAAIpJ,gBAAgB,CACzBniB,OAAO,CAACoiB,MAAM,EACdpiB,OAAO,CAACqiB,SAAS,EACjBriB,OAAO,CAACsiB,OACV,CAAC;AAEH,MAAA,KAAK,UAAU;QACb,MAAM;AAAEoF,UAAAA;AAAgB,SAAC,GAAG6D,OAAO,CAAC,sBAAsB,CAAC;AAC3D,QAAA,OAAO,IAAI7D,eAAe,CAAC1nB,OAAO,CAAC2nB,QAAQ,CAAC;AAE9C,MAAA,KAAK,WAAW;QACd,MAAM;AAAEiB,UAAAA;AAAiB,SAAC,GAAG2C,OAAO,CAAC,uBAAuB,CAAC;AAC7D,QAAA,OAAO,IAAI3C,gBAAgB,CAAC5oB,OAAO,CAACqoB,SAAS,CAAC;AAEhD,MAAA,KAAK,QAAQ;AACb,MAAA,KAAK,KAAK;AACV,MAAA,KAAK,QAAQ;QACX,MAAM;AAAE/C,UAAAA;AAAc,SAAC,GAAGiG,OAAO,CAAC,oBAAoB,CAAC;AACvD,QAAA,OAAO,IAAIjG,aAAa,CAACtlB,OAAO,CAAC;AAEnC,MAAA;AACE,QAAA,MAAM,IAAI4D,KAAK,CAAC,CAAA,sBAAA,EAAyBuF,IAAI,EAAE,CAAC;AACpD;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACE,EAAA,OAAOmiB,UAAUA,CAACtrB,OAAO,GAAG,EAAE,EAAE;AAC9B;IACA,IAAI,OAAOqC,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACulB,WAAW,EAAE;MACvD,MAAM;AAAEF,QAAAA;AAAgB,OAAC,GAAG6D,OAAO,CAAC,sBAAsB,CAAC;AAC3D,MAAA,OAAO,IAAI7D,eAAe,CAAC1nB,OAAO,CAAC2nB,QAAQ,CAAC;AAC9C,IAAA;;AAEA;IACA,IAAI,OAAOtlB,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACwmB,SAAS,EAAE;MACrD,MAAM;AAAED,QAAAA;AAAiB,OAAC,GAAG2C,OAAO,CAAC,uBAAuB,CAAC;AAC7D,MAAA,OAAO,IAAI3C,gBAAgB,CAAC5oB,OAAO,CAACqoB,SAAS,CAAC;AAChD,IAAA;;AAEA;IACA,MAAM;AAAElG,MAAAA;AAAiB,KAAC,GAAGoJ,OAAO,CAAC,uBAAuB,CAAC;AAC7D,IAAA,OAAO,IAAIpJ,gBAAgB,CACzBniB,OAAO,CAACoiB,MAAM,EACdpiB,OAAO,CAACqiB,SAAS,EACjBriB,OAAO,CAACsiB,OACV,CAAC;AACH,EAAA;AACF;;ACxFA;AACA;AACA;AACA;;AAEO,MAAMkJ,gBAAgB,CAAC;AAC5B;AACF;AACA;AACA;EACE,OAAOC,MAAMA,GAAG;AACd;IACA,IAAI,OAAOppB,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACulB,WAAW,EAAE;AACvD,MAAA,OAAO,UAAU;AACnB,IAAA;;AAEA;AACA,IAAA,IAAI,OAAO8D,OAAO,KAAK,WAAW,IAAIA,OAAO,CAACC,QAAQ,IAAID,OAAO,CAACC,QAAQ,CAACC,QAAQ,EAAE;AACnF,MAAA,OAAO,UAAU;AACnB,IAAA;;AAEA;IACA,IAAI,OAAOvpB,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACwmB,SAAS,EAAE;AACrD,MAAA,OAAO,WAAW;AACpB,IAAA;;AAEA;AACA,IAAA,OAAO,SAAS;AAClB,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOgD,UAAUA,GAAG;AAClB,IAAA,OAAO,IAAI,CAACJ,MAAM,EAAE,KAAK,UAAU;AACrC,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOK,WAAWA,GAAG;AACnB,IAAA,OAAO,IAAI,CAACL,MAAM,EAAE,KAAK,WAAW;AACtC,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOM,SAASA,GAAG;AACjB,IAAA,OAAO,IAAI,CAACN,MAAM,EAAE,KAAK,SAAS;AACpC,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOO,QAAQA,GAAG;IAChB,IAAI,OAAO3pB,MAAM,KAAK,WAAW,IAAI,CAACA,MAAM,CAAC6F,SAAS,EAAE;AACtD,MAAA,OAAO,KAAK;AACd,IAAA;IAEA,OAAO,gEAAgE,CAACa,IAAI,CAC1E1G,MAAM,CAAC6F,SAAS,CAACW,SACnB,CAAC;AACH,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOojB,oBAAoBA,GAAG;IAC5B,IAAI,OAAO5pB,MAAM,KAAK,WAAW,IAAI,CAACA,MAAM,CAACC,YAAY,EAAE;AACzD,MAAA,OAAO,KAAK;AACd,IAAA;IAEA,MAAMF,iBAAiB,GAAGC,MAAM,CAACC,YAAY,IAAID,MAAM,CAACE,kBAAkB;AAC1E,IAAA,OAAO,cAAc,IAAIH,iBAAiB,CAAC8pB,SAAS;AACtD,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOC,uBAAuBA,GAAG;IAC/B,OAAO,OAAOC,eAAe,KAAK,WAAW;AAC/C,EAAA;;AAEA;AACF;AACA;AACA;EACE,OAAOC,OAAOA,GAAG;IACf,OAAO;AACLC,MAAAA,QAAQ,EAAE,IAAI,CAACb,MAAM,EAAE;AACvBI,MAAAA,UAAU,EAAE,IAAI,CAACA,UAAU,EAAE;AAC7BC,MAAAA,WAAW,EAAE,IAAI,CAACA,WAAW,EAAE;AAC/BC,MAAAA,SAAS,EAAE,IAAI,CAACA,SAAS,EAAE;AAC3BC,MAAAA,QAAQ,EAAE,IAAI,CAACA,QAAQ,EAAE;AACzBC,MAAAA,oBAAoB,EAAE,IAAI,CAACA,oBAAoB,EAAE;AACjDE,MAAAA,uBAAuB,EAAE,IAAI,CAACA,uBAAuB,EAAE;MACvDtjB,SAAS,EAAE,OAAOX,SAAS,KAAK,WAAW,GAAGA,SAAS,CAACW,SAAS,GAAG;KACrE;AACH,EAAA;AACF;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAsBA;AACA;AACA;AACA;AACO,MAAM0jB,iBAAiB,CAAC;AAC7B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACExsB,EAAAA,WAAWA,CAACC,OAAO,GAAG,EAAE,EAAE;IACxB,IAAI,CAACA,OAAO,GAAG,IAAI,CAACwsB,YAAY,CAACxsB,OAAO,CAAC;IACzC,IAAI,CAAC8oB,WAAW,GAAG,KAAK;;AAExB;AACA,IAAA,IAAI,CAAC/D,OAAO,GAAG,IAAI,CAAC0H,oBAAoB,CAAC,IAAI,CAACzsB,OAAO,CAAC+kB,OAAO,CAAC;;AAE9D;IACA,IAAI,CAACtjB,WAAW,GAAG,KAAK;IACxB,IAAI,CAACC,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACgrB,WAAW,GAAG,IAAI;;AAEvB;AACA,IAAA,IAAI,IAAI,CAAC1sB,OAAO,CAAC4c,SAAS,EAAE;MAC1B,IAAI,CAAC+P,YAAY,EAAE;AACrB,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACEH,YAAYA,CAACxsB,OAAO,EAAE;AACpB,IAAA,MAAM4sB,QAAQ,GAAG;AACfhQ,MAAAA,SAAS,EAAE,IAAI;AACfI,MAAAA,MAAM,EAAE,MAAM;AACdC,MAAAA,KAAK,EAAE,OAAO;AAEdlV,MAAAA,KAAK,EAAE;AACL7H,QAAAA,UAAU,EAAE,KAAK;AACjB2sB,QAAAA,QAAQ,EAAE,CAAC;AACXC,QAAAA,GAAG,EAAE,KAAK;AACVnqB,QAAAA,IAAI,EAAE;OACP;AAEDoqB,MAAAA,QAAQ,EAAE;AACR7P,QAAAA,YAAY,EAAE,IAAI;AAClB8P,QAAAA,eAAe,EAAE,IAAI;AACrBC,QAAAA,QAAQ,EAAE,IAAI;AACdC,QAAAA,UAAU,EAAE,EAAE;AACdC,QAAAA,MAAM,EAAE;AACNJ,UAAAA,QAAQ,EAAE,SAAS;AACnBK,UAAAA,SAAS,EAAE,SAAS;AACpBC,UAAAA,QAAQ,EAAE;AACZ;OACD;AAEDtI,MAAAA,OAAO,EAAE;AACP5b,QAAAA,IAAI,EAAE;OACP;AAEDgU,MAAAA,SAAS,EAAE;AACTC,QAAAA,aAAa,EAAEA,MAAM,CAAC,CAAC;AACvBC,QAAAA,YAAY,EAAEA,MAAM,CAAC,CAAC;AACtBiQ,QAAAA,aAAa,EAAEA,MAAM,CAAC,CAAC;AACvBC,QAAAA,cAAc,EAAEA,MAAM,CAAC,CAAC;AACxBjQ,QAAAA,WAAW,EAAEA,MAAM,CAAC,CAAC;AACrBC,QAAAA,UAAU,EAAEA,MAAM,CAAC,CAAC;QACpBC,OAAO,EAAGna,KAAK,IAAKC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK;AACrE;KACD;;AAED;AACA,IAAA,OAAO,IAAI,CAACmqB,SAAS,CAACZ,QAAQ,EAAE5sB,OAAO,CAAC;AAC1C,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACEwtB,EAAAA,SAASA,CAAC1K,MAAM,EAAExa,MAAM,EAAE;AACxB,IAAA,MAAMsa,MAAM,GAAG;MAAE,GAAGE;KAAQ;AAE5B,IAAA,KAAK,MAAMyE,GAAG,IAAIjf,MAAM,EAAE;AACxB,MAAA,IAAIA,MAAM,CAACif,GAAG,CAAC,YAAYxB,MAAM,IAAI,CAACa,KAAK,CAACC,OAAO,CAACve,MAAM,CAACif,GAAG,CAAC,CAAC,EAAE;QAChE3E,MAAM,CAAC2E,GAAG,CAAC,GAAG,IAAI,CAACiG,SAAS,CAAC5K,MAAM,CAAC2E,GAAG,CAAC,IAAI,EAAE,EAAEjf,MAAM,CAACif,GAAG,CAAC,CAAC;AAC9D,MAAA,CAAC,MAAM;AACL3E,QAAAA,MAAM,CAAC2E,GAAG,CAAC,GAAGjf,MAAM,CAACif,GAAG,CAAC;AAC3B,MAAA;AACF,IAAA;AAEA,IAAA,OAAO3E,MAAM;AACf,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE6J,oBAAoBA,CAACgB,aAAa,EAAE;IAClC,MAAM;AAAErC,MAAAA;AAAe,KAAC,GAAGG,OAAO,CAAC,oBAAoB,CAAC;IACxD,OAAOH,cAAc,CAACC,MAAM,CAAC;AAC3BliB,MAAAA,IAAI,EAAEskB,aAAa,CAACtkB,IAAI,IAAI,MAAM;AAClCnJ,MAAAA,OAAO,EAAEytB;AACX,KAAC,CAAC;AACJ,EAAA;;AAEA;AACF;AACA;AACEd,EAAAA,YAAYA,GAAG;AACb;AACA;AACArpB,IAAAA,OAAO,CAAC4L,GAAG,CAAC,uCAAuC,CAAC;AACtD,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMvL,cAAcA,GAAG;IACrB,IAAI;MACF,IAAI,IAAI,CAAClC,WAAW,EAAE;AACpB,QAAA,MAAM,IAAImC,KAAK,CAAC,mBAAmB,CAAC;AACtC,MAAA;;AAEA;MACA,IAAI,CAACnC,WAAW,GAAG,IAAI;AACvB,MAAA,IAAI,CAACzB,OAAO,CAACmd,SAAS,CAACC,aAAa,EAAE;AAEtC9Z,MAAAA,OAAO,CAAC4L,GAAG,CAAC,mBAAmB,CAAC;IAClC,CAAC,CAAC,OAAO7L,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMmB,aAAaA,GAAG;IACpB,IAAI;AACF,MAAA,IAAI,CAAC,IAAI,CAAC/C,WAAW,EAAE;AACrB,QAAA,MAAM,IAAImC,KAAK,CAAC,eAAe,CAAC;AAClC,MAAA;;AAEA;MACA,IAAI,CAACnC,WAAW,GAAG,KAAK;;AAExB;AACA,MAAA,IAAI,CAACirB,WAAW,GAAG,IAAI,CAAC;;MAExB,IAAI,CAAC1sB,OAAO,CAACmd,SAAS,CAACE,YAAY,CAAC,IAAI,CAACqP,WAAW,CAAC;AAErDppB,MAAAA,OAAO,CAAC4L,GAAG,CAAC,mBAAmB,CAAC;MAChC,OAAO,IAAI,CAACwd,WAAW;IACzB,CAAC,CAAC,OAAOrpB,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM4B,cAAcA,GAAG;IACrB,IAAI;MACF,IAAI,CAAC,IAAI,CAACxD,WAAW,IAAI,IAAI,CAACC,QAAQ,EAAE;AACtC,QAAA,MAAM,IAAIkC,KAAK,CAAC,cAAc,CAAC;AACjC,MAAA;MAEA,IAAI,CAAClC,QAAQ,GAAG,IAAI;AACpB,MAAA,IAAI,CAAC1B,OAAO,CAACmd,SAAS,CAACmQ,aAAa,EAAE;AAEtChqB,MAAAA,OAAO,CAAC4L,GAAG,CAAC,kBAAkB,CAAC;IACjC,CAAC,CAAC,OAAO7L,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAM6B,eAAeA,GAAG;IACtB,IAAI;MACF,IAAI,CAAC,IAAI,CAACzD,WAAW,IAAI,CAAC,IAAI,CAACC,QAAQ,EAAE;AACvC,QAAA,MAAM,IAAIkC,KAAK,CAAC,eAAe,CAAC;AAClC,MAAA;MAEA,IAAI,CAAClC,QAAQ,GAAG,KAAK;AACrB,MAAA,IAAI,CAAC1B,OAAO,CAACmd,SAAS,CAACoQ,cAAc,EAAE;AAEvCjqB,MAAAA,OAAO,CAAC4L,GAAG,CAAC,mBAAmB,CAAC;IAClC,CAAC,CAAC,OAAO7L,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMqqB,IAAIA,GAAG;IACX,IAAI;AACF;AACA,MAAA,IAAI,CAAC1tB,OAAO,CAACmd,SAAS,CAACG,WAAW,EAAE;AAEpCha,MAAAA,OAAO,CAAC4L,GAAG,CAAC,kBAAkB,CAAC;IACjC,CAAC,CAAC,OAAO7L,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMsF,IAAIA,GAAG;IACX,IAAI;AACF;AACA,MAAA,IAAI,CAAC3I,OAAO,CAACmd,SAAS,CAACI,UAAU,EAAE;AAEnCja,MAAAA,OAAO,CAAC4L,GAAG,CAAC,kBAAkB,CAAC;IACjC,CAAC,CAAC,OAAO7L,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACE,EAAA,MAAM0kB,aAAaA,CAACtjB,IAAI,GAAG,IAAI,EAAEid,QAAQ,GAAG,IAAI,EAAEC,QAAQ,GAAG,EAAE,EAAE;IAC/D,IAAI;AACF,MAAA,MAAMgM,UAAU,GAAGlpB,IAAI,IAAI,IAAI,CAACioB,WAAW;MAE3C,IAAI,CAACiB,UAAU,EAAE;AACf,QAAA,MAAM,IAAI/pB,KAAK,CAAC,sBAAsB,CAAC;AACzC,MAAA;MAEA,MAAMgqB,aAAa,GAAGlM,QAAQ,IAAI,CAAA,UAAA,EAAa1d,IAAI,CAACC,GAAG,EAAE,CAAA,IAAA,CAAM;AAE/D,MAAA,MAAM4d,EAAE,GAAG,MAAM,IAAI,CAACkD,OAAO,CAACpS,IAAI,CAACgb,UAAU,EAAEC,aAAa,EAAEjM,QAAQ,CAAC;AAEvEre,MAAAA,OAAO,CAAC4L,GAAG,CAAC,kBAAkB,EAAE2S,EAAE,CAAC;AACnC,MAAA,OAAOA,EAAE;IACX,CAAC,CAAC,OAAOxe,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAM6kB,aAAaA,CAACrG,EAAE,EAAE;IACtB,IAAI;MACF,MAAMpd,IAAI,GAAG,MAAM,IAAI,CAACsgB,OAAO,CAACnD,IAAI,CAACC,EAAE,CAAC;MACxC,IAAI,CAAC6K,WAAW,GAAGjoB,IAAI;AAEvBnB,MAAAA,OAAO,CAAC4L,GAAG,CAAC,mBAAmB,EAAE2S,EAAE,CAAC;AACpC,MAAA,OAAOpd,IAAI;IACb,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACA;EACE,MAAM+kB,eAAeA,CAACvG,EAAE,EAAE;IACxB,IAAI;MACF,MAAMe,MAAM,GAAG,MAAM,IAAI,CAACmC,OAAO,CAACjD,MAAM,CAACD,EAAE,CAAC;AAE5Cve,MAAAA,OAAO,CAAC4L,GAAG,CAAC,oBAAoB,EAAE2S,EAAE,CAAC;AACrC,MAAA,OAAOe,MAAM;IACf,CAAC,CAAC,OAAOvf,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;EACE,MAAMklB,cAAcA,GAAG;IACrB,IAAI;MACF,MAAMD,UAAU,GAAG,MAAM,IAAI,CAACvD,OAAO,CAAChD,IAAI,EAAE;MAE5Cze,OAAO,CAAC4L,GAAG,CAAC,oBAAoB,EAAEoZ,UAAU,CAAC/iB,MAAM,CAAC;AACpD,MAAA,OAAO+iB,UAAU;IACnB,CAAC,CAAC,OAAOjlB,KAAK,EAAE;MACd,IAAI,CAACrD,OAAO,CAACmd,SAAS,CAACK,OAAO,CAACna,KAAK,CAAC;AACrC,MAAA,MAAMA,KAAK;AACb,IAAA;AACF,EAAA;;AAEA;AACF;AACA;AACA;AACEwqB,EAAAA,cAAcA,GAAG;IACf,OAAO,IAAI,CAACnB,WAAW;AACzB,EAAA;;AAEA;AACF;AACA;AACEne,EAAAA,OAAOA,GAAG;AACR;IACA,IAAI,CAAC9M,WAAW,GAAG,KAAK;IACxB,IAAI,CAACC,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACgrB,WAAW,GAAG,IAAI;AAEvB,IAAA,IAAI,IAAI,CAAC3H,OAAO,IAAI,OAAO,IAAI,CAACA,OAAO,CAAC5d,KAAK,KAAK,UAAU,EAAE;AAC5D,MAAA,IAAI,CAAC4d,OAAO,CAAC5d,KAAK,EAAE;AACtB,IAAA;AAEA7D,IAAAA,OAAO,CAAC4L,GAAG,CAAC,6BAA6B,CAAC;AAC5C,EAAA;AACF;;AAKA;AACA;AACA;AACO,MAAM4e,OAAO,GAAG;;AAEvB;AACA;AACA;AACO,MAAMC,UAAU,GAAG;AACxBzL,EAAAA,OAAO,EAAEwL,OAAO;EAChB7J,IAAI,EAAE,IAAIjgB,IAAI,EAAE,CAACgqB,WAAW,EAAE;AAC9BxlB,EAAAA,IAAI,EAAE;AACR;;;;"}