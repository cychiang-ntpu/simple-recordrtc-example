{"version":3,"file":"voicebank-recorder.js","sources":["../src/core/DeviceManager.js","../src/core/AudioEngine.js","../src/core/WaveformRenderer.js","../src/ui/VoiceBankRecorderUI.js","../src/storage/StorageAdapter.js","../src/storage/IndexedDBAdapter.js","../src/storage/ServerAdapter.js","../src/storage/ElectronAdapter.js","../src/storage/CapacitorAdapter.js","../src/storage/index.js","../src/utils/PlatformDetector.js","../src/index.js"],"sourcesContent":["/**\n * DeviceManager.js\n * 音訊裝置管理模組 - 處理麥克風和輸出裝置的列舉、選擇、記憶\n * \n * @module DeviceManager\n * @description 提供完整的音訊裝置管理功能，包含：\n * - 裝置列舉 (enumerateDevices)\n * - 裝置選擇與記憶 (localStorage)\n * - 裝置變更偵測 (devicechange event)\n * - 跨平台相容性處理\n */\n\n/**\n * DeviceManager - 音訊裝置管理器\n * 統一管理麥克風和輸出裝置的列舉、選擇與持久化\n */\nexport class DeviceManager {\n    /**\n     * @param {Object} options - 配置選項\n     * @param {string} [options.micStorageKey='preferredMicDeviceId'] - 麥克風偏好設定的 localStorage key\n     * @param {string} [options.outputStorageKey='preferredOutputDeviceId'] - 輸出裝置偏好設定的 localStorage key\n     * @param {boolean} [options.autoLoadPreferences=true] - 是否自動載入上次的偏好設定\n     * @param {boolean} [options.autoRequestPermission=true] - 列舉前是否自動請求麥克風權限\n     */\n    constructor(options = {}) {\n        this.options = {\n            micStorageKey: 'preferredMicDeviceId',\n            outputStorageKey: 'preferredOutputDeviceId',\n            autoLoadPreferences: true,\n            autoRequestPermission: true,\n            ...options\n        };\n        \n        // 裝置清單\n        this.microphoneDevices = [];\n        this.outputDevices = [];\n        \n        // 當前選擇的裝置 ID\n        this.selectedMicDeviceId = '';\n        this.selectedOutputDeviceId = 'default';\n        \n        // 事件監聽器\n        this._eventListeners = {\n            'devicechange': [],\n            'micchange': [],\n            'outputchange': []\n        };\n        \n        // 裝置變更監聽器\n        this._deviceChangeListener = null;\n        \n        // 自動載入偏好設定\n        if (this.options.autoLoadPreferences) {\n            this.loadPreferences();\n        }\n    }\n    \n    /**\n     * 從 localStorage 載入上次的裝置偏好設定\n     */\n    loadPreferences() {\n        console.log('[DeviceManager] loadPreferences 被呼叫');\n        \n        try {\n            const savedMicId = localStorage.getItem(this.options.micStorageKey);\n            const savedOutputId = localStorage.getItem(this.options.outputStorageKey);\n            \n            console.log(`[DeviceManager] localStorage 中的值:`);\n            console.log(`  - ${this.options.micStorageKey}: \"${savedMicId}\"`);\n            console.log(`  - ${this.options.outputStorageKey}: \"${savedOutputId}\"`);\n            \n            if (savedMicId) {\n                this.selectedMicDeviceId = savedMicId;\n                console.log(`[DeviceManager] 已載入麥克風偏好: ${savedMicId}`);\n            } else {\n                console.log(`[DeviceManager] 沒有儲存的麥克風偏好`);\n            }\n            \n            if (savedOutputId) {\n                this.selectedOutputDeviceId = savedOutputId;\n                console.log(`[DeviceManager] 已載入輸出裝置偏好: ${savedOutputId}`);\n            } else {\n                console.log(`[DeviceManager] 沒有儲存的輸出裝置偏好，使用 default`);\n            }\n        } catch (error) {\n            console.warn('[DeviceManager] Failed to load device preferences:', error);\n        }\n    }\n    \n    /**\n     * 儲存裝置偏好設定到 localStorage\n     * @param {string} type - 'microphone' 或 'output'\n     * @param {string} deviceId - 裝置 ID\n     */\n    savePreference(type, deviceId) {\n        try {\n            if (type === 'microphone') {\n                localStorage.setItem(this.options.micStorageKey, deviceId);\n                this.selectedMicDeviceId = deviceId;\n            } else if (type === 'output') {\n                localStorage.setItem(this.options.outputStorageKey, deviceId);\n                this.selectedOutputDeviceId = deviceId;\n            }\n        } catch (error) {\n            console.warn('Failed to save device preference:', error);\n        }\n    }\n    \n    /**\n     * 檢查瀏覽器是否支援裝置列舉\n     * @returns {boolean}\n     */\n    isSupported() {\n        return !!(navigator.mediaDevices && navigator.mediaDevices.enumerateDevices);\n    }\n    \n    /**\n     * 請求麥克風權限（必要時）\n     * @returns {Promise<void>}\n     */\n    async requestMicrophonePermission() {\n        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n            throw new Error('getUserMedia is not supported in this browser');\n        }\n        \n        try {\n            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n            // 立即停止所有 track，只是為了獲取權限\n            stream.getTracks().forEach(track => track.stop());\n        } catch (error) {\n            throw new Error(`Failed to request microphone permission: ${error.message}`);\n        }\n    }\n    \n    /**\n     * 列舉所有麥克風裝置\n     * @param {boolean} [requestPermission=true] - 是否先請求權限\n     * @returns {Promise<Array>} 麥克風裝置清單\n     */\n    async enumerateMicrophones(requestPermission = this.options.autoRequestPermission) {\n        if (!this.isSupported()) {\n            throw new Error('Device enumeration is not supported in this browser');\n        }\n        \n        try {\n            // 如果需要，先請求權限\n            if (requestPermission) {\n                try {\n                    await this.requestMicrophonePermission();\n                } catch (error) {\n                    // 忽略權限錯誤，繼續嘗試列舉（可能已經有權限）\n                    console.warn('Permission request failed, continuing anyway:', error);\n                }\n            }\n            \n            // 列舉所有裝置\n            const devices = await navigator.mediaDevices.enumerateDevices();\n            this.microphoneDevices = devices.filter(device => device.kind === 'audioinput');\n            \n            return this.microphoneDevices;\n        } catch (error) {\n            throw new Error(`Failed to enumerate microphones: ${error.message}`);\n        }\n    }\n    \n    /**\n     * 列舉所有輸出裝置\n     * @returns {Promise<Array>} 輸出裝置清單\n     */\n    async enumerateOutputDevices() {\n        if (!this.isSupported()) {\n            throw new Error('Device enumeration is not supported in this browser');\n        }\n        \n        try {\n            const devices = await navigator.mediaDevices.enumerateDevices();\n            this.outputDevices = devices.filter(device => device.kind === 'audiooutput');\n            \n            return this.outputDevices;\n        } catch (error) {\n            throw new Error(`Failed to enumerate output devices: ${error.message}`);\n        }\n    }\n    \n    /**\n     * 列舉所有裝置（麥克風 + 輸出）\n     * @param {boolean} [requestPermission=true] - 是否先請求麥克風權限\n     * @returns {Promise<Object>} { microphones, outputs }\n     */\n    async enumerateAllDevices(requestPermission = this.options.autoRequestPermission) {\n        const [microphones, outputs] = await Promise.all([\n            this.enumerateMicrophones(requestPermission),\n            this.enumerateOutputDevices()\n        ]);\n        \n        return { microphones, outputs };\n    }\n    \n    /**\n     * 選擇麥克風裝置\n     * @param {string} deviceId - 裝置 ID\n     * @param {boolean} [save=true] - 是否儲存偏好設定\n     */\n    selectMicrophone(deviceId, save = true) {\n        console.log(`[DeviceManager] selectMicrophone 被呼叫:`, { deviceId, save });\n        console.log(`[DeviceManager] 變更前: selectedMicDeviceId = \"${this.selectedMicDeviceId}\"`);\n        \n        this.selectedMicDeviceId = deviceId;\n        \n        console.log(`[DeviceManager] 變更後: selectedMicDeviceId = \"${this.selectedMicDeviceId}\"`);\n        \n        if (save) {\n            this.savePreference('microphone', deviceId);\n            console.log(`[DeviceManager] 已儲存至 localStorage (${this.options.micStorageKey})`);\n        }\n        \n        // 觸發 micchange 事件\n        this._emit('micchange', { deviceId });\n    }\n    \n    /**\n     * 選擇輸出裝置\n     * @param {string} deviceId - 裝置 ID\n     * @param {boolean} [save=true] - 是否儲存偏好設定\n     */\n    selectOutputDevice(deviceId, save = true) {\n        this.selectedOutputDeviceId = deviceId;\n        \n        if (save) {\n            this.savePreference('output', deviceId);\n        }\n        \n        // 觸發 outputchange 事件\n        this._emit('outputchange', { deviceId });\n    }\n    \n    /**\n     * 取得當前選擇的麥克風裝置 ID\n     * @returns {string}\n     */\n    getSelectedMicrophoneId() {\n        return this.selectedMicDeviceId;\n    }\n    \n    /**\n     * 取得當前選擇的輸出裝置 ID\n     * @returns {string}\n     */\n    getSelectedOutputDeviceId() {\n        return this.selectedOutputDeviceId;\n    }\n    \n    /**\n     * 取得當前選擇的麥克風裝置資訊\n     * @returns {MediaDeviceInfo|null}\n     */\n    getSelectedMicrophone() {\n        return this.microphoneDevices.find(device => device.deviceId === this.selectedMicDeviceId) || null;\n    }\n    \n    /**\n     * 取得當前選擇的輸出裝置資訊\n     * @returns {MediaDeviceInfo|null}\n     */\n    getSelectedOutputDevice() {\n        return this.outputDevices.find(device => device.deviceId === this.selectedOutputDeviceId) || null;\n    }\n    \n    /**\n     * 建立適用於 getUserMedia 的約束條件\n     * @param {Object} [additionalConstraints={}] - 額外的音訊約束\n     * @returns {Object} MediaStreamConstraints\n     */\n    getMicrophoneConstraints(additionalConstraints = {}) {\n        console.log(`[DeviceManager] getMicrophoneConstraints 被呼叫`);\n        console.log(`[DeviceManager] 當前 selectedMicDeviceId = \"${this.selectedMicDeviceId}\"`);\n        \n        const constraints = {\n            audio: {\n                ...additionalConstraints\n            },\n            video: false\n        };\n        \n        // 如果有選擇特定裝置，加入 deviceId 約束\n        if (this.selectedMicDeviceId) {\n            constraints.audio.deviceId = { exact: this.selectedMicDeviceId };\n            console.log(`[DeviceManager] 已加入 deviceId 約束: ${this.selectedMicDeviceId}`);\n        } else {\n            console.log(`[DeviceManager] 沒有選擇特定裝置，使用系統預設`);\n        }\n        \n        return constraints;\n    }\n    \n    /**\n     * 為 Audio 元素設定輸出裝置\n     * @param {HTMLAudioElement} audioElement - Audio 元素\n     * @param {string} [deviceId] - 裝置 ID（不提供則使用當前選擇的裝置）\n     * @returns {Promise<void>}\n     */\n    async setAudioOutputDevice(audioElement, deviceId) {\n        const targetDeviceId = deviceId || this.selectedOutputDeviceId;\n        \n        // 檢查瀏覽器是否支援 setSinkId\n        if (typeof audioElement.setSinkId !== 'function') {\n            console.warn('setSinkId is not supported in this browser');\n            return;\n        }\n        \n        try {\n            await audioElement.setSinkId(targetDeviceId);\n        } catch (error) {\n            throw new Error(`Failed to set audio output device: ${error.message}`);\n        }\n    }\n    \n    /**\n     * 檢查指定裝置是否仍然存在\n     * @param {string} deviceId - 裝置 ID\n     * @param {string} type - 'microphone' 或 'output'\n     * @returns {boolean}\n     */\n    isDeviceAvailable(deviceId, type) {\n        const devices = type === 'microphone' ? this.microphoneDevices : this.outputDevices;\n        return devices.some(device => device.deviceId === deviceId);\n    }\n    \n    /**\n     * 啟動裝置變更監聽\n     * 當裝置插拔時自動重新列舉\n     */\n    startDeviceChangeMonitoring() {\n        if (!navigator.mediaDevices || this._deviceChangeListener) {\n            return; // 不支援或已經在監聽\n        }\n        \n        this._deviceChangeListener = async () => {\n            try {\n                // 重新列舉裝置\n                await this.enumerateAllDevices(false); // 不需要重新請求權限\n                \n                // 觸發 devicechange 事件\n                this._emit('devicechange', {\n                    microphones: this.microphoneDevices,\n                    outputs: this.outputDevices\n                });\n            } catch (error) {\n                console.error('Device change enumeration failed:', error);\n            }\n        };\n        \n        navigator.mediaDevices.addEventListener('devicechange', this._deviceChangeListener);\n    }\n    \n    /**\n     * 停止裝置變更監聽\n     */\n    stopDeviceChangeMonitoring() {\n        if (this._deviceChangeListener && navigator.mediaDevices) {\n            navigator.mediaDevices.removeEventListener('devicechange', this._deviceChangeListener);\n            this._deviceChangeListener = null;\n        }\n    }\n    \n    /**\n     * 註冊事件監聽器\n     * @param {string} event - 事件名稱 ('devicechange', 'micchange', 'outputchange')\n     * @param {function} callback - 回調函數\n     */\n    on(event, callback) {\n        if (!this._eventListeners[event]) {\n            console.warn(`Unknown event: ${event}`);\n            return;\n        }\n        \n        this._eventListeners[event].push(callback);\n    }\n    \n    /**\n     * 移除事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {function} callback - 回調函數\n     */\n    off(event, callback) {\n        if (!this._eventListeners[event]) {\n            return;\n        }\n        \n        const index = this._eventListeners[event].indexOf(callback);\n        if (index > -1) {\n            this._eventListeners[event].splice(index, 1);\n        }\n    }\n    \n    /**\n     * 觸發事件\n     * @private\n     */\n    _emit(event, data) {\n        if (!this._eventListeners[event]) {\n            return;\n        }\n        \n        this._eventListeners[event].forEach(callback => {\n            try {\n                callback(data);\n            } catch (error) {\n                console.error(`Error in ${event} event handler:`, error);\n            }\n        });\n    }\n    \n    /**\n     * 銷毀 DeviceManager，清理資源\n     */\n    destroy() {\n        this.stopDeviceChangeMonitoring();\n        this._eventListeners = {\n            'devicechange': [],\n            'micchange': [],\n            'outputchange': []\n        };\n        this.microphoneDevices = [];\n        this.outputDevices = [];\n    }\n}\n\nexport default DeviceManager;\n","import DeviceManager from './DeviceManager.js';\n\n/**\n * AudioEngine - 跨平台音訊錄音引擎\n * \n * 功能：\n * - 封裝 Web Audio API (AudioContext, AudioWorklet)\n * - 支援 RecordRTC 錄音 (WAV 格式)\n * - 自動處理 AudioWorklet 與 ScriptProcessor fallback\n * - 提供錄音控制 (開始/停止/暫停/繼續)\n * - 事件驅動架構 (recording-start, data-available, recording-stop 等)\n * - 麥克風輸入管理與前級增益控制\n * - 整合裝置管理 (DeviceManager)\n * \n * @example\n * const engine = new AudioEngine({\n *   sampleRate: 48000,\n *   autoGainControl: false,\n *   micGain: 1.0\n * });\n * \n * engine.on('recording-start', () => console.log('Started'));\n * engine.on('data-available', (pcmData) => console.log('PCM chunk', pcmData));\n * engine.on('recording-stop', (blob) => console.log('Finished', blob));\n * \n * await engine.initialize();\n * await engine.startRecording();\n * // ... 錄音中 ...\n * await engine.stopRecording();\n */\n\nexport class AudioEngine {\n    /**\n     * 創建 AudioEngine 實例\n     * @param {Object} options - 配置選項\n     * @param {number} [options.sampleRate=48000] - 採樣率\n     * @param {boolean} [options.autoGainControl=false] - 自動增益控制\n     * @param {boolean} [options.echoCancellation=false] - 回音消除\n     * @param {boolean} [options.noiseSuppression=false] - 噪音抑制\n     * @param {number} [options.micGain=1.0] - 前級增益 (1.0-6.0)\n     * @param {string} [options.deviceId] - 麥克風設備 ID\n     * @param {string} [options.workletPath='assets/js/worklet/pcm-collector.js'] - AudioWorklet 模組路徑\n     * @param {boolean} [options.preferWorklet=true] - 優先使用 AudioWorklet（支援時）\n     * @param {DeviceManager} [options.deviceManager] - 外部提供的 DeviceManager 實例（可選）\n     * @param {boolean} [options.autoManageDevices=true] - 是否自動創建和管理 DeviceManager\n     */\n    constructor(options = {}) {\n        // 配置選項\n        this.config = {\n            sampleRate: options.sampleRate || 48000,\n            autoGainControl: options.autoGainControl !== undefined ? options.autoGainControl : false,\n            echoCancellation: options.echoCancellation !== undefined ? options.echoCancellation : false,\n            noiseSuppression: options.noiseSuppression !== undefined ? options.noiseSuppression : false,\n            micGain: options.micGain || 1.0,\n            deviceId: options.deviceId || null,\n            workletPath: options.workletPath || 'assets/js/worklet/pcm-collector.js',\n            preferWorklet: options.preferWorklet !== undefined ? options.preferWorklet : true,\n            autoManageDevices: options.autoManageDevices !== undefined ? options.autoManageDevices : true\n        };\n        \n        // 裝置管理器\n        if (options.deviceManager) {\n            this.deviceManager = options.deviceManager;\n            this._ownDeviceManager = false;\n        } else if (this.config.autoManageDevices) {\n            this.deviceManager = new DeviceManager();\n            this._ownDeviceManager = true;\n        } else {\n            this.deviceManager = null;\n            this._ownDeviceManager = false;\n        }\n\n        // Web Audio API 物件\n        this.audioContext = null;\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n\n        // AudioWorklet 相關\n        this.workletSupported = false;\n        this.workletLoaded = false;\n        this.pcmCollectorNode = null;\n        this.usingWorklet = false;\n\n        // PCM 數據收集 (AudioWorklet 模式)\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        // RecordRTC 錄音器\n        this.recorder = null;\n        \n        // RecordRTC 模式 PCM 採集\n        this._pcmCaptureInterval = null;\n\n        // 麥克風串流\n        this.micStream = null;\n\n        // 錄音狀態\n        this.isRecording = false;\n        this.isPaused = false;\n        this.isInitialized = false;\n\n        // 時間戳記\n        this.recordStartTime = 0;\n        this.recordStopTime = 0;\n        this.recordWallStartMs = 0;\n        this.recordWallStopMs = 0;\n\n        // 最後的錄音結果\n        this.latestBlob = null;\n        this.latestUrl = null;\n\n        // 事件監聽器\n        this._eventListeners = {};\n    }\n\n    /**\n     * 初始化音訊引擎\n     * 創建 AudioContext、Analyser、Gain 節點等\n     * @returns {Promise<void>}\n     */\n    async initialize() {\n        if (this.isInitialized) {\n            return;\n        }\n\n        try {\n            // 創建 AudioContext\n            // 注意：不指定 sampleRate，讓 AudioContext 使用硬體預設值\n            // 這樣可以避免 \"different sample-rate\" 錯誤\n            const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n            this.audioContext = new AudioContextClass();\n            \n            // 記錄實際使用的採樣率\n            console.log(`[AudioEngine] AudioContext 採樣率: ${this.audioContext.sampleRate} Hz`);\n            console.log(`[AudioEngine] 配置要求的採樣率: ${this.config.sampleRate} Hz`);\n            if (this.audioContext.sampleRate !== this.config.sampleRate) {\n                console.warn(`[AudioEngine] 注意：實際採樣率 (${this.audioContext.sampleRate}) 與配置 (${this.config.sampleRate}) 不同`);\n            }\n\n            // 創建分析器節點\n            this.analyser = this.audioContext.createAnalyser();\n            this.analyser.fftSize = 256;\n\n            // 創建前級增益節點\n            this.preGainNode = this.audioContext.createGain();\n            this.preGainNode.gain.value = this.config.micGain;\n\n            // 創建 MediaStreamDestination（供 RecordRTC 使用）\n            this.mediaDest = this.audioContext.createMediaStreamDestination();\n\n            // 連接節點：preGain -> analyser -> silencer -> destination\n            this.preGainNode.connect(this.analyser);\n            this.preGainNode.connect(this.mediaDest);\n\n            // 創建靜音節點（避免回授）\n            this.analyserSilencer = this.audioContext.createGain();\n            this.analyserSilencer.gain.value = 0;\n            this.analyser.connect(this.analyserSilencer);\n            this.analyserSilencer.connect(this.audioContext.destination);\n\n            // 檢測 AudioWorklet 支援\n            this.workletSupported = !!(\n                this.audioContext.audioWorklet && \n                window.AudioWorkletNode\n            );\n\n            // 載入 AudioWorklet 模組（如果支援且偏好使用）\n            if (this.workletSupported && this.config.preferWorklet) {\n                try {\n                    await this.audioContext.audioWorklet.addModule(this.config.workletPath);\n                    this.workletLoaded = true;\n                    this._emit('worklet-loaded', { path: this.config.workletPath });\n                } catch (error) {\n                    console.warn('載入 AudioWorklet 模組失敗，將回退到 RecordRTC:', error);\n                    this.workletLoaded = false;\n                    this._emit('worklet-load-failed', { error });\n                }\n            }\n\n            // 恢復 AudioContext（如果暫停）\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            this.isInitialized = true;\n            this._emit('initialized', {\n                sampleRate: this.audioContext.sampleRate,\n                state: this.audioContext.state,\n                workletSupported: this.workletSupported,\n                workletLoaded: this.workletLoaded\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'initialize', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 開始錄音\n     * @returns {Promise<void>}\n     */\n    async startRecording() {\n        if (!this.isInitialized) {\n            throw new Error('AudioEngine 尚未初始化，請先調用 initialize()');\n        }\n\n        if (this.isRecording) {\n            throw new Error('已經在錄音中');\n        }\n\n        try {\n            // 確保 AudioContext 是活躍狀態\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            // 停止舊的麥克風串流（如果存在）\n            this._stopMicrophone();\n\n            // 獲取麥克風（會使用 DeviceManager 選擇的裝置）\n            await this._captureMicrophone();\n\n            // 重置 PCM 數據收集\n            this.pcmChunks = [];\n            this.pcmTotalSamples = 0;\n\n            // 清理舊的錄音結果\n            if (this.latestUrl) {\n                URL.revokeObjectURL(this.latestUrl);\n                this.latestUrl = null;\n            }\n            this.latestBlob = null;\n\n            // 記錄開始時間\n            this.recordStartTime = Date.now();\n            this.recordWallStartMs = performance.now();\n            this.recordStopTime = 0;\n            this.recordWallStopMs = 0;\n\n            // 決定使用 AudioWorklet 或 RecordRTC\n            const useWorklet = this.workletLoaded && this.config.preferWorklet;\n\n            if (useWorklet) {\n                await this._startWorkletRecording();\n            } else {\n                await this._startRecordRTCRecording();\n            }\n\n            this.isRecording = true;\n            this.isPaused = false;\n\n            this._emit('recording-start', {\n                timestamp: this.recordStartTime,\n                mode: useWorklet ? 'worklet' : 'recordrtc',\n                sampleRate: this.audioContext.sampleRate\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'start-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 停止錄音\n     * @returns {Promise<Blob>} 錄音的 Blob\n     */\n    async stopRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        try {\n            this.isRecording = false;\n            this.recordStopTime = Date.now();\n            this.recordWallStopMs = performance.now();\n\n            let blob;\n\n            if (this.usingWorklet) {\n                blob = await this._stopWorkletRecording();\n            } else if (this.recorder) {\n                blob = await this._stopRecordRTCRecording();\n            } else {\n                throw new Error('沒有可用的錄音器');\n            }\n\n            // 停止麥克風\n            this._stopMicrophone();\n\n            // 儲存結果\n            this.latestBlob = blob;\n            this.latestUrl = URL.createObjectURL(blob);\n\n            const duration = (this.recordStopTime - this.recordStartTime) / 1000;\n\n            this._emit('recording-stop', {\n                blob,\n                url: this.latestUrl,\n                duration,\n                samples: this.pcmTotalSamples,\n                sampleRate: this.audioContext.sampleRate\n            });\n\n            return blob;\n\n        } catch (error) {\n            this._emit('error', { stage: 'stop-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 暫停錄音（僅 RecordRTC 模式支援）\n     */\n    pauseRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        if (this.usingWorklet) {\n            throw new Error('AudioWorklet 模式不支援暫停功能');\n        }\n\n        if (this.recorder && typeof this.recorder.pauseRecording === 'function') {\n            this.recorder.pauseRecording();\n            this.isPaused = true;\n            this._emit('recording-paused', { timestamp: Date.now() });\n        } else {\n            throw new Error('暫停功能不可用');\n        }\n    }\n\n    /**\n     * 繼續錄音（僅 RecordRTC 模式支援）\n     */\n    resumeRecording() {\n        if (!this.isPaused) {\n            throw new Error('錄音沒有暫停');\n        }\n\n        if (this.recorder && typeof this.recorder.resumeRecording === 'function') {\n            this.recorder.resumeRecording();\n            this.isPaused = false;\n            this._emit('recording-resumed', { timestamp: Date.now() });\n        } else {\n            throw new Error('繼續錄音功能不可用');\n        }\n    }\n\n    /**\n     * 取得最新的錄音數據\n     * @returns {Object} { blob, url, duration, samples }\n     */\n    getLatestRecording() {\n        return {\n            blob: this.latestBlob,\n            url: this.latestUrl,\n            duration: this.latestBlob ? (this.recordStopTime - this.recordStartTime) / 1000 : 0,\n            samples: this.pcmTotalSamples,\n            sampleRate: this.audioContext ? this.audioContext.sampleRate : 0\n        };\n    }\n\n    /**\n     * 取得 PCM 數據視窗（僅 AudioWorklet 模式）\n     * @param {number} start - 起始樣本索引\n     * @param {number} count - 樣本數量\n     * @returns {Float32Array|null}\n     */\n    getPcmWindow(start, count) {\n        if (!this.usingWorklet || !this.pcmChunks.length) {\n            return null;\n        }\n\n        if (start < 0) start = 0;\n        const total = this.pcmTotalSamples;\n        if (start >= total) return new Float32Array(0);\n\n        const end = Math.min(total, start + count);\n        const out = new Float32Array(end - start);\n        let offset = 0;\n        let passed = 0;\n\n        for (let i = 0; i < this.pcmChunks.length && passed < end; i++) {\n            const chunk = this.pcmChunks[i];\n            if (!chunk || !chunk.length) continue;\n\n            const cLen = chunk.length;\n            const cStart = passed;\n            const cEnd = passed + cLen;\n\n            if (cEnd <= start) {\n                passed = cEnd;\n                continue;\n            }\n\n            const segStart = Math.max(start, cStart);\n            const segEnd = Math.min(end, cEnd);\n\n            if (segEnd > segStart) {\n                const localStart = segStart - cStart;\n                const slice = chunk.subarray(localStart, localStart + (segEnd - segStart));\n                out.set(slice, offset);\n                offset += slice.length;\n            }\n\n            passed = cEnd;\n            if (segEnd >= end) break;\n        }\n\n        return out;\n    }\n\n    /**\n     * 取得 Analyser 節點（供外部波形顯示使用）\n     * @returns {AnalyserNode|null}\n     */\n    getAnalyser() {\n        return this.analyser;\n    }\n\n    /**\n     * 取得 AudioContext\n     * @returns {AudioContext|null}\n     */\n    getAudioContext() {\n        return this.audioContext;\n    }\n\n    /**\n     * 取得麥克風媒體流\n     * @returns {MediaStream|null}\n     */\n    get microphoneStream() {\n        return this.micStream;\n    }\n\n    /**\n     * 設定前級增益\n     * @param {number} gain - 增益值 (1.0-6.0)\n     */\n    setMicGain(gain) {\n        gain = Math.max(1.0, Math.min(6.0, gain));\n        this.config.micGain = gain;\n\n        if (this.preGainNode) {\n            this.preGainNode.gain.value = gain;\n        }\n\n        this._emit('mic-gain-changed', { gain });\n    }\n\n    /**\n     * 釋放資源\n     */\n    dispose() {\n        if (this.isRecording) {\n            this.stopRecording().catch(console.error);\n        }\n\n        this._stopMicrophone();\n        this._stopPcmCapture();\n\n        if (this.latestUrl) {\n            URL.revokeObjectURL(this.latestUrl);\n            this.latestUrl = null;\n        }\n\n        if (this.audioContext) {\n            this.audioContext.close().catch(console.error);\n            this.audioContext = null;\n        }\n\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n        this.pcmCollectorNode = null;\n        this.recorder = null;\n\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        this.isInitialized = false;\n\n        this._emit('disposed');\n    }\n\n    // ============================================================\n    // 事件系統\n    // ============================================================\n\n    /**\n     * 註冊事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    on(event, handler) {\n        if (!this._eventListeners[event]) {\n            this._eventListeners[event] = [];\n        }\n        this._eventListeners[event].push(handler);\n    }\n\n    /**\n     * 移除事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    off(event, handler) {\n        if (!this._eventListeners[event]) return;\n\n        const index = this._eventListeners[event].indexOf(handler);\n        if (index > -1) {\n            this._eventListeners[event].splice(index, 1);\n        }\n    }\n\n    /**\n     * 觸發事件（內部使用）\n     * @private\n     */\n    _emit(event, data) {\n        if (!this._eventListeners[event]) return;\n\n        this._eventListeners[event].forEach(handler => {\n            try {\n                handler(data);\n            } catch (error) {\n                console.error(`事件處理器錯誤 [${event}]:`, error);\n            }\n        });\n    }\n\n    // ============================================================\n    // 私有方法 - 麥克風捕獲\n    // ============================================================\n\n    async _captureMicrophone() {\n        let constraints;\n        \n        // 如果有 DeviceManager，使用它來建立約束條件\n        if (this.deviceManager) {\n            constraints = this.deviceManager.getMicrophoneConstraints({\n                echoCancellation: this.config.echoCancellation,\n                noiseSuppression: this.config.noiseSuppression,\n                autoGainControl: this.config.autoGainControl\n            });\n            \n            // 記錄選擇的裝置\n            const selectedId = this.deviceManager.getSelectedMicrophoneId();\n            console.log('[AudioEngine] 使用 DeviceManager 選擇的麥克風:', selectedId);\n            console.log('[AudioEngine] 約束條件:', JSON.stringify(constraints, null, 2));\n        } else {\n            // 傳統模式：手動建立約束條件\n            constraints = {\n                audio: {\n                    echoCancellation: this.config.echoCancellation,\n                    noiseSuppression: this.config.noiseSuppression,\n                    autoGainControl: this.config.autoGainControl\n                },\n                video: false\n            };\n\n            // 加入設備 ID 限制（如果有指定）\n            if (this.config.deviceId) {\n                constraints.audio.deviceId = { exact: this.config.deviceId };\n            }\n            \n            console.log('[AudioEngine] 使用傳統模式，約束條件:', JSON.stringify(constraints, null, 2));\n        }\n\n        try {\n            this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n            // iOS 自動增益調整\n            this._applyIOSMicGainAdjustment();\n\n            // 連接麥克風到前級增益節點\n            const source = this.audioContext.createMediaStreamSource(this.micStream);\n            source.connect(this.preGainNode);\n\n            const usedDeviceId = this.deviceManager ? \n                this.deviceManager.getSelectedMicrophoneId() : \n                this.config.deviceId;\n            \n            // 取得實際使用的裝置資訊\n            const audioTracks = this.micStream.getAudioTracks();\n            if (audioTracks.length > 0) {\n                const actualDevice = audioTracks[0].label;\n                console.log('[AudioEngine] 實際使用的麥克風:', actualDevice);\n            }\n\n            this._emit('microphone-captured', {\n                deviceId: usedDeviceId,\n                constraints\n            });\n\n        } catch (error) {\n            // 如果指定設備失敗，嘗試使用預設設備\n            if (error.name === 'OverconstrainedError' || error.name === 'NotFoundError') {\n                console.warn('指定的麥克風無法使用，嘗試預設設備');\n\n                delete constraints.audio.deviceId;\n                this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n                this._applyIOSMicGainAdjustment();\n\n                const source = this.audioContext.createMediaStreamSource(this.micStream);\n                source.connect(this.preGainNode);\n\n                this._emit('microphone-captured-fallback', { constraints });\n            } else {\n                throw error;\n            }\n        }\n    }\n\n    _stopMicrophone() {\n        if (this.micStream) {\n            this.micStream.getTracks().forEach(track => {\n                try {\n                    track.stop();\n                } catch (error) {\n                    console.warn('停止麥克風軌道失敗:', error);\n                }\n            });\n            this.micStream = null;\n        }\n    }\n\n    _applyIOSMicGainAdjustment() {\n        // iOS 上 AGC 關閉時音量偏低，自動提升增益\n        try {\n            const ua = navigator.userAgent || '';\n            const isIOS = /iphone|ipad|ipod/i.test(ua);\n\n            if (isIOS && !this.config.autoGainControl) {\n                if (Math.abs(this.config.micGain - 1.0) < 0.0001) {\n                    this.setMicGain(3.5);\n                    this._emit('ios-gain-adjusted', { gain: 3.5 });\n                }\n            }\n        } catch (error) {\n            console.warn('iOS 增益調整失敗:', error);\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - AudioWorklet 錄音\n    // ============================================================\n\n    async _startWorkletRecording() {\n        try {\n            // 創建 AudioWorkletNode\n            this.pcmCollectorNode = new AudioWorkletNode(\n                this.audioContext,\n                'pcm-collector-processor'\n            );\n\n            // 監聽 PCM 數據\n            this.pcmCollectorNode.port.onmessage = (event) => {\n                const { type, pcmData } = event.data;\n\n                if (type === 'pcm-data' && pcmData) {\n                    this.pcmChunks.push(new Float32Array(pcmData));\n                    this.pcmTotalSamples += pcmData.length;\n\n                    this._emit('data-available', {\n                        pcmData: new Float32Array(pcmData),\n                        totalSamples: this.pcmTotalSamples,\n                        mode: 'worklet'\n                    });\n                }\n            };\n\n            // 連接節點：preGain -> pcmCollector -> analyser\n            this.preGainNode.connect(this.pcmCollectorNode);\n            this.pcmCollectorNode.connect(this.audioContext.destination);\n\n            this.usingWorklet = true;\n\n        } catch (error) {\n            console.error('AudioWorklet 啟動失敗，回退到 RecordRTC:', error);\n            this.usingWorklet = false;\n            await this._startRecordRTCRecording();\n        }\n    }\n\n    async _stopWorkletRecording() {\n        try {\n            // 斷開 AudioWorkletNode\n            if (this.pcmCollectorNode) {\n                this.pcmCollectorNode.port.onmessage = null;\n                this.preGainNode.disconnect(this.pcmCollectorNode);\n                this.pcmCollectorNode.disconnect();\n                this.pcmCollectorNode = null;\n            }\n\n            // 合併 PCM 數據並轉換為 WAV\n            if (this.pcmChunks.length === 0) {\n                throw new Error('沒有錄音數據');\n            }\n\n            const merged = new Float32Array(this.pcmTotalSamples);\n            let offset = 0;\n\n            for (const chunk of this.pcmChunks) {\n                merged.set(chunk, offset);\n                offset += chunk.length;\n            }\n\n            // 轉換為 16-bit PCM WAV\n            const wavBuffer = this._buildWavFromFloat32Mono(\n                merged,\n                this.audioContext.sampleRate\n            );\n\n            const blob = new Blob([wavBuffer], { type: 'audio/wav' });\n\n            this.usingWorklet = false;\n\n            return blob;\n\n        } catch (error) {\n            console.error('AudioWorklet 停止失敗:', error);\n            throw error;\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - RecordRTC 錄音\n    // ============================================================\n\n    async _startRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                // 檢查 RecordRTC 是否可用\n                if (typeof RecordRTC === 'undefined') {\n                    reject(new Error('RecordRTC 未載入'));\n                    return;\n                }\n\n                const recordStream = this.mediaDest.stream || this.micStream;\n\n                this.recorder = RecordRTC(recordStream, {\n                    type: 'audio',\n                    mimeType: 'audio/wav',\n                    recorderType: StereoAudioRecorder,\n                    numberOfAudioChannels: 1,\n                    bufferSize: 4096,\n                    timeSlice: 100,\n                    ondataavailable: (blob) => {\n                        this._emit('data-available', {\n                            blob,\n                            mode: 'recordrtc'\n                        });\n                    }\n                });\n\n                this.recorder.startRecording();\n                this.usingWorklet = false;\n\n                // 啟動 PCM 數據採集循環（用於累積波形）\n                this._startPcmCapture();\n\n                resolve();\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    async _stopRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                if (!this.recorder) {\n                    reject(new Error('RecordRTC 錄音器不存在'));\n                    return;\n                }\n\n                // 停止 PCM 數據採集循環\n                this._stopPcmCapture();\n\n                this.recorder.stopRecording(() => {\n                    try {\n                        const blob = this.recorder.getBlob();\n\n                        // 清理錄音器\n                        this.recorder = null;\n\n                        resolve(blob);\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    /**\n     * 啟動 PCM 數據採集（RecordRTC 模式使用）\n     * @private\n     */\n    _startPcmCapture() {\n        if (!this.analyser) return;\n\n        const bufferLength = this.analyser.fftSize;\n        const dataArray = new Float32Array(bufferLength);\n        \n        // 每 100ms 採集一次 PCM 數據\n        this._pcmCaptureInterval = setInterval(() => {\n            if (!this.isRecording || !this.analyser) {\n                return;\n            }\n\n            // 從 AnalyserNode 讀取時域數據\n            this.analyser.getFloatTimeDomainData(dataArray);\n            \n            // 複製數據以避免被覆蓋\n            const pcmChunk = new Float32Array(dataArray);\n            \n            // 儲存到 pcmChunks\n            this.pcmChunks.push(pcmChunk);\n            this.pcmTotalSamples += pcmChunk.length;\n\n            // 發送事件給 WaveformRenderer\n            this._emit('data-available', {\n                pcmData: pcmChunk,\n                totalSamples: this.pcmTotalSamples,\n                mode: 'recordrtc-pcm'\n            });\n        }, 100);\n    }\n\n    /**\n     * 停止 PCM 數據採集\n     * @private\n     */\n    _stopPcmCapture() {\n        if (this._pcmCaptureInterval) {\n            clearInterval(this._pcmCaptureInterval);\n            this._pcmCaptureInterval = null;\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - WAV 格式轉換\n    // ============================================================\n\n    _buildWavFromFloat32Mono(float32Data, sampleRate) {\n        const numSamples = float32Data.length;\n        const buffer = new ArrayBuffer(44 + numSamples * 2);\n        const view = new DataView(buffer);\n\n        // WAV Header\n        this._writeString(view, 0, 'RIFF');\n        view.setUint32(4, 36 + numSamples * 2, true);\n        this._writeString(view, 8, 'WAVE');\n        this._writeString(view, 12, 'fmt ');\n        view.setUint32(16, 16, true); // fmt chunk size\n        view.setUint16(20, 1, true);  // audio format (PCM)\n        view.setUint16(22, 1, true);  // number of channels\n        view.setUint32(24, sampleRate, true);\n        view.setUint32(28, sampleRate * 2, true); // byte rate\n        view.setUint16(32, 2, true);  // block align\n        view.setUint16(34, 16, true); // bits per sample\n        this._writeString(view, 36, 'data');\n        view.setUint32(40, numSamples * 2, true);\n\n        // PCM Data (float32 -> int16)\n        let offset = 44;\n        for (let i = 0; i < numSamples; i++) {\n            const sample = Math.max(-1, Math.min(1, float32Data[i]));\n            const int16 = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;\n            view.setInt16(offset, int16, true);\n            offset += 2;\n        }\n\n        return buffer;\n    }\n\n    _writeString(view, offset, string) {\n        for (let i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n    \n    /**\n     * 銷毀 AudioEngine，釋放所有資源\n     */\n    destroy() {\n        // 停止錄音（如果正在錄音）\n        if (this.isRecording) {\n            this.stopRecording().catch(err => {\n                console.warn('停止錄音失敗:', err);\n            });\n        }\n        \n        // 停止麥克風\n        this._stopMicrophone();\n        \n        // 停止 PCM 採集\n        this._stopPcmCapture();\n        \n        // 清理 AudioWorklet\n        if (this.pcmCollectorNode) {\n            this.pcmCollectorNode.disconnect();\n            this.pcmCollectorNode = null;\n        }\n        \n        // 關閉 AudioContext\n        if (this.audioContext) {\n            this.audioContext.close().catch(err => {\n                console.warn('關閉 AudioContext 失敗:', err);\n            });\n            this.audioContext = null;\n        }\n        \n        // 清理 DeviceManager（如果是自己創建的）\n        if (this._ownDeviceManager && this.deviceManager) {\n            this.deviceManager.destroy();\n            this.deviceManager = null;\n        }\n        \n        // 清理事件監聽器\n        this._eventListeners = {};\n        \n        // 重置狀態\n        this.isInitialized = false;\n        this.isRecording = false;\n    }\n}\n\nexport default AudioEngine;\n","/**\n * WaveformRenderer.js\n * 波形渲染模組 - 整合即時波形、累積波形、概覽波形和 VU Meter\n * \n * @module WaveformRenderer\n * @description 提供完整的波形可視化功能，包含：\n * - LiveWaveform: 即時波形顯示（從 AnalyserNode）\n * - VUMeter: 音量表顯示（RMS/Peak dBFS）\n * - AccumulatedWaveform: 累積波形（使用 Worker 加速）\n * - OverviewWaveform: 全局概覽波形\n */\n\n/**\n * WaveformRenderer - 波形渲染管理器\n * 統一管理所有波形組件的初始化、更新和銷毀\n */\nexport class WaveformRenderer {\n    /**\n     * @param {Object} options - 配置選項\n     * @param {HTMLCanvasElement} options.liveCanvas - 即時波形 Canvas\n     * @param {HTMLCanvasElement} options.vuMeterCanvas - VU Meter Canvas\n     * @param {HTMLCanvasElement} options.accumulatedCanvas - 累積波形 Canvas\n     * @param {HTMLCanvasElement} options.overviewCanvas - 概覽波形 Canvas\n     * @param {AnalyserNode} options.analyserNode - Web Audio AnalyserNode\n     * @param {Object} options.audioEngine - AudioEngine 實例（可選，會自動獲取 analyserNode）\n     * @param {string} [options.workerPath] - Worker 腳本路徑\n     * @param {boolean} [options.useWorker=true] - 是否使用 Worker\n     * @param {boolean} [options.showClipMarks=true] - 是否顯示削波標記\n     */\n    constructor(options = {}) {\n        this.options = {\n            workerPath: options.workerPath || 'workers/wf-worker.js',\n            useWorker: options.useWorker !== false,\n            showClipMarks: options.showClipMarks !== false,\n            ...options\n        };\n        \n        // 支援從 audioEngine 獲取 analyserNode\n        this.audioEngine = options.audioEngine;\n        \n        this.liveWaveform = null;\n        this.vuMeter = null;\n        this.accumulatedWaveform = null;\n        this.overviewWaveform = null;\n        \n        this.isVerticalMode = false;\n        this._overviewUpdateScheduled = false;\n        \n        // 如果提供了 audioEngine，監聽錄音事件\n        if (this.audioEngine) {\n            this._setupAudioEngineListeners();\n        }\n    }\n    \n    /**\n     * 設置 AudioEngine 事件監聽\n     * @private\n     */\n    _setupAudioEngineListeners() {\n        if (!this.audioEngine) return;\n        \n        // 錄音開始時自動啟動波形\n        this.audioEngine.on('recording-start', () => {\n            this.start();\n        });\n        \n        // 錄音停止時停止波形\n        this.audioEngine.on('recording-stop', () => {\n            this.stopLive();\n        });\n        \n        // PCM 數據到達時更新累積波形\n        this.audioEngine.on('data-available', (data) => {\n            if (data.pcmData && this.accumulatedWaveform) {\n                this.appendPCM(data.pcmData);\n            }\n        });\n    }\n    \n    /**\n     * 初始化所有波形組件\n     */\n    async initialize() {\n        const { liveCanvas, vuMeterCanvas, accumulatedCanvas, overviewCanvas } = this.options;\n        \n        // 從 audioEngine 或 options 獲取 analyserNode\n        let analyserNode = this.options.analyserNode;\n        if (!analyserNode && this.audioEngine && typeof this.audioEngine.getAnalyser === 'function') {\n            analyserNode = this.audioEngine.getAnalyser();\n        }\n        \n        // 初始化即時波形\n        if (liveCanvas && analyserNode) {\n            this.liveWaveform = new LiveWaveform(liveCanvas, analyserNode);\n        }\n        \n        // 初始化 VU Meter\n        if (vuMeterCanvas && analyserNode) {\n            this.vuMeter = new VUMeter(vuMeterCanvas, analyserNode);\n        }\n        \n        // 初始化累積波形\n        if (accumulatedCanvas) {\n            this.accumulatedWaveform = new AccumulatedWaveform(accumulatedCanvas, {\n                workerPath: this.options.workerPath,\n                useWorker: this.options.useWorker,\n                showClipMarks: this.options.showClipMarks\n            });\n        }\n        \n        // 初始化概覽波形\n        if (overviewCanvas && this.accumulatedWaveform) {\n            this.overviewWaveform = new OverviewWaveform(overviewCanvas, this.accumulatedWaveform);\n            // 建立雙向引用，讓累積波形可以通知概覽波形更新\n            this.accumulatedWaveform.overviewWaveform = this.overviewWaveform;\n        }\n    }\n    \n    /**\n     * 開始即時波形顯示\n     * @param {MediaStream} stream - 麥克風媒體流\n     * @param {AudioContext} audioContext - Web Audio Context\n     * @param {GainNode} [preGainNode] - 前級增益節點（可選）\n     */\n    startLive(stream, audioContext, preGainNode) {\n        if (this.liveWaveform) {\n            this.liveWaveform.start(stream, audioContext, preGainNode);\n        }\n        if (this.vuMeter) {\n            this.vuMeter.start();\n        }\n    }\n    \n    /**\n     * 開始波形顯示（簡化版，從 audioEngine 自動獲取資訊）\n     */\n    start() {\n        if (!this.audioEngine) {\n            console.warn('No audioEngine provided, cannot start waveform rendering');\n            return;\n        }\n        \n        // 獲取必要資訊\n        const stream = this.audioEngine.microphoneStream;\n        const audioContext = this.audioEngine.audioContext;\n        const preGainNode = this.audioEngine.preGainNode;\n        \n        if (stream && audioContext) {\n            this.startLive(stream, audioContext, preGainNode);\n        }\n    }\n    \n    /**\n     * 停止即時波形顯示\n     */\n    stopLive() {\n        if (this.liveWaveform) {\n            this.liveWaveform.stop();\n        }\n        if (this.vuMeter) {\n            this.vuMeter.stop();\n        }\n    }\n    \n    /**\n     * 附加 PCM 數據到累積波形\n     * @param {Float32Array} pcmData - PCM 音訊數據\n     */\n    appendPCM(pcmData) {\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.append(pcmData);\n            \n            // 同時更新 OverviewWaveform\n            if (this.overviewWaveform) {\n                // 使用 requestAnimationFrame 避免過度繪製\n                if (!this._overviewUpdateScheduled) {\n                    this._overviewUpdateScheduled = true;\n                    requestAnimationFrame(() => {\n                        if (this.overviewWaveform) {\n                            this.overviewWaveform.draw();\n                        }\n                        this._overviewUpdateScheduled = false;\n                    });\n                }\n            }\n        }\n    }\n    \n    /**\n     * 重置所有波形\n     */\n    reset() {\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.reset();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.clear();\n        }\n    }\n    \n    /**\n     * 清除所有波形\n     */\n    clear() {\n        if (this.liveWaveform) {\n            this.liveWaveform.canvasContext.clearRect(0, 0, this.liveWaveform.width, this.liveWaveform.height);\n        }\n        if (this.vuMeter) {\n            this.vuMeter.clear();\n        }\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.clear();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.clear();\n        }\n    }\n    \n    /**\n     * 設定垂直/水平模式\n     * @param {boolean} isVertical - 是否為垂直模式\n     */\n    setVerticalMode(isVertical) {\n        this.isVerticalMode = isVertical;\n        \n        // 通知 Worker 模式變更\n        if (this.accumulatedWaveform && this.accumulatedWaveform._worker) {\n            this.accumulatedWaveform._worker.postMessage({\n                type: 'setVerticalMode',\n                verticalMode: isVertical\n            });\n        }\n    }\n    \n    /**\n     * 調整 Canvas 尺寸\n     */\n    resize() {\n        if (this.liveWaveform) {\n            this.liveWaveform.width = this.liveWaveform.canvas.width;\n            this.liveWaveform.height = this.liveWaveform.canvas.height;\n        }\n        if (this.vuMeter) {\n            this.vuMeter.resize();\n        }\n        if (this.accumulatedWaveform) {\n            this.accumulatedWaveform.width = this.accumulatedWaveform.canvas.width;\n            this.accumulatedWaveform.height = this.accumulatedWaveform.canvas.height;\n            if (this.accumulatedWaveform._worker) {\n                this.accumulatedWaveform._worker.postMessage({\n                    type: 'resize',\n                    width: this.accumulatedWaveform.width,\n                    height: this.accumulatedWaveform.height\n                });\n            }\n            this.accumulatedWaveform.draw();\n        }\n        if (this.overviewWaveform) {\n            this.overviewWaveform.width = this.overviewWaveform.canvas.width;\n            this.overviewWaveform.height = this.overviewWaveform.canvas.height;\n            this.overviewWaveform.draw();\n        }\n    }\n    \n    /**\n     * 銷毀所有組件，釋放資源\n     */\n    destroy() {\n        this.stopLive();\n        \n        if (this.accumulatedWaveform && this.accumulatedWaveform._worker) {\n            this.accumulatedWaveform._worker.terminate();\n        }\n        \n        this.liveWaveform = null;\n        this.vuMeter = null;\n        this.accumulatedWaveform = null;\n        this.overviewWaveform = null;\n    }\n}\n\n/* ================================================================\n * LiveWaveform 類 - 即時波形顯示\n * 從 AnalyserNode 取得時域數據並即時繪製波形\n * 支援水平和垂直模式\n * ================================================================ */\nexport class LiveWaveform {\n    constructor(canvas, analyserNode) {\n        this.canvas = canvas;\n        this.canvasContext = canvas.getContext('2d');\n        this.analyser = analyserNode;\n        this.mediaStreamSource = null;\n        this.animationId = null;\n        this.isRunning = false;\n\n        this.width = canvas.width;\n        this.height = canvas.height;\n\n        this.bufferLength = 0;\n        this.dataArray = null;\n        \n        this.amplification = 3.0;\n\n        this._lastDataArray = null;\n        this._verticalScrollOffset = 0;\n    }\n\n    /**\n     * 開始即時波形顯示\n     * @param {MediaStream} stream - 麥克風媒體流\n     * @param {AudioContext} audioContext - Web Audio Context\n     * @param {GainNode} [preGainNode] - 前級增益節點（可選）\n     */\n    start(stream, audioContext, preGainNode) {\n        if (this.isRunning || !audioContext || !this.analyser) {\n            console.warn('LiveWaveform.start() 條件不滿足:', {\n                isRunning: this.isRunning,\n                hasAudioContext: !!audioContext,\n                hasAnalyser: !!this.analyser\n            });\n            return;\n        }\n\n        console.log('✅ LiveWaveform 開始啟動...');\n        this.isRunning = true;\n        \n        const self = this;\n\n        // 確保 AudioContext 處於運行狀態\n        let contextReady = Promise.resolve();\n        if (audioContext.state === 'suspended') {\n            contextReady = audioContext.resume().catch(function(err) {\n                console.warn('Unable to resume AudioContext:', err);\n            });\n        }\n\n        // 等待 AudioContext 就緒後再連接麥克風\n        contextReady.then(function() {\n            // 為避免重複連線先清除舊的 source\n            if (self.mediaStreamSource) {\n                self.mediaStreamSource.disconnect();\n            }\n\n            // 連接麥克風\n            self.mediaStreamSource = audioContext.createMediaStreamSource(stream);\n            if (preGainNode) {\n                try { \n                    self.mediaStreamSource.connect(preGainNode); \n                } catch(e) { \n                    console.warn('connect preGainNode failed', e); \n                }\n            } else {\n                self.mediaStreamSource.connect(self.analyser);\n            }\n\n            // 設定 FFT 參數\n            self.analyser.fftSize = 1024;\n            self.bufferLength = self.analyser.fftSize;\n            self.dataArray = new Uint8Array(self.bufferLength);\n\n            console.log('✅ LiveWaveform 音訊連接完成，開始繪製');\n            \n            // 立即開始繪製\n            self.draw(false); // false = 水平模式\n        });\n    }\n\n    /**\n     * 停止即時波形顯示\n     */\n    stop() {\n        if (!this.isRunning) return;\n        \n        this.isRunning = false;\n        \n        if (this.mediaStreamSource) {\n            this.mediaStreamSource.disconnect();\n            this.mediaStreamSource = null;\n        }\n\n        if (this.animationId) {\n            cancelAnimationFrame(this.animationId);\n            this.animationId = null;\n        }\n        \n        this.canvasContext.clearRect(0, 0, this.width, this.height);\n    }\n\n    /**\n     * 繪製波形（持續更新）\n     * @param {boolean} [isVertical=false] - 是否為垂直模式\n     */\n    draw(isVertical = false) {\n        if (!this.isRunning || !this.analyser || !this.dataArray) {\n            return;\n        }\n\n        this.animationId = requestAnimationFrame(() => this.draw(isVertical));\n\n        this.analyser.getByteTimeDomainData(this.dataArray);\n\n        if (!isVertical) {\n            // 水平模式\n            this.canvasContext.fillStyle = '#f0f0f0';\n            this.canvasContext.fillRect(0, 0, this.width, this.height);\n\n            this.canvasContext.lineWidth = 2;\n            this.canvasContext.strokeStyle = '#1E88E5';\n            this.canvasContext.beginPath();\n\n            const sliceWidth = this.width / this.bufferLength;\n            let x = 0;\n\n            for (let i = 0; i < this.bufferLength; i++) {\n                const v = (this.dataArray[i] / 128.0 - 1) * this.amplification;\n                const y = (v * this.height / 2) + (this.height / 2);\n\n                if (i === 0) {\n                    this.canvasContext.moveTo(x, y);\n                } else {\n                    this.canvasContext.lineTo(x, y);\n                }\n\n                x += sliceWidth;\n            }\n\n            this.canvasContext.lineTo(this.width, this.height / 2);\n            this.canvasContext.stroke();\n        } else {\n            // 垂直模式（滾動繪製）\n            const scrollSpeed = 2;\n            this._verticalScrollOffset += scrollSpeed;\n            \n            if (this._verticalScrollOffset >= this.height) {\n                this._verticalScrollOffset = 0;\n                this.canvasContext.fillStyle = '#f0f0f0';\n                this.canvasContext.fillRect(0, 0, this.width, this.height);\n            }\n\n            this.canvasContext.lineWidth = 1.5;\n            this.canvasContext.strokeStyle = '#1E88E5';\n            this.canvasContext.beginPath();\n\n            const sliceHeight = this.height / this.bufferLength;\n            let y = 0;\n\n            for (let i = 0; i < this.bufferLength; i++) {\n                const v = (this.dataArray[i] / 128.0 - 1) * this.amplification;\n                const x = (v * this.width / 2) + (this.width / 2);\n\n                if (i === 0) {\n                    this.canvasContext.moveTo(x, y);\n                } else {\n                    this.canvasContext.lineTo(x, y);\n                }\n\n                y += sliceHeight;\n            }\n\n            this.canvasContext.stroke();\n        }\n    }\n}\n\n/* ================================================================\n * VUMeter 類 - 即時音量 (RMS/Peak) 顯示\n * 計算 RMS 與 Peak，轉換為 dB 值 (-90dB ~ 0dB)\n * 提供 peak hold 功能：峰值維持一段時間後緩降\n * ================================================================ */\nexport class VUMeter {\n    constructor(canvas, analyserNode) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d');\n        this.analyser = analyserNode;\n        this.bufferLength = 2048;\n        this.timeData = new Float32Array(this.bufferLength);\n        this.levelDb = -90;\n        this.peakDb = -90;\n        this.holdPeakDb = -90;\n        this.lastPeakTime = 0;\n        this.peakHoldMillis = 1500;\n        this.fallRateDbPerSec = 20;\n        this.minDb = -90;\n        this.maxDb = 0;\n        this.animationId = null;\n        this.lastClipTime = 0;\n        this.clipHoldMillis = 2000;\n        this._lastLogTime = 0;\n    }\n\n    _computeLevels() {\n        if (!this.analyser) return { rmsDb: this.minDb, peakDb: this.minDb };\n        \n        const required = this.analyser.fftSize || this.bufferLength;\n        if (this.timeData.length !== required) {\n            this.bufferLength = required;\n            this.timeData = new Float32Array(required);\n        }\n        \n        this.analyser.getFloatTimeDomainData(this.timeData);\n        let sumSquares = 0;\n        let peak = 0;\n        let clipped = false;\n        \n        for (let i = 0; i < this.bufferLength; i++) {\n            let v = this.timeData[i];\n            if (v > 1) v = 1;\n            else if (v < -1) v = -1;\n            sumSquares += v * v;\n            const absV = Math.abs(v);\n            if (absV > peak) peak = absV;\n            if (absV >= 0.995) clipped = true;\n        }\n        \n        const rms = Math.sqrt(sumSquares / this.bufferLength);\n        let rmsDb = rms > 0 ? 20 * Math.log10(rms) : -Infinity;\n        let peakDb = peak > 0 ? 20 * Math.log10(peak) : -Infinity;\n        \n        if (rmsDb < this.minDb) rmsDb = this.minDb;\n        if (rmsDb > this.maxDb) rmsDb = this.maxDb;\n        if (peakDb < this.minDb) peakDb = this.minDb;\n        if (peakDb > this.maxDb) peakDb = this.maxDb;\n        \n        if (clipped) {\n            this.lastClipTime = performance.now ? performance.now() : Date.now();\n        }\n        \n        return { rmsDb, peakDb };\n    }\n\n    resize() {\n        this.clear();\n    }\n\n    clear() {\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    draw(currentDb) {\n        const ctx = this.ctx;\n        const w = this.canvas.width;\n        const h = this.canvas.height;\n        \n        // 背景\n        ctx.clearRect(0, 0, w, h);\n        const grd = ctx.createLinearGradient(0, 0, w, 0);\n        grd.addColorStop(0, '#2d3748');\n        grd.addColorStop(1, '#1a202c');\n        ctx.fillStyle = grd;\n        ctx.fillRect(0, 0, w, h);\n\n        // dB 對應到 0~1\n        let norm = (currentDb - this.minDb) / (this.maxDb - this.minDb);\n        if (norm < 0) norm = 0;\n        if (norm > 1) norm = 1;\n\n        // 彩色漸層 (綠->黃->紅)\n        const barGrad = ctx.createLinearGradient(0, 0, w, 0);\n        barGrad.addColorStop(0, '#38a169');\n        barGrad.addColorStop(0.6, '#d69e2e');\n        barGrad.addColorStop(0.85, '#dd6b20');\n        barGrad.addColorStop(1, '#c53030');\n        ctx.fillStyle = barGrad;\n        const barWidth = Math.round(w * norm);\n        ctx.fillRect(0, 0, barWidth, h);\n\n        // 刻度線\n        ctx.save();\n        ctx.strokeStyle = 'rgba(255,255,255,0.15)';\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        \n        for (let db = this.minDb; db <= this.maxDb; db += 10) {\n            const posNorm = (db - this.minDb) / (this.maxDb - this.minDb);\n            const xPos = Math.round(w * posNorm) + 0.5;\n            \n            if (db === 0) {\n                ctx.strokeStyle = 'rgba(255,255,255,0.35)';\n                ctx.beginPath();\n                ctx.moveTo(xPos, 0);\n                ctx.lineTo(xPos, h);\n                ctx.stroke();\n                ctx.strokeStyle = 'rgba(255,255,255,0.15)';\n            } else {\n                ctx.moveTo(xPos, 0);\n                ctx.lineTo(xPos, h * 0.4);\n                ctx.moveTo(xPos, h);\n                ctx.lineTo(xPos, h * 0.6);\n            }\n            \n            if (db % 20 === 0 || db === -10) {\n                const label = db.toString();\n                ctx.fillStyle = (db === 0) ? '#ffffff' : (db === -10 ? '#ffeb3b' : '#cbd5e0');\n                ctx.font = '10px -apple-system,Segoe UI,sans-serif';\n                ctx.textAlign = 'center';\n                ctx.textBaseline = 'top';\n                ctx.fillText(label, xPos, 1);\n            }\n        }\n        ctx.restore();\n\n        // -10dBFS 區域高亮\n        const minus10Norm = (-10 - this.minDb) / (this.maxDb - this.minDb);\n        if (minus10Norm > 0 && minus10Norm < 1) {\n            const minus10X = Math.round(w * minus10Norm);\n            ctx.save();\n            ctx.fillStyle = 'rgba(255,235,59,0.08)';\n            ctx.fillRect(minus10X - 2, 0, 4, h);\n            ctx.restore();\n        }\n\n        // 峰值 hold 指示線\n        let holdNorm = (this.holdPeakDb - this.minDb) / (this.maxDb - this.minDb);\n        if (holdNorm < 0) holdNorm = 0;\n        if (holdNorm > 1) holdNorm = 1;\n        const holdX = Math.round(w * holdNorm);\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        ctx.moveTo(holdX + 0.5, 0);\n        ctx.lineTo(holdX + 0.5, h);\n        ctx.stroke();\n\n        // 文字顯示\n        ctx.fillStyle = '#f0f0f0';\n        ctx.font = 'bold 12px -apple-system,Segoe UI,sans-serif';\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'middle';\n        const displayRms = currentDb <= this.minDb ? '-∞' : currentDb.toFixed(1);\n        const displayPeak = this.peakDb <= this.minDb ? '-∞' : this.peakDb.toFixed(1);\n        const txt = `RMS ${displayRms} dBFS   Peak ${displayPeak} dBFS`;\n        ctx.fillText(txt, 8, h / 2);\n\n        // CLIP 指示\n        const now = performance.now ? performance.now() : Date.now();\n        if (this.lastClipTime && (now - this.lastClipTime) < this.clipHoldMillis) {\n            ctx.save();\n            ctx.fillStyle = '#B00020';\n            const badgeW = 42, badgeH = 18;\n            ctx.fillRect(w - badgeW - 8, 4, badgeW, badgeH);\n            ctx.fillStyle = '#fff';\n            ctx.font = 'bold 12px -apple-system,Segoe UI,sans-serif';\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n            ctx.fillText('CLIP', w - badgeW / 2 - 8, 4 + badgeH / 2 + 0.5);\n            ctx.restore();\n        }\n    }\n\n    update() {\n        const levels = this._computeLevels();\n        this.levelDb = levels.rmsDb;\n        this.peakDb = levels.peakDb;\n\n        const now = performance.now();\n        \n        // 更新 peak hold\n        if (this.peakDb > this.holdPeakDb + 0.5) {\n            this.holdPeakDb = this.peakDb;\n            this.lastPeakTime = now;\n        } else {\n            const elapsed = now - this.lastPeakTime;\n            if (elapsed > this.peakHoldMillis) {\n                const fallSeconds = (elapsed - this.peakHoldMillis) / 1000;\n                const fallAmount = this.fallRateDbPerSec * fallSeconds;\n                this.holdPeakDb = Math.max(this.peakDb, this.holdPeakDb - fallAmount);\n            }\n        }\n        \n        this.draw(this.levelDb);\n    }\n\n    start() {\n        this.stop();\n        \n        if (this.analyser) {\n            const required = this.analyser.fftSize || 2048;\n            if (this.timeData.length !== required) {\n                this.bufferLength = required;\n                this.timeData = new Float32Array(required);\n            }\n        }\n        \n        const self = this;\n        function loop() {\n            self.update();\n            self.animationId = requestAnimationFrame(loop);\n        }\n        loop();\n    }\n\n    stop() {\n        if (this.animationId) {\n            cancelAnimationFrame(this.animationId);\n            this.animationId = null;\n        }\n        this.clear();\n    }\n}\n\n/* ================================================================\n * AccumulatedWaveform 類 - 累積音訊波形顯示\n * 持續繪製目前錄製完成的音訊波形\n * 支援 OffscreenCanvas + Worker 加速\n * 支援縮放、平移、播放位置顯示\n * ================================================================ */\nexport class AccumulatedWaveform {\n    constructor(canvas, options = {}) {\n        this.canvas = canvas;\n        this.canvasContext = null;\n        this.width = canvas.width;\n        this.height = canvas.height;\n\n        this.targetSampleRate = 5000;\n        this.sourceSampleRate = 48000;\n        this.decimationFactor = 10;\n\n        this.sampleMin = [];\n        this.sampleMax = [];\n        this.sampleCount = 0;\n\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        \n        this.playbackPosition = 0;\n        this.isPlaying = false;\n        this.playbackStartTime = 0;\n        this.playbackStartSample = 0;\n\n        this.rawZoomMode = false;\n        this.rawViewStart = 0;\n        this.rawVisibleRaw = 0;\n        \n        // 關聯的 OverviewWaveform（用於同步更新）\n        this.overviewWaveform = null;\n\n        this._useWorker = options.useWorker !== false;\n        this._worker = null;\n        this._appendBatchMin = [];\n        this._appendBatchMax = [];\n        this._appendFlushScheduled = false;\n        this.lastDetail = null;\n        this.lastDensity = null;\n        \n        // 嘗試使用 OffscreenCanvas + Worker\n        if (this._useWorker && canvas.transferControlToOffscreen && typeof Worker !== 'undefined') {\n            try {\n                const off = canvas.transferControlToOffscreen();\n                this._worker = new Worker(options.workerPath || 'workers/wf-worker.js');\n                \n                this._worker.postMessage({\n                    type: 'init',\n                    canvas: off,\n                    width: this.width,\n                    height: this.height,\n                    verticalMode: false,\n                    showClipMarks: options.showClipMarks !== false,\n                    sourceSampleRate: this.sourceSampleRate,\n                    decimationFactor: this.decimationFactor\n                }, [off]);\n                \n                const self = this;\n                this._worker.onmessage = function(ev) {\n                    const msg = ev.data;\n                    if (!msg) return;\n                    if (msg.type === 'detailUpdate') {\n                        self.lastDetail = msg.detail;\n                        self.lastDensity = msg.density;\n                    }\n                };\n            } catch(e) {\n                console.warn('OffscreenCanvas 初始化失敗，使用主線程繪製:', e);\n                this._useWorker = false;\n            }\n        } else {\n            this._useWorker = false;\n        }\n        \n        // 如果沒有使用 Worker，獲取 2D context\n        if (!this._useWorker) {\n            try {\n                this.canvasContext = canvas.getContext('2d');\n            } catch(e) {\n                console.warn('無法獲取 canvas context:', e);\n            }\n        }\n        \n        // 設置滑鼠互動\n        this._setupMouseInteraction();\n        \n        this.clear();\n    }\n    \n    /**\n     * 設置滑鼠互動（平移、縮放、點擊定位）\n     * @private\n     */\n    _setupMouseInteraction() {\n        if (!this.canvas) return;\n        \n        let isDragging = false;\n        let dragStartX = 0;\n        let dragStartViewStart = 0;\n        \n        // 滑鼠按下\n        this.canvas.addEventListener('mousedown', (e) => {\n            isDragging = true;\n            dragStartX = e.offsetX;\n            dragStartViewStart = this.viewStart;\n            this.isAutoScroll = false;\n            this.canvas.style.cursor = 'grabbing';\n        });\n        \n        // 滑鼠移動（拖曳）\n        this.canvas.addEventListener('mousemove', (e) => {\n            if (!isDragging) return;\n            \n            const deltaX = e.offsetX - dragStartX;\n            const info = this.getVisibleSamples();\n            const samplesPerPixel = info.visible / this.width;\n            const sampleDelta = Math.round(-deltaX * samplesPerPixel);\n            \n            this.viewStart = dragStartViewStart + sampleDelta;\n            this._enforceViewBounds();\n            this.draw();\n            \n            // 同步更新 OverviewWaveform\n            if (this.overviewWaveform) {\n                this.overviewWaveform.draw();\n            }\n        });\n        \n        // 滑鼠放開\n        this.canvas.addEventListener('mouseup', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'grab';\n            }\n        });\n        \n        // 滑鼠離開 canvas\n        this.canvas.addEventListener('mouseleave', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'default';\n            }\n        });\n        \n        // 滑鼠滾輪（縮放）\n        this.canvas.addEventListener('wheel', (e) => {\n            e.preventDefault();\n            \n            // 計算滑鼠位置相對於 canvas 的比例\n            const rect = this.canvas.getBoundingClientRect();\n            const x = e.clientX - rect.left;\n            const anchorRatio = x / this.width;\n            \n            // 根據滾輪方向縮放\n            const zoomSteps = e.deltaY > 0 ? -1 : 1;\n            this.zoomBySteps(zoomSteps, anchorRatio);\n        });\n        \n        // 點擊定位（跳到播放位置）\n        this.canvas.addEventListener('click', (e) => {\n            if (isDragging) return; // 如果是拖曳結束，不觸發點擊\n            \n            const info = this.getVisibleSamples();\n            const clickRatio = e.offsetX / this.width;\n            const clickedSample = Math.floor(info.start + clickRatio * info.visible);\n            \n            // 觸發自定義事件，讓外部處理播放跳轉\n            const event = new CustomEvent('waveform-seek', {\n                detail: {\n                    sample: clickedSample,\n                    time: clickedSample / this.sourceSampleRate\n                }\n            });\n            this.canvas.dispatchEvent(event);\n        });\n        \n        // 設置 cursor 樣式\n        this.canvas.style.cursor = 'grab';\n    }\n\n    clear() {\n        if (this._useWorker && this._worker) {\n            this._worker.postMessage({ type: 'reset' });\n            return;\n        }\n        if (!this.canvasContext) return;\n        \n        this.canvasContext.clearRect(0, 0, this.width, this.height);\n        this.canvasContext.fillStyle = '#f0f0f0';\n        this.canvasContext.fillRect(0, 0, this.width, this.height);\n        this.canvasContext.lineWidth = 1;\n        this.canvasContext.strokeStyle = '#d0d0d0';\n        this.canvasContext.beginPath();\n        this.canvasContext.moveTo(0, this.height / 2);\n        this.canvasContext.lineTo(this.width, this.height / 2);\n        this.canvasContext.stroke();\n    }\n\n    reset() {\n        this.sampleMin.length = 0;\n        this.sampleMax.length = 0;\n        this.sampleCount = 0;\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        this.clear();\n    }\n\n    append(audioSamples) {\n        if (!audioSamples || !audioSamples.length) {\n            return;\n        }\n\n        const factor = this.decimationFactor;\n        const total = audioSamples.length;\n        const appendedMin = [];\n        const appendedMax = [];\n        \n        // 每秒記錄一次\n        if (!this._lastAppendLog) this._lastAppendLog = 0;\n        const now = Date.now();\n        if (now - this._lastAppendLog > 1000) {\n            console.log('📈 AccumulatedWaveform.append():', total, '樣本 →', \n                        Math.floor(total / factor), '區塊');\n            this._lastAppendLog = now;\n        }\n        \n        // 改進的演算法：DC Offset Removal（移除直流偏移）\n        // 先計算區塊平均值，再以此為中心計算 min/max\n        // 這樣可以讓波形更對稱、細緻\n        for (let i = 0; i < total; i += factor) {\n            let blockSum = 0;\n            let blockCount = 0;\n\n            // 第一階段：計算區塊平均值（DC offset）\n            for (let j = 0; j < factor && (i + j) < total; j++) {\n                const sample = audioSamples[i + j];\n                blockSum += sample;\n                blockCount++;\n            }\n\n            if (!blockCount) {\n                continue;\n            }\n\n            const blockMean = blockSum / blockCount;\n\n            // 第二階段：以區塊平均值為中心，計算去中心化的 min/max\n            let blockMin = 1.0;\n            let blockMax = -1.0;\n\n            for (let k = 0; k < blockCount; k++) {\n                const centeredSample = audioSamples[i + k] - blockMean;\n                if (centeredSample < blockMin) {\n                    blockMin = centeredSample;\n                }\n                if (centeredSample > blockMax) {\n                    blockMax = centeredSample;\n                }\n            }\n\n            // 防呆：確保 min <= max\n            if (blockMin > blockMax) {\n                blockMin = blockMax = 0;\n            }\n\n            this.sampleMin.push(blockMin);\n            this.sampleMax.push(blockMax);\n            appendedMin.push(blockMin);\n            appendedMax.push(blockMax);\n            this.sampleCount++;\n        }\n\n        if (this.isAutoScroll) {\n            this.scrollToLatest();\n        } else {\n            this._enforceViewBounds();\n        }\n\n        if (this._useWorker && this._worker) {\n            this._appendBatchMin.push(...appendedMin);\n            this._appendBatchMax.push(...appendedMax);\n            if (!this._appendFlushScheduled) {\n                this._appendFlushScheduled = true;\n                const self = this;\n                const flush = () => self._flushAppendBatch();\n                if (typeof requestAnimationFrame === 'function') {\n                    requestAnimationFrame(flush);\n                } else {\n                    setTimeout(flush, 32);\n                }\n            }\n        }\n        \n        this.draw();\n    }\n\n    _flushAppendBatch() {\n        if (!this._worker || this._appendBatchMin.length === 0) {\n            this._appendFlushScheduled = false;\n            return;\n        }\n        \n        this._worker.postMessage({\n            type: 'append',\n            minArr: this._appendBatchMin,\n            maxArr: this._appendBatchMax\n        });\n        \n        this._appendBatchMin = [];\n        this._appendBatchMax = [];\n        this._appendFlushScheduled = false;\n    }\n\n    draw() {\n        if (this._useWorker && this._worker) {\n            this._worker.postMessage({\n                type: 'draw',\n                zoomFactor: this.zoomFactor,\n                viewStart: this.viewStart,\n                playbackPosition: this.playbackPosition,\n                isPlaying: this.isPlaying\n            });\n            return;\n        }\n        \n        if (!this.canvasContext) return;\n        \n        // 主線程繪製\n        this.clear();\n        \n        if (this.sampleCount === 0) return;\n        \n        // 使用 getVisibleSamples() 獲取正確的可見範圍\n        const info = this.getVisibleSamples();\n        const { start, end, visible } = info;\n        \n        if (visible === 0 || start >= end) return;\n        \n        const centerY = this.height / 2;\n        \n        // 繪製波形 - 使用 sample 之間的連線\n        this.canvasContext.strokeStyle = '#1E88E5';\n        this.canvasContext.lineWidth = 1.5;\n        this.canvasContext.lineJoin = 'round';\n        this.canvasContext.lineCap = 'round';\n        \n        // 繪製上半部波形（最大值）\n        this.canvasContext.beginPath();\n        let hasFirstPoint = false;\n        for (let i = start; i < end; i++) {\n            const x = ((i - start) / visible) * this.width;\n            const y = centerY - (this.sampleMax[i] * centerY * 0.95);\n            \n            if (!hasFirstPoint) {\n                this.canvasContext.moveTo(x, y);\n                hasFirstPoint = true;\n            } else {\n                this.canvasContext.lineTo(x, y);\n            }\n        }\n        this.canvasContext.stroke();\n        \n        // 繪製下半部波形（最小值）\n        this.canvasContext.beginPath();\n        hasFirstPoint = false;\n        for (let i = start; i < end; i++) {\n            const x = ((i - start) / visible) * this.width;\n            const y = centerY - (this.sampleMin[i] * centerY * 0.95);\n            \n            if (!hasFirstPoint) {\n                this.canvasContext.moveTo(x, y);\n                hasFirstPoint = true;\n            } else {\n                this.canvasContext.lineTo(x, y);\n            }\n        }\n        this.canvasContext.stroke();\n        \n        // 繪製中線\n        this.canvasContext.strokeStyle = '#d0d0d0';\n        this.canvasContext.lineWidth = 1;\n        this.canvasContext.beginPath();\n        this.canvasContext.moveTo(0, centerY + 0.5);\n        this.canvasContext.lineTo(this.width, centerY + 0.5);\n        this.canvasContext.stroke();\n    }\n\n    getVisibleSamples() {\n        const total = this.sampleCount;\n        if (total === 0) return { start: 0, end: 0, visible: 0 };\n        \n        const minVis = this._getMinVisibleSamples(total);\n        let visible = Math.max(minVis, Math.round(total / this.zoomFactor));\n        if (visible > total) visible = total;\n        \n        let start = this.viewStart;\n        if (start + visible > total) start = total - visible;\n        if (start < 0) start = 0;\n        \n        const end = Math.min(total, start + visible);\n        return { start, end, visible };\n    }\n\n    _getMinVisibleSamples(total) {\n        // 允許放大到看到每個 sample\n        // 最小可見樣本數設為 canvas 寬度的 1/10，這樣每個 sample 可以占據約 10 個像素\n        return Math.max(10, Math.floor(this.width / 10));\n    }\n\n    _enforceViewBounds() {\n        if (this.sampleCount === 0) {\n            this.viewStart = 0;\n            return;\n        }\n        \n        const info = this.getVisibleSamples();\n        this.viewStart = info.start;\n        \n        // 確保 viewStart 在有效範圍內\n        if (this.viewStart < 0) {\n            this.viewStart = 0;\n        }\n        \n        const maxStart = Math.max(0, this.sampleCount - info.visible);\n        if (this.viewStart > maxStart) {\n            this.viewStart = maxStart;\n        }\n    }\n\n    scrollToLatest() {\n        const total = this.sampleCount;\n        if (total === 0) return;\n        \n        const minVis = this._getMinVisibleSamples(total);\n        let visible = Math.max(minVis, Math.round(total / this.zoomFactor));\n        if (visible > total) visible = total;\n        \n        this.viewStart = total - visible;\n        if (this.viewStart < 0) this.viewStart = 0;\n    }\n\n    setZoom(targetZoom, anchorSample) {\n        if (this.sampleCount === 0) return;\n        \n        if (targetZoom < 1) targetZoom = 1;\n        const maxZoom = Math.max(1, this.sampleCount / this._getMinVisibleSamples(this.sampleCount));\n        if (targetZoom > maxZoom) targetZoom = maxZoom;\n        \n        const oldInfo = this.getVisibleSamples();\n        this.zoomFactor = targetZoom;\n        const newInfo = this.getVisibleSamples();\n        \n        // 如果有錨點 sample，保持其視覺位置\n        if (typeof anchorSample === 'number' && anchorSample >= 0 && oldInfo.visible > 0) {\n            const oldRatio = (anchorSample - oldInfo.start) / oldInfo.visible;\n            const desiredStart = anchorSample - oldRatio * newInfo.visible;\n            this.viewStart = Math.max(0, Math.min(this.sampleCount - newInfo.visible, Math.floor(desiredStart)));\n        } else {\n            // 沒有錨點時，保持視圖中心\n            const oldCenter = oldInfo.start + oldInfo.visible / 2;\n            const desiredStart = oldCenter - newInfo.visible / 2;\n            this.viewStart = Math.max(0, Math.min(this.sampleCount - newInfo.visible, Math.floor(desiredStart)));\n        }\n        \n        this._enforceViewBounds();\n        this.draw();\n        \n        // 同步更新 OverviewWaveform\n        if (this.overviewWaveform) {\n            this.overviewWaveform.draw();\n        }\n    }\n\n    zoomBySteps(stepCount, anchorRatio = 0.5) {\n        if (stepCount === 0 || this.sampleCount === 0) return;\n        \n        // 增加縮放步進，從 1.2 改為 1.5，讓縮放更快\n        const zoomStep = 1.5;\n        const oldInfo = this.getVisibleSamples();\n        \n        // 確保 oldInfo.visible > 0 才計算錨點\n        let anchorSample;\n        if (oldInfo.visible > 0) {\n            anchorSample = oldInfo.start + anchorRatio * oldInfo.visible;\n        } else {\n            anchorSample = 0;\n        }\n        \n        let newZoom = this.zoomFactor;\n        if (stepCount > 0) {\n            newZoom *= Math.pow(zoomStep, stepCount);\n        } else {\n            newZoom /= Math.pow(zoomStep, -stepCount);\n        }\n        \n        this.setZoom(newZoom, anchorSample);\n    }\n\n    panBySamples(sampleDelta) {\n        if (sampleDelta === 0) return;\n        \n        this.isAutoScroll = false;\n        this.viewStart += sampleDelta;\n        this._enforceViewBounds();\n        this.draw();\n        \n        // 同步更新 OverviewWaveform\n        if (this.overviewWaveform) {\n            this.overviewWaveform.draw();\n        }\n    }\n\n    panByPixels(pixelDelta) {\n        if (pixelDelta === 0) return;\n        \n        const info = this.getVisibleSamples();\n        const samplesPerPixel = info.visible / this.width;\n        const totalDelta = pixelDelta * samplesPerPixel + this._panRemainder;\n        const intDelta = Math.round(totalDelta);\n        this._panRemainder = totalDelta - intDelta;\n        \n        this.panBySamples(intDelta);\n    }\n\n    resetView() {\n        this.zoomFactor = 1;\n        this.viewStart = 0;\n        this.isAutoScroll = true;\n        this._panRemainder = 0;\n        this.scrollToLatest();\n        this.draw();\n        \n        // 同步更新 OverviewWaveform\n        if (this.overviewWaveform) {\n            this.overviewWaveform.draw();\n        }\n    }\n\n    setSourceSampleRate(sampleRate) {\n        this.sourceSampleRate = sampleRate || 48000;\n        this.decimationFactor = Math.max(1, Math.round(this.sourceSampleRate / this.targetSampleRate));\n        \n        if (this._worker) {\n            this._worker.postMessage({\n                type: 'setSampleRate',\n                sourceSampleRate: this.sourceSampleRate,\n                decimationFactor: this.decimationFactor\n            });\n        }\n    }\n\n    _getSamplePair(index) {\n        if (index < 0 || index >= this.sampleCount) {\n            return { min: 0, max: 0 };\n        }\n        return {\n            min: this.sampleMin[index],\n            max: this.sampleMax[index]\n        };\n    }\n\n    setPlaybackPosition(sampleIndex) {\n        this.playbackPosition = sampleIndex;\n        this.draw();\n    }\n\n    setRawZoomMode(enabled) {\n        this.rawZoomMode = !!enabled;\n    }\n\n    startPlayback(startSample, sampleRate) {\n        this.isPlaying = true;\n        this.playbackStartSample = startSample || 0;\n        this.playbackStartTime = performance.now ? performance.now() : Date.now();\n        this.playbackPosition = this.playbackStartSample;\n        \n        const self = this;\n        const sr = sampleRate || this.sourceSampleRate;\n        \n        function updatePosition() {\n            if (!self.isPlaying) return;\n            \n            const now = performance.now ? performance.now() : Date.now();\n            const elapsed = (now - self.playbackStartTime) / 1000;\n            const rawSamples = elapsed * sr;\n            const decimatedPos = self.playbackStartSample + Math.floor(rawSamples / self.decimationFactor);\n            \n            self.playbackPosition = decimatedPos;\n            self.draw();\n            \n            requestAnimationFrame(updatePosition);\n        }\n        \n        requestAnimationFrame(updatePosition);\n    }\n\n    stopPlayback() {\n        this.isPlaying = false;\n        this.playbackPosition = 0;\n        this.draw();\n    }\n\n    _updatePlaybackPosition() {\n        if (!this.isPlaying) return;\n        \n        const now = performance.now ? performance.now() : Date.now();\n        const elapsed = (now - this.playbackStartTime) / 1000;\n        const rawSamples = elapsed * this.sourceSampleRate;\n        const decimatedPos = this.playbackStartSample + Math.floor(rawSamples / this.decimationFactor);\n        \n        this.playbackPosition = decimatedPos;\n    }\n}\n\n/* ================================================================\n * OverviewWaveform 類 - 全局波形概覽\n * 顯示整個錄音的波形概覽，並標示當前可視範圍\n * ================================================================ */\nexport class OverviewWaveform {\n    constructor(canvas, accumulatedWaveform) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext('2d');\n        this.accumulatedWaveform = accumulatedWaveform;\n        this.width = canvas.width;\n        this.height = canvas.height;\n        \n        // 暫時禁用 Worker 模式，使用主線程繪製\n        this._useWorker = false;\n        this._workerRef = null;\n        this._warnedNoData = false;\n        this._lastTotal = 0;\n        \n        // 設置滑鼠互動\n        this._setupMouseInteraction();\n        \n        // 注意：如果要啟用 Worker，需要確保 canvas 尚未獲取 context\n        // 且 accumulatedWaveform 已成功轉移其 canvas 控制權\n    }\n    \n    /**\n     * 設置滑鼠互動（點擊跳轉、拖曳可視範圍）\n     * @private\n     */\n    _setupMouseInteraction() {\n        if (!this.canvas) return;\n        \n        let isDragging = false;\n        let dragStartX = 0;\n        let dragStartViewStart = 0;\n        let dragClickedSample = 0; // 記錄點擊位置對應的絕對樣本位置\n        let dragVisibleSamples = 0; // 記錄拖曳開始時的可視範圍大小\n        \n        // 滑鼠按下 - 點擊或開始拖曳\n        this.canvas.addEventListener('mousedown', (e) => {\n            const acc = this.accumulatedWaveform;\n            if (!acc || acc.sampleCount === 0) return;\n            \n            isDragging = true;\n            dragStartX = e.offsetX;\n            dragStartViewStart = acc.viewStart;\n            \n            // 記錄拖曳開始時的狀態\n            const total = acc.sampleCount;\n            const info = acc.getVisibleSamples();\n            dragVisibleSamples = info.visible;\n            \n            // 計算點擊位置在可視範圍指示器內的偏移\n            // 使用與繪製時相同的座標映射邏輯\n            const viewStartX = Math.floor((info.start / total) * this.width);\n            const offsetInView = e.offsetX - viewStartX;\n            dragClickedSample = offsetInView; // 記錄在可視範圍內的像素偏移\n            \n            this.canvas.style.cursor = 'grabbing';\n        });\n        \n        // 滑鼠移動 - 拖曳更新\n        this.canvas.addEventListener('mousemove', (e) => {\n            if (!isDragging) return;\n            \n            const acc = this.accumulatedWaveform;\n            if (!acc || acc.sampleCount === 0) return;\n            \n            const total = acc.sampleCount;\n            \n            // 計算新的可視範圍起始位置（像素）\n            // 保持滑鼠在可視範圍內的相對位置不變\n            const targetViewStartX = e.offsetX - dragClickedSample;\n            \n            // 像素 → 樣本（使用反向映射）\n            const newViewStart = Math.floor((targetViewStartX / this.width) * total);\n            \n            // 確保 viewStart 在有效範圍內\n            const maxViewStart = Math.max(0, total - dragVisibleSamples);\n            const clampedViewStart = Math.max(0, Math.min(maxViewStart, newViewStart));\n            \n            // 更新視圖\n            acc.viewStart = clampedViewStart;\n            acc.isAutoScroll = false;\n            acc._enforceViewBounds();\n            acc.draw();\n            \n            // 重繪 overview\n            this.draw();\n        });\n        \n        // 滑鼠放開\n        this.canvas.addEventListener('mouseup', () => {\n            isDragging = false;\n            this.canvas.style.cursor = 'pointer';\n        });\n        \n        // 滑鼠離開\n        this.canvas.addEventListener('mouseleave', () => {\n            if (isDragging) {\n                isDragging = false;\n                this.canvas.style.cursor = 'pointer';\n            }\n        });\n        \n        // 設置 cursor 樣式\n        this.canvas.style.cursor = 'pointer';\n    }\n    \n    /**\n     * 處理點擊/拖曳跳轉\n     * @private\n     */\n    _handleSeek(clickX) {\n        const acc = this.accumulatedWaveform;\n        if (!acc || acc.sampleCount === 0) return;\n        \n        const total = acc.sampleCount;\n        const clickRatio = Math.max(0, Math.min(1, clickX / this.width));\n        const targetSample = Math.floor(clickRatio * total);\n        \n        // 獲取當前縮放級別下的可見樣本數\n        // 注意：這裡我們需要在設置 viewStart 之前就知道可見範圍\n        const currentZoom = acc.zoomFactor;\n        const minVis = acc._getMinVisibleSamples(total);\n        let visibleSamples = Math.max(minVis, Math.round(total / currentZoom));\n        if (visibleSamples > total) visibleSamples = total;\n        \n        // 計算新的 viewStart，讓 targetSample 位於可見範圍的中心\n        const halfVisible = Math.floor(visibleSamples / 2);\n        let newViewStart = targetSample - halfVisible;\n        \n        // 確保 viewStart 在有效範圍內\n        const maxViewStart = Math.max(0, total - visibleSamples);\n        newViewStart = Math.max(0, Math.min(maxViewStart, newViewStart));\n        \n        console.log('🎯 OverviewWaveform 導航:', {\n            clickX,\n            clickRatio: clickRatio.toFixed(3),\n            targetSample,\n            total,\n            visibleSamples,\n            halfVisible,\n            newViewStart,\n            maxViewStart,\n            zoomFactor: currentZoom\n        });\n        \n        // 更新 accumulated waveform 的視圖位置\n        acc.viewStart = newViewStart;\n        acc.isAutoScroll = false;\n        acc._enforceViewBounds();\n        acc.draw();\n        \n        // 重繪 overview 以更新可視範圍指示器\n        this.draw();\n        \n        // 觸發自定義事件\n        const event = new CustomEvent('overview-seek', {\n            detail: {\n                sample: targetSample,\n                time: targetSample / acc.sourceSampleRate\n            }\n        });\n        this.canvas.dispatchEvent(event);\n    }\n\n    clear() {\n        if (this._useWorker && this._workerRef) {\n            this._workerRef.postMessage({ type: 'clearOverview' });\n            return;\n        }\n        \n        this.ctx.clearRect(0, 0, this.width, this.height);\n        this.ctx.fillStyle = '#f5f5f5';\n        this.ctx.fillRect(0, 0, this.width, this.height);\n    }\n\n    draw() {\n        if (this._useWorker && this._workerRef) {\n            // Worker 會自動同步繪製 overview\n            return;\n        }\n        \n        // 主線程繪製\n        this.clear();\n        \n        const acc = this.accumulatedWaveform;\n        if (!acc || acc.sampleCount === 0) {\n            console.log('⚠️ OverviewWaveform: 沒有數據可顯示', {\n                hasAcc: !!acc,\n                sampleCount: acc ? acc.sampleCount : 0\n            });\n            return;\n        }\n        \n        const total = acc.sampleCount;\n        const info = acc.getVisibleSamples();\n        \n        console.log('📊 OverviewWaveform 繪製:', {\n            total,\n            visibleStart: info.start,\n            visibleEnd: info.end,\n            canvasWidth: this.width,\n            canvasHeight: this.height\n        });\n        \n        // 繪製全局波形\n        this.ctx.strokeStyle = '#64b5f6';\n        this.ctx.lineWidth = 1;\n        \n        const samplesPerPixel = total / this.width;\n        for (let x = 0; x < this.width; x++) {\n            const sampleIndex = Math.floor(x * samplesPerPixel);\n            if (sampleIndex >= total) break;\n            \n            const sample = acc._getSamplePair(sampleIndex);\n            const centerY = this.height / 2;\n            const yMin = Math.floor(centerY - (sample.max * centerY * 0.9));\n            const yMax = Math.floor(centerY - (sample.min * centerY * 0.9));\n            \n            // 繪製垂直線\n            this.ctx.beginPath();\n            this.ctx.moveTo(x, yMin);\n            this.ctx.lineTo(x, yMax);\n            this.ctx.stroke();\n        }\n        \n        // 繪製中線\n        this.ctx.strokeStyle = '#e0e0e0';\n        this.ctx.lineWidth = 1;\n        this.ctx.beginPath();\n        this.ctx.moveTo(0, this.height / 2);\n        this.ctx.lineTo(this.width, this.height / 2);\n        this.ctx.stroke();\n        \n        // 繪製可視範圍指示器\n        const viewStartX = Math.floor((info.start / total) * this.width);\n        const viewEndX = Math.floor((info.end / total) * this.width);\n        const viewWidth = Math.max(2, viewEndX - viewStartX);\n        \n        // 半透明覆蓋\n        this.ctx.fillStyle = 'rgba(33, 150, 243, 0.15)';\n        this.ctx.fillRect(viewStartX, 0, viewWidth, this.height);\n        \n        // 邊框\n        this.ctx.strokeStyle = '#2196F3';\n        this.ctx.lineWidth = 2;\n        this.ctx.strokeRect(viewStartX, 0, viewWidth, this.height);\n        \n        console.log('✅ OverviewWaveform 繪製完成');\n    }\n}\n\n// 導出所有類別\nexport default WaveformRenderer;\n","/**\n * VoiceBankRecorderUI.js\n * 完整的錄音器 UI 組件 - 包含所有界面元素和交互邏輯\n * \n * @module VoiceBankRecorderUI\n * @description 提供開箱即用的錄音器界面，包含：\n * - 自動生成 UI (HTML + CSS)\n * - 錄音控制按鈕\n * - 波形顯示 (即時、累積、概覽、VU Meter)\n * - 裝置管理 (麥克風、輸出裝置)\n * - 音訊處理選項 (增益、AGC、回音消除、降噪)\n * - 播放控制\n * - 狀態日誌\n */\n\nimport { AudioEngine } from '../core/AudioEngine.js';\nimport { WaveformRenderer } from '../core/WaveformRenderer.js';\nimport { DeviceManager } from '../core/DeviceManager.js';\n\n/**\n * VoiceBankRecorderUI - 完整的錄音器 UI 組件\n */\nexport class VoiceBankRecorderUI {\n    /**\n     * @param {Object} options - 配置選項\n     * @param {HTMLElement|string} options.container - 容器元素或選擇器\n     * @param {Object} [options.theme] - 主題配置\n     * @param {boolean} [options.showAdvancedOptions=true] - 是否顯示進階選項\n     * @param {boolean} [options.showStatusLog=true] - 是否顯示狀態日誌\n     * @param {Object} [options.audioConfig] - AudioEngine 配置\n     * @param {Object} [options.waveformConfig] - WaveformRenderer 配置\n     */\n    constructor(options = {}) {\n        this.options = {\n            showAdvancedOptions: true,\n            showStatusLog: true,\n            theme: {\n                primaryColor: '#667eea',\n                secondaryColor: '#764ba2',\n                successColor: '#10b981',\n                errorColor: '#ef4444',\n                warningColor: '#f59e0b'\n            },\n            ...options\n        };\n        \n        // 獲取容器\n        if (typeof options.container === 'string') {\n            this.container = document.querySelector(options.container);\n        } else {\n            this.container = options.container;\n        }\n        \n        if (!this.container) {\n            throw new Error('Container element not found');\n        }\n        \n        // 核心組件\n        this.audioEngine = null;\n        this.waveformRenderer = null;\n        this.deviceManager = null;\n        \n        // UI 元素引用\n        this.elements = {};\n        \n        // 播放器\n        this.audioPlayer = null;\n        this.recordedBlob = null;\n        this.recordedUrl = null;\n        \n        // 初始化狀態\n        this.isInitialized = false;\n    }\n    \n    /**\n     * 初始化 UI - 生成 HTML 和綁定事件\n     */\n    async initialize() {\n        if (this.isInitialized) {\n            console.warn('VoiceBankRecorderUI already initialized');\n            return;\n        }\n        \n        // 生成 UI\n        this._generateHTML();\n        this._injectStyles();\n        this._cacheElements();\n        \n        // 初始化音訊引擎\n        await this._initializeAudioEngine();\n        \n        // 初始化波形渲染器\n        await this._initializeWaveformRenderer();\n        \n        // 綁定事件\n        this._bindEvents();\n        \n        // 初始化裝置列表\n        await this._initializeDevices();\n        \n        this.isInitialized = true;\n        this._log('✓ VoiceBank Recorder UI 初始化完成', 'success');\n    }\n    \n    /**\n     * 生成 HTML 結構\n     * @private\n     */\n    _generateHTML() {\n        this.container.innerHTML = `\n            <div class=\"voicebank-recorder-ui\">\n                <!-- 錄音控制按鈕 -->\n                <div class=\"vbr-controls\">\n                    <button class=\"vbr-btn vbr-btn-record\" data-action=\"record\">\n                        <span class=\"vbr-icon\">🎙️</span>\n                        <span class=\"vbr-text\">開始錄音</span>\n                    </button>\n                    <button class=\"vbr-btn vbr-btn-stop\" data-action=\"stop\" disabled>\n                        <span class=\"vbr-icon\">⏹️</span>\n                        <span class=\"vbr-text\">停止錄音</span>\n                    </button>\n                </div>\n                \n                <!-- 波形顯示區 -->\n                <div class=\"vbr-waveforms\">\n                    <!-- 即時波形 -->\n                    <div class=\"vbr-waveform-section\">\n                        <h3 class=\"vbr-section-title\">即時波形</h3>\n                        <canvas class=\"vbr-canvas\" data-canvas=\"live\" width=\"800\" height=\"120\"></canvas>\n                    </div>\n                    \n                    <!-- VU Meter -->\n                    <div class=\"vbr-waveform-section\">\n                        <h3 class=\"vbr-section-title\">音量表 (VU Meter)</h3>\n                        <canvas class=\"vbr-canvas\" data-canvas=\"vu\" width=\"800\" height=\"50\"></canvas>\n                    </div>\n                    \n                    <!-- 累積波形 -->\n                    <div class=\"vbr-waveform-section\">\n                        <h3 class=\"vbr-section-title\">累積波形（可拖曳平移、滾輪縮放、點擊定位）</h3>\n                        <canvas class=\"vbr-canvas\" data-canvas=\"accumulated\" width=\"800\" height=\"200\"></canvas>\n                        <div class=\"vbr-toolbar\">\n                            <button class=\"vbr-toolbar-btn\" data-action=\"zoom-in\" disabled>\n                                <span>🔍+</span>\n                            </button>\n                            <button class=\"vbr-toolbar-btn\" data-action=\"zoom-out\" disabled>\n                                <span>🔍-</span>\n                            </button>\n                            <button class=\"vbr-toolbar-btn\" data-action=\"zoom-reset\" disabled>\n                                <span>🔄 重置視圖</span>\n                            </button>\n                            <button class=\"vbr-toolbar-btn\" data-action=\"pan-left\" disabled>\n                                <span>◀ 向左</span>\n                            </button>\n                            <button class=\"vbr-toolbar-btn\" data-action=\"pan-right\" disabled>\n                                <span>向右 ▶</span>\n                            </button>\n                            <label class=\"vbr-checkbox-label\">\n                                <input type=\"checkbox\" data-check=\"auto-scroll\" checked>\n                                <span>自動捲動</span>\n                            </label>\n                        </div>\n                    </div>\n                    \n                    <!-- 概覽波形 -->\n                    <div class=\"vbr-waveform-section\">\n                        <h3 class=\"vbr-section-title\">概覽波形（點擊或拖曳可快速導航）</h3>\n                        <canvas class=\"vbr-canvas\" data-canvas=\"overview\" width=\"800\" height=\"80\"></canvas>\n                    </div>\n                </div>\n                \n                <!-- 設定區 -->\n                <div class=\"vbr-settings\">\n                    <!-- 裝置設定 -->\n                    <div class=\"vbr-settings-section\">\n                        <h3 class=\"vbr-settings-title\">裝置設定</h3>\n                        <div class=\"vbr-device-row\">\n                            <label class=\"vbr-label\">麥克風：</label>\n                            <div class=\"vbr-device-select-group\">\n                                <select class=\"vbr-select\" data-select=\"microphone\" disabled>\n                                    <option>載入中...</option>\n                                </select>\n                                <button class=\"vbr-refresh-btn\" data-action=\"refresh-mic\" title=\"重新整理麥克風清單\">🔄</button>\n                            </div>\n                            <small class=\"vbr-hint\" data-hint=\"microphone\">選擇要使用的麥克風裝置</small>\n                        </div>\n                        <div class=\"vbr-device-row\">\n                            <label class=\"vbr-label\">輸出裝置：</label>\n                            <div class=\"vbr-device-select-group\">\n                                <select class=\"vbr-select\" data-select=\"output\" disabled>\n                                    <option value=\"default\">系統預設輸出</option>\n                                </select>\n                                <button class=\"vbr-refresh-btn\" data-action=\"refresh-output\" title=\"重新整理輸出裝置清單\">🔄</button>\n                            </div>\n                            <small class=\"vbr-hint\" data-hint=\"output\">部分瀏覽器需 HTTPS 才可切換輸出裝置</small>\n                        </div>\n                    </div>\n                    \n                    <!-- 進階選項 -->\n                    ${this.options.showAdvancedOptions ? `\n                    <div class=\"vbr-settings-section\">\n                        <h3 class=\"vbr-settings-title\">進階選項</h3>\n                        <div class=\"vbr-slider-row\">\n                            <label class=\"vbr-label\">麥克風增益：</label>\n                            <input type=\"range\" class=\"vbr-slider\" data-slider=\"gain\" min=\"1\" max=\"6\" step=\"0.1\" value=\"1.0\">\n                            <span class=\"vbr-slider-value\" data-value=\"gain\">1.0x</span>\n                        </div>\n                        <div class=\"vbr-checkbox-row\">\n                            <label class=\"vbr-checkbox-label\">\n                                <input type=\"checkbox\" data-check=\"agc\">\n                                <span>自動增益控制 (AGC)</span>\n                            </label>\n                            <label class=\"vbr-checkbox-label\">\n                                <input type=\"checkbox\" data-check=\"echo-cancel\">\n                                <span>回音消除</span>\n                            </label>\n                            <label class=\"vbr-checkbox-label\">\n                                <input type=\"checkbox\" data-check=\"noise-suppress\">\n                                <span>背景降噪</span>\n                            </label>\n                        </div>\n                    </div>\n                    ` : ''}\n                    \n                    <!-- 錄音資訊 -->\n                    <div class=\"vbr-info-section\" data-section=\"recording-info\" style=\"display: none;\">\n                        <h3 class=\"vbr-settings-title\">錄音資訊</h3>\n                        <div class=\"vbr-info-grid\">\n                            <div>時長：<span data-info=\"duration\">00:00.000</span></div>\n                            <div>樣本數：<span data-info=\"samples\">0</span></div>\n                            <div>採樣率：<span data-info=\"samplerate\">48000</span> Hz</div>\n                            <div>檔案大小：<span data-info=\"filesize\">0</span> KB</div>\n                        </div>\n                    </div>\n                </div>\n                \n                <!-- 播放控制 -->\n                <div class=\"vbr-playback\">\n                    <button class=\"vbr-btn vbr-btn-play\" data-action=\"play\" disabled>\n                        <span class=\"vbr-icon\">▶</span>\n                        <span class=\"vbr-text\">播放</span>\n                    </button>\n                    <button class=\"vbr-btn vbr-btn-pause\" data-action=\"pause\" disabled>\n                        <span class=\"vbr-icon\">⏸</span>\n                        <span class=\"vbr-text\">暫停</span>\n                    </button>\n                    <button class=\"vbr-btn vbr-btn-download\" data-action=\"download\" disabled>\n                        <span class=\"vbr-icon\">💾</span>\n                        <span class=\"vbr-text\">下載錄音</span>\n                    </button>\n                </div>\n                \n                <!-- 狀態日誌 -->\n                ${this.options.showStatusLog ? `\n                <div class=\"vbr-status-log\" data-log=\"status\">\n                    <div class=\"vbr-log-entry\">\n                        <span class=\"vbr-log-time\">[${this._getTimeString()}]</span>\n                        <span class=\"vbr-log-text\">準備就緒</span>\n                    </div>\n                </div>\n                ` : ''}\n            </div>\n        `;\n    }\n    \n    /**\n     * 注入 CSS 樣式\n     * @private\n     */\n    _injectStyles() {\n        const styleId = 'voicebank-recorder-ui-styles';\n        if (document.getElementById(styleId)) return;\n        \n        const style = document.createElement('style');\n        style.id = styleId;\n        style.textContent = this._getStyles();\n        document.head.appendChild(style);\n    }\n    \n    /**\n     * 獲取 CSS 樣式\n     * @private\n     * @returns {string}\n     */\n    _getStyles() {\n        const theme = this.options.theme;\n        \n        return `\n            .voicebank-recorder-ui {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                line-height: 1.6;\n                color: #333;\n                max-width: 900px;\n                margin: 0 auto;\n            }\n            \n            /* 錄音控制按鈕 */\n            .vbr-controls {\n                display: flex;\n                gap: 15px;\n                justify-content: center;\n                margin-bottom: 30px;\n                padding: 20px;\n                background: #f9fafb;\n                border-radius: 10px;\n            }\n            \n            .vbr-btn {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                font-size: 16px;\n                padding: 12px 30px;\n                border: none;\n                border-radius: 8px;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                font-weight: 600;\n                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n            }\n            \n            .vbr-btn:disabled {\n                opacity: 0.5;\n                cursor: not-allowed;\n            }\n            \n            .vbr-btn-record {\n                background: ${theme.errorColor};\n                color: white;\n            }\n            \n            .vbr-btn-record:hover:not(:disabled) {\n                background: #dc2626;\n                transform: translateY(-2px);\n                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n            }\n            \n            .vbr-btn-stop {\n                background: #9ca3af;\n                color: white;\n            }\n            \n            .vbr-btn-stop:hover:not(:disabled) {\n                background: #6b7280;\n                transform: translateY(-2px);\n                box-shadow: 0 4px 12px rgba(156, 163, 175, 0.3);\n            }\n            \n            .vbr-btn-play {\n                background: ${theme.primaryColor};\n                color: white;\n            }\n            \n            .vbr-btn-play:hover:not(:disabled) {\n                background: #5568d3;\n                transform: translateY(-2px);\n            }\n            \n            .vbr-btn-pause {\n                background: ${theme.warningColor};\n                color: white;\n            }\n            \n            .vbr-btn-pause:hover:not(:disabled) {\n                background: #d97706;\n                transform: translateY(-2px);\n            }\n            \n            .vbr-btn-download {\n                background: ${theme.primaryColor};\n                color: white;\n            }\n            \n            .vbr-btn-download:hover:not(:disabled) {\n                background: #5568d3;\n                transform: translateY(-2px);\n            }\n            \n            /* 波形區域 */\n            .vbr-waveforms {\n                margin-bottom: 30px;\n            }\n            \n            .vbr-waveform-section {\n                margin-bottom: 20px;\n            }\n            \n            .vbr-section-title {\n                font-size: 14px;\n                font-weight: 600;\n                color: #555;\n                margin-bottom: 8px;\n            }\n            \n            .vbr-canvas {\n                display: block;\n                width: 100%;\n                border: 2px solid #e5e7eb;\n                border-radius: 8px;\n                background: #f9fafb;\n            }\n            \n            .vbr-toolbar {\n                display: flex;\n                gap: 10px;\n                margin-top: 10px;\n                flex-wrap: wrap;\n                align-items: center;\n            }\n            \n            .vbr-toolbar-btn {\n                padding: 8px 16px;\n                border: 1px solid #d0d0d0;\n                border-radius: 6px;\n                background: white;\n                cursor: pointer;\n                font-size: 13px;\n                font-weight: 500;\n                color: #555;\n                transition: all 0.2s ease;\n            }\n            \n            .vbr-toolbar-btn:hover:not(:disabled) {\n                border-color: ${theme.primaryColor};\n                color: ${theme.primaryColor};\n                background: #f0f4ff;\n            }\n            \n            .vbr-toolbar-btn:disabled {\n                opacity: 0.4;\n                cursor: not-allowed;\n            }\n            \n            .vbr-checkbox-label {\n                display: flex;\n                align-items: center;\n                gap: 5px;\n                font-size: 13px;\n                color: #555;\n                cursor: pointer;\n            }\n            \n            /* 設定區域 */\n            .vbr-settings {\n                margin-bottom: 30px;\n            }\n            \n            .vbr-settings-section {\n                background: #f9fafb;\n                padding: 20px;\n                border-radius: 10px;\n                margin-bottom: 20px;\n            }\n            \n            .vbr-settings-title {\n                font-size: 16px;\n                font-weight: 600;\n                color: ${theme.primaryColor};\n                margin-bottom: 15px;\n            }\n            \n            .vbr-device-row {\n                margin-bottom: 15px;\n            }\n            \n            .vbr-label {\n                display: block;\n                font-size: 14px;\n                font-weight: 500;\n                color: #555;\n                margin-bottom: 5px;\n            }\n            \n            .vbr-device-select-group {\n                display: flex;\n                gap: 10px;\n            }\n            \n            .vbr-select {\n                flex: 1;\n                padding: 8px;\n                border: 1px solid #d0d0d0;\n                border-radius: 6px;\n                font-size: 14px;\n            }\n            \n            .vbr-refresh-btn {\n                padding: 8px 12px;\n                background: ${theme.primaryColor};\n                color: white;\n                border: none;\n                border-radius: 6px;\n                cursor: pointer;\n                font-size: 13px;\n            }\n            \n            .vbr-hint {\n                display: block;\n                color: #666;\n                font-size: 12px;\n                margin-top: 5px;\n            }\n            \n            .vbr-slider-row {\n                display: flex;\n                align-items: center;\n                gap: 10px;\n                margin-bottom: 15px;\n            }\n            \n            .vbr-slider {\n                flex: 1;\n            }\n            \n            .vbr-slider-value {\n                min-width: 50px;\n                font-weight: 600;\n            }\n            \n            .vbr-checkbox-row {\n                display: flex;\n                flex-wrap: wrap;\n                gap: 15px;\n            }\n            \n            .vbr-info-section {\n                background: #f0f4ff;\n                padding: 20px;\n                border-radius: 10px;\n                border-left: 4px solid ${theme.primaryColor};\n            }\n            \n            .vbr-info-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n                gap: 10px;\n                font-size: 14px;\n            }\n            \n            .vbr-info-grid span {\n                font-weight: 600;\n                color: ${theme.primaryColor};\n            }\n            \n            /* 播放控制 */\n            .vbr-playback {\n                display: flex;\n                gap: 15px;\n                justify-content: center;\n                margin-bottom: 30px;\n            }\n            \n            /* 狀態日誌 */\n            .vbr-status-log {\n                background: #1f2937;\n                color: ${theme.successColor};\n                padding: 20px;\n                border-radius: 10px;\n                font-family: 'Courier New', monospace;\n                font-size: 13px;\n                line-height: 1.8;\n                max-height: 200px;\n                overflow-y: auto;\n            }\n            \n            .vbr-log-entry {\n                margin-bottom: 5px;\n            }\n            \n            .vbr-log-time {\n                color: #6b7280;\n                margin-right: 10px;\n            }\n            \n            .vbr-log-error {\n                color: ${theme.errorColor};\n            }\n            \n            .vbr-log-warning {\n                color: ${theme.warningColor};\n            }\n            \n            .vbr-log-success {\n                color: ${theme.successColor};\n            }\n        `;\n    }\n    \n    /**\n     * 快取 DOM 元素引用\n     * @private\n     */\n    _cacheElements() {\n        const root = this.container.querySelector('.voicebank-recorder-ui');\n        \n        // 按鈕\n        this.elements.recordBtn = root.querySelector('[data-action=\"record\"]');\n        this.elements.stopBtn = root.querySelector('[data-action=\"stop\"]');\n        this.elements.playBtn = root.querySelector('[data-action=\"play\"]');\n        this.elements.pauseBtn = root.querySelector('[data-action=\"pause\"]');\n        this.elements.downloadBtn = root.querySelector('[data-action=\"download\"]');\n        \n        // 波形工具列按鈕\n        this.elements.zoomInBtn = root.querySelector('[data-action=\"zoom-in\"]');\n        this.elements.zoomOutBtn = root.querySelector('[data-action=\"zoom-out\"]');\n        this.elements.zoomResetBtn = root.querySelector('[data-action=\"zoom-reset\"]');\n        this.elements.panLeftBtn = root.querySelector('[data-action=\"pan-left\"]');\n        this.elements.panRightBtn = root.querySelector('[data-action=\"pan-right\"]');\n        this.elements.autoScrollCheck = root.querySelector('[data-check=\"auto-scroll\"]');\n        \n        // Canvas\n        this.elements.liveCanvas = root.querySelector('[data-canvas=\"live\"]');\n        this.elements.vuCanvas = root.querySelector('[data-canvas=\"vu\"]');\n        this.elements.accumulatedCanvas = root.querySelector('[data-canvas=\"accumulated\"]');\n        this.elements.overviewCanvas = root.querySelector('[data-canvas=\"overview\"]');\n        \n        // 裝置選擇\n        this.elements.micSelect = root.querySelector('[data-select=\"microphone\"]');\n        this.elements.outputSelect = root.querySelector('[data-select=\"output\"]');\n        this.elements.refreshMicBtn = root.querySelector('[data-action=\"refresh-mic\"]');\n        this.elements.refreshOutputBtn = root.querySelector('[data-action=\"refresh-output\"]');\n        \n        // 進階選項\n        if (this.options.showAdvancedOptions) {\n            this.elements.gainSlider = root.querySelector('[data-slider=\"gain\"]');\n            this.elements.gainValue = root.querySelector('[data-value=\"gain\"]');\n            this.elements.agcCheck = root.querySelector('[data-check=\"agc\"]');\n            this.elements.echoCancelCheck = root.querySelector('[data-check=\"echo-cancel\"]');\n            this.elements.noiseSuppressCheck = root.querySelector('[data-check=\"noise-suppress\"]');\n        }\n        \n        // 錄音資訊\n        this.elements.recordingInfo = root.querySelector('[data-section=\"recording-info\"]');\n        this.elements.durationInfo = root.querySelector('[data-info=\"duration\"]');\n        this.elements.samplesInfo = root.querySelector('[data-info=\"samples\"]');\n        this.elements.samplerateInfo = root.querySelector('[data-info=\"samplerate\"]');\n        this.elements.filesizeInfo = root.querySelector('[data-info=\"filesize\"]');\n        \n        // 狀態日誌\n        if (this.options.showStatusLog) {\n            this.elements.statusLog = root.querySelector('[data-log=\"status\"]');\n        }\n    }\n    \n    /**\n     * 初始化音訊引擎\n     * @private\n     */\n    async _initializeAudioEngine() {\n        const audioConfig = {\n            sampleRate: 48000,\n            echoCancellation: false,\n            noiseSuppression: false,\n            autoGainControl: false,\n            autoManageDevices: true,\n            ...this.options.audioConfig\n        };\n        \n        this.audioEngine = new AudioEngine(audioConfig);\n        await this.audioEngine.initialize();\n        this.deviceManager = this.audioEngine.deviceManager;\n        \n        this._log('音訊引擎初始化完成', 'info');\n    }\n    \n    /**\n     * 初始化波形渲染器\n     * @private\n     */\n    async _initializeWaveformRenderer() {\n        const waveformConfig = {\n            liveCanvas: this.elements.liveCanvas,\n            vuMeterCanvas: this.elements.vuCanvas,\n            accumulatedCanvas: this.elements.accumulatedCanvas,\n            overviewCanvas: this.elements.overviewCanvas,\n            audioEngine: this.audioEngine,\n            useWorker: false,\n            showClipMarks: true,\n            ...this.options.waveformConfig\n        };\n        \n        this.waveformRenderer = new WaveformRenderer(waveformConfig);\n        await this.waveformRenderer.initialize();\n        \n        this._log('波形渲染器初始化完成', 'info');\n    }\n    \n    /**\n     * 綁定所有事件\n     * @private\n     */\n    _bindEvents() {\n        // 錄音控制\n        this.elements.recordBtn.addEventListener('click', () => this._handleRecord());\n        this.elements.stopBtn.addEventListener('click', () => this._handleStop());\n        \n        // 播放控制\n        this.elements.playBtn.addEventListener('click', () => this._handlePlay());\n        this.elements.pauseBtn.addEventListener('click', () => this._handlePause());\n        this.elements.downloadBtn.addEventListener('click', () => this._handleDownload());\n        \n        // 波形工具列\n        this.elements.zoomInBtn.addEventListener('click', () => this._handleZoomIn());\n        this.elements.zoomOutBtn.addEventListener('click', () => this._handleZoomOut());\n        this.elements.zoomResetBtn.addEventListener('click', () => this._handleZoomReset());\n        this.elements.panLeftBtn.addEventListener('click', () => this._handlePanLeft());\n        this.elements.panRightBtn.addEventListener('click', () => this._handlePanRight());\n        this.elements.autoScrollCheck.addEventListener('change', (e) => this._handleAutoScrollChange(e));\n        \n        // 裝置選擇\n        this.elements.micSelect.addEventListener('change', (e) => this._handleMicChange(e));\n        this.elements.outputSelect.addEventListener('change', (e) => this._handleOutputChange(e));\n        this.elements.refreshMicBtn.addEventListener('click', () => this._refreshMicrophones());\n        this.elements.refreshOutputBtn.addEventListener('click', () => this._refreshOutputDevices());\n        \n        // 進階選項\n        if (this.options.showAdvancedOptions) {\n            this.elements.gainSlider.addEventListener('input', (e) => this._handleGainChange(e));\n            this.elements.agcCheck.addEventListener('change', (e) => this._handleAGCChange(e));\n            this.elements.echoCancelCheck.addEventListener('change', (e) => this._handleEchoCancelChange(e));\n            this.elements.noiseSuppressCheck.addEventListener('change', (e) => this._handleNoiseSuppressChange(e));\n        }\n    }\n    \n    /**\n     * 初始化裝置列表\n     * @private\n     */\n    async _initializeDevices() {\n        if (!this.deviceManager) {\n            this._log('❌ DeviceManager 尚未初始化', 'error');\n            return;\n        }\n        \n        await this._refreshMicrophones();\n        await this._refreshOutputDevices();\n    }\n    \n    /**\n     * 重新整理麥克風列表\n     * @private\n     */\n    async _refreshMicrophones() {\n        if (!this.deviceManager) {\n            this._log('❌ DeviceManager 尚未初始化', 'error');\n            this.elements.micSelect.innerHTML = '<option>初始化失敗</option>';\n            this.elements.micSelect.disabled = true;\n            return;\n        }\n        \n        try {\n            this._log('🔍 正在列舉麥克風裝置...', 'info');\n            const microphones = await this.deviceManager.enumerateMicrophones();\n            \n            this.elements.micSelect.innerHTML = '';\n            \n            if (microphones.length === 0) {\n                this.elements.micSelect.innerHTML = '<option>未偵測到麥克風</option>';\n                this.elements.micSelect.disabled = true;\n                this._log('⚠️ 未偵測到麥克風裝置', 'warning');\n                return;\n            }\n            \n            microphones.forEach((device, index) => {\n                const option = document.createElement('option');\n                option.value = device.deviceId;\n                option.textContent = device.label || `麥克風 ${index + 1}`;\n                this.elements.micSelect.appendChild(option);\n            });\n            \n            // 恢復上次選擇\n            const savedId = this.deviceManager.getSelectedMicrophoneId();\n            if (savedId && this.deviceManager.isDeviceAvailable(savedId, 'microphone')) {\n                this.elements.micSelect.value = savedId;\n            } else if (microphones.length > 0) {\n                this.deviceManager.selectMicrophone(microphones[0].deviceId, true);\n                this.elements.micSelect.value = microphones[0].deviceId;\n            }\n            \n            this.elements.micSelect.disabled = false;\n            this._log(`✅ 找到 ${microphones.length} 個麥克風裝置`, 'success');\n        } catch (error) {\n            this._log(`❌ 列舉麥克風失敗: ${error.message}`, 'error');\n            console.error('列舉麥克風詳細錯誤:', error);\n            this.elements.micSelect.innerHTML = '<option>需要麥克風權限</option>';\n            this.elements.micSelect.disabled = true;\n        }\n    }\n    \n    /**\n     * 重新整理輸出裝置列表\n     * @private\n     */\n    async _refreshOutputDevices() {\n        if (!this.deviceManager) {\n            this._log('❌ DeviceManager 尚未初始化', 'error');\n            this.elements.outputSelect.innerHTML = '<option value=\"default\">系統預設輸出</option>';\n            this.elements.outputSelect.disabled = true;\n            return;\n        }\n        \n        if (!this.deviceManager.isSupported()) {\n            this.elements.outputSelect.innerHTML = '<option value=\"default\">系統預設輸出</option>';\n            this.elements.outputSelect.disabled = true;\n            this._log('ℹ️ 此瀏覽器不支援輸出裝置切換', 'info');\n            return;\n        }\n        \n        try {\n            this._log('🔍 正在列舉輸出裝置...', 'info');\n            const outputs = await this.deviceManager.enumerateOutputDevices();\n            \n            this.elements.outputSelect.innerHTML = '<option value=\"default\">系統預設輸出</option>';\n            \n            if (outputs.length === 0) {\n                this.elements.outputSelect.disabled = true;\n                this._log('ℹ️ 未偵測到輸出裝置', 'info');\n                return;\n            }\n            \n            this.elements.outputSelect.disabled = false;\n            outputs.forEach((device, index) => {\n                const option = document.createElement('option');\n                option.value = device.deviceId;\n                option.textContent = device.label || `揚聲器 ${index + 1}`;\n                this.elements.outputSelect.appendChild(option);\n            });\n            \n            // 恢復上次選擇\n            const savedId = this.deviceManager.getSelectedOutputDeviceId();\n            if (savedId && savedId !== 'default') {\n                this.elements.outputSelect.value = savedId;\n            }\n            \n            this._log(`✅ 找到 ${outputs.length} 個輸出裝置`, 'success');\n        } catch (error) {\n            this._log(`❌ 列舉輸出裝置失敗: ${error.message}`, 'error');\n            console.error('列舉輸出裝置詳細錯誤:', error);\n        }\n    }\n    \n    /**\n     * 處理錄音按鈕點擊\n     * @private\n     */\n    async _handleRecord() {\n        try {\n            this._log('開始錄音...', 'info');\n            \n            await this.audioEngine.startRecording();\n            \n            this.elements.recordBtn.disabled = true;\n            this.elements.stopBtn.disabled = false;\n            \n            // 停用波形工具列\n            this.elements.zoomInBtn.disabled = true;\n            this.elements.zoomOutBtn.disabled = true;\n            this.elements.zoomResetBtn.disabled = true;\n            this.elements.panLeftBtn.disabled = true;\n            this.elements.panRightBtn.disabled = true;\n            \n            this._log('✓ 錄音已開始', 'success');\n        } catch (error) {\n            this._log(`❌ 錄音失敗: ${error.message}`, 'error');\n            console.error('Recording Error:', error);\n        }\n    }\n    \n    /**\n     * 處理停止按鈕點擊\n     * @private\n     */\n    async _handleStop() {\n        try {\n            this._log('停止錄音...', 'info');\n            \n            const blob = await this.audioEngine.stopRecording();\n            \n            this.elements.recordBtn.disabled = false;\n            this.elements.stopBtn.disabled = true;\n            this.elements.playBtn.disabled = false;\n            this.elements.downloadBtn.disabled = false;\n            \n            // 啟用波形工具列\n            this.elements.zoomInBtn.disabled = false;\n            this.elements.zoomOutBtn.disabled = false;\n            this.elements.zoomResetBtn.disabled = false;\n            this.elements.panLeftBtn.disabled = false;\n            this.elements.panRightBtn.disabled = false;\n            \n            this._log(`✓ 錄音已停止 - ${(blob.size / 1024).toFixed(2)} KB`, 'success');\n            \n            // 更新錄音資訊\n            this._updateRecordingInfo(blob);\n            \n            // 清理舊的音訊資源\n            if (this.audioPlayer) {\n                this.audioPlayer.pause();\n                this.audioPlayer.src = '';\n                this.audioPlayer = null;\n            }\n            if (this.recordedUrl) {\n                URL.revokeObjectURL(this.recordedUrl);\n            }\n            \n            // 保存新的 blob\n            this.recordedBlob = blob;\n            this.recordedUrl = URL.createObjectURL(blob);\n            \n        } catch (error) {\n            this._log(`❌ 停止失敗: ${error.message}`, 'error');\n            console.error('Stop Error:', error);\n        }\n    }\n    \n    /**\n     * 處理播放按鈕點擊\n     * @private\n     */\n    async _handlePlay() {\n        try {\n            if (!this.recordedUrl) {\n                this._log('❌ 沒有可播放的錄音', 'error');\n                return;\n            }\n            \n            this._log('播放錄音...', 'info');\n            \n            // 每次播放都重新創建音訊播放器\n            if (this.audioPlayer) {\n                this.audioPlayer.pause();\n                this.audioPlayer.src = '';\n                this.audioPlayer = null;\n            }\n            \n            this.audioPlayer = new Audio(this.recordedUrl);\n            \n            this.audioPlayer.addEventListener('ended', () => {\n                this.elements.playBtn.disabled = false;\n                this.elements.pauseBtn.disabled = true;\n                this._log('✓ 播放完成', 'info');\n            });\n            \n            // 設置輸出裝置\n            if (this.deviceManager) {\n                try {\n                    await this.deviceManager.setAudioOutputDevice(this.audioPlayer);\n                } catch (err) {\n                    console.warn('設置輸出裝置失敗:', err);\n                }\n            }\n            \n            await this.audioPlayer.play();\n            this.elements.playBtn.disabled = true;\n            this.elements.pauseBtn.disabled = false;\n            this._log('✓ 播放中', 'info');\n            \n        } catch (error) {\n            this._log(`❌ 播放失敗: ${error.message}`, 'error');\n            console.error('Play Error:', error);\n        }\n    }\n    \n    /**\n     * 處理暫停按鈕點擊\n     * @private\n     */\n    _handlePause() {\n        try {\n            if (!this.audioPlayer) {\n                this._log('❌ 沒有正在播放的音訊', 'error');\n                return;\n            }\n            \n            this._log('暫停播放...', 'info');\n            this.audioPlayer.pause();\n            this.elements.playBtn.disabled = false;\n            this.elements.pauseBtn.disabled = true;\n            this._log('✓ 已暫停', 'info');\n            \n        } catch (error) {\n            this._log(`❌ 暫停失敗: ${error.message}`, 'error');\n            console.error('Pause Error:', error);\n        }\n    }\n    \n    /**\n     * 處理下載按鈕點擊\n     * @private\n     */\n    _handleDownload() {\n        try {\n            if (!this.recordedBlob) {\n                this._log('❌ 沒有可下載的錄音', 'error');\n                return;\n            }\n            \n            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);\n            const filename = `voicebank-recording-${timestamp}.wav`;\n            \n            const a = document.createElement('a');\n            a.href = this.recordedUrl;\n            a.download = filename;\n            a.click();\n            \n            this._log(`💾 已下載: ${filename}`, 'success');\n            \n        } catch (error) {\n            this._log(`❌ 下載失敗: ${error.message}`, 'error');\n            console.error('Download Error:', error);\n        }\n    }\n    \n    /**\n     * 處理放大按鈕點擊\n     * @private\n     */\n    _handleZoomIn() {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            this.waveformRenderer.accumulatedWaveform.zoomBySteps(1, 0.5);\n            this._log('🔍 放大波形', 'info');\n        }\n    }\n    \n    /**\n     * 處理縮小按鈕點擊\n     * @private\n     */\n    _handleZoomOut() {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            this.waveformRenderer.accumulatedWaveform.zoomBySteps(-1, 0.5);\n            this._log('🔍 縮小波形', 'info');\n        }\n    }\n    \n    /**\n     * 處理重置視圖按鈕點擊\n     * @private\n     */\n    _handleZoomReset() {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            this.waveformRenderer.accumulatedWaveform.setZoom(1);\n            this.waveformRenderer.accumulatedWaveform.isAutoScroll = true;\n            this.elements.autoScrollCheck.checked = true;\n            this._log('🔄 重置視圖', 'info');\n        }\n    }\n    \n    /**\n     * 處理向左平移按鈕點擊\n     * @private\n     */\n    _handlePanLeft() {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            const info = this.waveformRenderer.accumulatedWaveform.getVisibleSamples();\n            this.waveformRenderer.accumulatedWaveform.panBySamples(-Math.floor(info.visible * 0.2));\n            this._log('◀ 向左移動', 'info');\n        }\n    }\n    \n    /**\n     * 處理向右平移按鈕點擊\n     * @private\n     */\n    _handlePanRight() {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            const info = this.waveformRenderer.accumulatedWaveform.getVisibleSamples();\n            this.waveformRenderer.accumulatedWaveform.panBySamples(Math.floor(info.visible * 0.2));\n            this._log('▶ 向右移動', 'info');\n        }\n    }\n    \n    /**\n     * 處理自動捲動開關改變\n     * @private\n     */\n    _handleAutoScrollChange(e) {\n        if (this.waveformRenderer && this.waveformRenderer.accumulatedWaveform) {\n            this.waveformRenderer.accumulatedWaveform.isAutoScroll = e.target.checked;\n            this._log(e.target.checked ? '✓ 啟用自動捲動' : '✗ 停用自動捲動', 'info');\n        }\n    }\n    \n    /**\n     * 處理麥克風選擇改變\n     * @private\n     */\n    _handleMicChange(e) {\n        const deviceId = e.target.value;\n        const deviceLabel = e.target.options[e.target.selectedIndex].text;\n        \n        this.deviceManager.selectMicrophone(deviceId, true);\n        this._log(`🎤 已選擇麥克風: ${deviceLabel}`, 'info');\n    }\n    \n    /**\n     * 處理輸出裝置選擇改變\n     * @private\n     */\n    _handleOutputChange(e) {\n        const deviceId = e.target.value;\n        const deviceLabel = e.target.options[e.target.selectedIndex].text;\n        \n        this.deviceManager.selectOutputDevice(deviceId, true);\n        this._log(`🔊 已選擇輸出裝置: ${deviceLabel}`, 'info');\n    }\n    \n    /**\n     * 處理麥克風增益改變\n     * @private\n     */\n    _handleGainChange(e) {\n        const gain = parseFloat(e.target.value);\n        this.elements.gainValue.textContent = gain.toFixed(1) + 'x';\n        \n        if (this.audioEngine && this.audioEngine.setMicGain) {\n            this.audioEngine.setMicGain(gain);\n            this._log(`🎚️ 增益調整為 ${gain.toFixed(1)}x`, 'info');\n        }\n    }\n    \n    /**\n     * 處理 AGC 開關改變\n     * @private\n     */\n    _handleAGCChange(e) {\n        this._log(`AGC ${e.target.checked ? '已啟用' : '已停用'}（將在下次錄音時生效）`, 'info');\n        // Note: 需要重新開始錄音才會生效\n    }\n    \n    /**\n     * 處理回音消除開關改變\n     * @private\n     */\n    _handleEchoCancelChange(e) {\n        this._log(`回音消除 ${e.target.checked ? '已啟用' : '已停用'}（將在下次錄音時生效）`, 'info');\n        // Note: 需要重新開始錄音才會生效\n    }\n    \n    /**\n     * 處理背景降噪開關改變\n     * @private\n     */\n    _handleNoiseSuppressChange(e) {\n        this._log(`背景降噪 ${e.target.checked ? '已啟用' : '已停用'}（將在下次錄音時生效）`, 'info');\n        // Note: 需要重新開始錄音才會生效\n    }\n    \n    /**\n     * 更新錄音資訊\n     * @private\n     */\n    _updateRecordingInfo(blob) {\n        const duration = (this.audioEngine.recordStopTime - this.audioEngine.recordStartTime) / 1000;\n        const samples = this.audioEngine.pcmTotalSamples || 0;\n        const sampleRate = this.audioEngine.audioContext.sampleRate;\n        \n        this.elements.durationInfo.textContent = this._formatDuration(duration);\n        this.elements.samplesInfo.textContent = samples.toLocaleString();\n        this.elements.samplerateInfo.textContent = sampleRate.toLocaleString();\n        this.elements.filesizeInfo.textContent = (blob.size / 1024).toFixed(2);\n        \n        this.elements.recordingInfo.style.display = 'block';\n    }\n    \n    /**\n     * 格式化時長\n     * @private\n     */\n    _formatDuration(seconds) {\n        const mins = Math.floor(seconds / 60);\n        const secs = Math.floor(seconds % 60);\n        const ms = Math.floor((seconds % 1) * 1000);\n        return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}.${String(ms).padStart(3, '0')}`;\n    }\n    \n    /**\n     * 獲取當前時間字串\n     * @private\n     */\n    _getTimeString() {\n        const now = new Date();\n        return `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;\n    }\n    \n    /**\n     * 記錄日誌\n     * @private\n     */\n    _log(message, type = 'info') {\n        if (!this.options.showStatusLog || !this.elements.statusLog) return;\n        \n        const entry = document.createElement('div');\n        entry.className = 'vbr-log-entry';\n        \n        const time = document.createElement('span');\n        time.className = 'vbr-log-time';\n        time.textContent = `[${this._getTimeString()}]`;\n        \n        const text = document.createElement('span');\n        text.className = `vbr-log-text vbr-log-${type}`;\n        text.textContent = message;\n        \n        entry.appendChild(time);\n        entry.appendChild(text);\n        \n        this.elements.statusLog.appendChild(entry);\n        this.elements.statusLog.scrollTop = this.elements.statusLog.scrollHeight;\n    }\n    \n    /**\n     * 銷毀 UI 和所有資源\n     */\n    destroy() {\n        // 停止錄音\n        if (this.audioEngine && this.audioEngine.isRecording) {\n            this.audioEngine.stopRecording();\n        }\n        \n        // 停止播放\n        if (this.audioPlayer) {\n            this.audioPlayer.pause();\n            this.audioPlayer.src = '';\n            this.audioPlayer = null;\n        }\n        \n        // 釋放 blob URL\n        if (this.recordedUrl) {\n            URL.revokeObjectURL(this.recordedUrl);\n            this.recordedUrl = null;\n        }\n        \n        // 銷毀波形渲染器\n        if (this.waveformRenderer) {\n            this.waveformRenderer.destroy();\n            this.waveformRenderer = null;\n        }\n        \n        // 銷毀音訊引擎\n        if (this.audioEngine) {\n            this.audioEngine.destroy();\n            this.audioEngine = null;\n        }\n        \n        // 清空 UI\n        this.container.innerHTML = '';\n        \n        this.isInitialized = false;\n        this._log('VoiceBank Recorder UI 已銷毀', 'info');\n    }\n}\n","/**\n * StorageAdapter - 儲存適配器基類\n * 定義統一的儲存介面，支援多種儲存後端\n */\n\nexport class StorageAdapter {\n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob 物件\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID 或 URL\n   */\n  async save(blob, filename, metadata = {}) {\n    throw new Error('save() must be implemented by subclass');\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<Blob>} 音訊 Blob 物件\n   */\n  async load(id) {\n    throw new Error('load() must be implemented by subclass');\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>} 是否成功刪除\n   */\n  async delete(id) {\n    throw new Error('delete() must be implemented by subclass');\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>} 檔案列表\n   */\n  async list() {\n    throw new Error('list() must be implemented by subclass');\n  }\n  \n  /**\n   * 檢查檔案是否存在\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>}\n   */\n  async exists(id) {\n    try {\n      await this.load(id);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n  \n  /**\n   * 清空所有檔案（謹慎使用）\n   * @returns {Promise<number>} 刪除的檔案數量\n   */\n  async clear() {\n    const files = await this.list();\n    let count = 0;\n    \n    for (const file of files) {\n      try {\n        await this.delete(file.id || file.filename);\n        count++;\n      } catch (error) {\n        console.error('Failed to delete file:', file, error);\n      }\n    }\n    \n    return count;\n  }\n}\n\nexport default StorageAdapter;\n","/**\n * IndexedDBAdapter - IndexedDB 儲存實現\n * 用於瀏覽器端本地儲存，無需伺服器\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class IndexedDBAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} dbName - 資料庫名稱\n   * @param {string} storeName - 儲存區名稱\n   * @param {number} version - 資料庫版本\n   */\n  constructor(dbName = 'VoiceBankDB', storeName = 'recordings', version = 1) {\n    super();\n    this.dbName = dbName;\n    this.storeName = storeName;\n    this.version = version;\n    this.db = null;\n  }\n  \n  /**\n   * 初始化資料庫\n   * @returns {Promise<IDBDatabase>}\n   */\n  async initialize() {\n    if (this.db) {\n      return this.db;\n    }\n    \n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.version);\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to open IndexedDB: ${request.error}`));\n      };\n      \n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(this.db);\n      };\n      \n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        \n        // 創建物件儲存區（如果不存在）\n        if (!db.objectStoreNames.contains(this.storeName)) {\n          const store = db.createObjectStore(this.storeName, { \n            keyPath: 'id', \n            autoIncrement: true \n          });\n          \n          // 創建索引\n          store.createIndex('filename', 'filename', { unique: false });\n          store.createIndex('timestamp', 'timestamp', { unique: false });\n          store.createIndex('duration', 'duration', { unique: false });\n        }\n      };\n    });\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      const record = {\n        filename: filename,\n        blob: blob,\n        size: blob.size,\n        type: blob.type,\n        timestamp: Date.now(),\n        metadata: metadata\n      };\n      \n      const request = store.add(record);\n      \n      request.onsuccess = () => {\n        resolve(String(request.result));\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to save recording: ${request.error}`));\n      };\n      \n      transaction.onerror = () => {\n        reject(new Error(`Transaction failed: ${transaction.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async load(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.get(Number(id));\n      \n      request.onsuccess = () => {\n        const record = request.result;\n        if (record && record.blob) {\n          resolve(record.blob);\n        } else {\n          reject(new Error(`Recording not found: ${id}`));\n        }\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to load recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async delete(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.delete(Number(id));\n      \n      request.onsuccess = () => {\n        resolve(true);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to delete recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.getAll();\n      \n      request.onsuccess = () => {\n        const records = request.result.map(record => ({\n          id: String(record.id),\n          filename: record.filename,\n          size: record.size,\n          type: record.type,\n          timestamp: record.timestamp,\n          date: new Date(record.timestamp),\n          metadata: record.metadata || {}\n        }));\n        resolve(records);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to list recordings: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 根據檔名搜尋\n   * @param {string} filename - 檔案名稱（支援部分匹配）\n   * @returns {Promise<Array>}\n   */\n  async searchByFilename(filename) {\n    const allRecords = await this.list();\n    return allRecords.filter(record => \n      record.filename.toLowerCase().includes(filename.toLowerCase())\n    );\n  }\n  \n  /**\n   * 取得儲存空間使用情況\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const records = await this.list();\n    const totalSize = records.reduce((sum, record) => sum + record.size, 0);\n    \n    return {\n      count: records.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      records: records\n    };\n  }\n  \n  /**\n   * 清空所有錄音\n   * @returns {Promise<number>} 刪除的數量\n   */\n  async clear() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      // 先取得數量\n      const countRequest = store.count();\n      \n      countRequest.onsuccess = () => {\n        const count = countRequest.result;\n        \n        // 清空儲存區\n        const clearRequest = store.clear();\n        \n        clearRequest.onsuccess = () => {\n          resolve(count);\n        };\n        \n        clearRequest.onerror = () => {\n          reject(new Error(`Failed to clear recordings: ${clearRequest.error}`));\n        };\n      };\n      \n      countRequest.onerror = () => {\n        reject(new Error(`Failed to count recordings: ${countRequest.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 取得瀏覽器儲存空間配額資訊（如果可用）\n   * @returns {Promise<Object|null>}\n   */\n  async getStorageEstimate() {\n    if ('storage' in navigator && 'estimate' in navigator.storage) {\n      try {\n        const estimate = await navigator.storage.estimate();\n        return {\n          usage: estimate.usage,\n          quota: estimate.quota,\n          usageMB: (estimate.usage / (1024 * 1024)).toFixed(2),\n          quotaMB: (estimate.quota / (1024 * 1024)).toFixed(2),\n          usagePercent: ((estimate.usage / estimate.quota) * 100).toFixed(2)\n        };\n      } catch (error) {\n        console.warn('Failed to get storage estimate:', error);\n        return null;\n      }\n    }\n    return null;\n  }\n  \n  /**\n   * 關閉資料庫連接\n   */\n  close() {\n    if (this.db) {\n      this.db.close();\n      this.db = null;\n    }\n  }\n}\n\nexport default IndexedDBAdapter;\n","/**\n * ServerAdapter - 伺服器儲存適配器\n * 支援 PHP/Node.js 等後端儲存方案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ServerAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {Object} config - 配置選項\n   * @param {string} config.baseURL - 基礎 URL\n   * @param {string} config.saveEndpoint - 上傳端點\n   * @param {string} config.loadEndpoint - 下載端點\n   * @param {string} config.deleteEndpoint - 刪除端點\n   * @param {string} config.listEndpoint - 列表端點（可選）\n   */\n  constructor(config = {}) {\n    super();\n    this.baseURL = config.baseURL || '';\n    this.saveEndpoint = config.saveEndpoint || '/backend/save.php';\n    this.loadEndpoint = config.loadEndpoint || '/public/uploads/';\n    this.deleteEndpoint = config.deleteEndpoint || '/backend/delete.php';\n    this.listEndpoint = config.listEndpoint || '/api/recordings';\n    this.headers = config.headers || {};\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    const formData = new FormData();\n    formData.append('audio-blob', blob);\n    formData.append('audio-filename', filename);\n    \n    if (metadata && Object.keys(metadata).length > 0) {\n      formData.append('metadata', JSON.stringify(metadata));\n    }\n    \n    try {\n      const response = await fetch(this.baseURL + this.saveEndpoint, {\n        method: 'POST',\n        body: formData,\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Upload failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      \n      // 檢查 PHP 端點的回應（通常是 'success'）\n      if (result.toLowerCase().includes('success')) {\n        return filename;\n      } else {\n        throw new Error(`Server error: ${result}`);\n      }\n    } catch (error) {\n      console.error('Save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    try {\n      const url = this.baseURL + this.loadEndpoint + filename;\n      const response = await fetch(url, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Load failed: ${response.status} ${response.statusText}`);\n      }\n      \n      return await response.blob();\n    } catch (error) {\n      console.error('Load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    try {\n      const response = await fetch(this.baseURL + this.deleteEndpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...this.headers\n        },\n        body: JSON.stringify({ filename })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Delete failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      return result.toLowerCase().includes('success');\n    } catch (error) {\n      console.error('Delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    try {\n      const response = await fetch(this.baseURL + this.listEndpoint, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`List failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      return Array.isArray(data) ? data : [];\n    } catch (error) {\n      console.error('List error:', error);\n      // 如果後端不支援 list 操作，返回空陣列\n      return [];\n    }\n  }\n  \n  /**\n   * 使用 XMLHttpRequest 上傳（帶進度回調）\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @param {Function} onProgress - 進度回調 (percent)\n   * @returns {Promise<string>}\n   */\n  async saveWithProgress(blob, filename, metadata = {}, onProgress = null) {\n    return new Promise((resolve, reject) => {\n      const formData = new FormData();\n      formData.append('audio-blob', blob);\n      formData.append('audio-filename', filename);\n      \n      if (metadata && Object.keys(metadata).length > 0) {\n        formData.append('metadata', JSON.stringify(metadata));\n      }\n      \n      const xhr = new XMLHttpRequest();\n      \n      // 進度事件\n      if (onProgress) {\n        xhr.upload.addEventListener('progress', (e) => {\n          if (e.lengthComputable) {\n            const percent = (e.loaded / e.total) * 100;\n            onProgress(percent);\n          }\n        });\n      }\n      \n      // 完成事件\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const result = xhr.responseText;\n          if (result.toLowerCase().includes('success')) {\n            resolve(filename);\n          } else {\n            reject(new Error(`Server error: ${result}`));\n          }\n        } else {\n          reject(new Error(`Upload failed: ${xhr.status} ${xhr.statusText}`));\n        }\n      });\n      \n      // 錯誤事件\n      xhr.addEventListener('error', () => {\n        reject(new Error('Network error during upload'));\n      });\n      \n      // 取消事件\n      xhr.addEventListener('abort', () => {\n        reject(new Error('Upload cancelled'));\n      });\n      \n      // 發送請求\n      xhr.open('POST', this.baseURL + this.saveEndpoint);\n      \n      // 設定自定義 headers\n      Object.keys(this.headers).forEach(key => {\n        xhr.setRequestHeader(key, this.headers[key]);\n      });\n      \n      xhr.send(formData);\n    });\n  }\n}\n\nexport default ServerAdapter;\n","/**\n * ElectronAdapter - Electron 檔案系統儲存適配器\n * 使用 Electron 的 IPC 通訊與主進程進行檔案操作\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ElectronAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} savePath - 預設儲存路徑（相對於用戶文件目錄）\n   */\n  constructor(savePath = 'recordings') {\n    super();\n    this.savePath = savePath;\n    \n    // 檢查 Electron API 是否可用\n    if (typeof window === 'undefined' || !window.electronAPI) {\n      throw new Error('Electron API not available. Make sure preload script is properly configured.');\n    }\n    \n    this.electronAPI = window.electronAPI;\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案路徑\n   */\n  async save(blob, filename, metadata = {}) {\n    try {\n      // 將 Blob 轉換為 ArrayBuffer\n      const arrayBuffer = await blob.arrayBuffer();\n      \n      // 轉換為普通陣列（以便通過 IPC 傳遞）\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      // 呼叫 Electron API\n      const result = await this.electronAPI.saveRecording({\n        filename,\n        buffer,\n        metadata: {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        }\n      });\n      \n      if (result.success) {\n        return result.id || result.path;\n      } else {\n        throw new Error(result.error || 'Save failed');\n      }\n    } catch (error) {\n      console.error('Electron save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<Blob>}\n   */\n  async load(filePath) {\n    try {\n      // 從 Electron 讀取檔案\n      const buffer = await this.electronAPI.loadRecording(filePath);\n      \n      // 將 Buffer 轉換為 Blob\n      const uint8Array = new Uint8Array(buffer);\n      return new Blob([uint8Array], { type: 'audio/wav' });\n    } catch (error) {\n      console.error('Electron load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async delete(filePath) {\n    try {\n      const result = await this.electronAPI.deleteRecording(filePath);\n      return result.success;\n    } catch (error) {\n      console.error('Electron delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @param {string} directory - 目錄路徑（可選）\n   * @returns {Promise<Array>}\n   */\n  async list(directory = null) {\n    try {\n      const recordings = await this.electronAPI.listRecordings(directory);\n      return recordings || [];\n    } catch (error) {\n      console.error('Electron list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 開啟檔案選擇對話框\n   * @returns {Promise<string|null>} 選擇的檔案路徑\n   */\n  async openFile() {\n    try {\n      if (this.electronAPI.openFile) {\n        return await this.electronAPI.openFile();\n      }\n      throw new Error('openFile API not available');\n    } catch (error) {\n      console.error('Electron openFile error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 開啟另存為對話框\n   * @param {Blob} blob - 要儲存的 Blob\n   * @param {string} defaultFilename - 預設檔案名稱\n   * @returns {Promise<string|null>} 儲存的檔案路徑\n   */\n  async saveAs(blob, defaultFilename = 'recording.wav') {\n    try {\n      const arrayBuffer = await blob.arrayBuffer();\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      if (this.electronAPI.saveAs) {\n        const result = await this.electronAPI.saveAs({\n          filename: defaultFilename,\n          buffer\n        });\n        \n        return result.success ? result.path : null;\n      }\n      \n      // 如果沒有 saveAs API，使用預設的 save\n      return await this.save(blob, defaultFilename);\n    } catch (error) {\n      console.error('Electron saveAs error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 在檔案管理器中顯示檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async showInFolder(filePath) {\n    try {\n      if (this.electronAPI.showInFolder) {\n        await this.electronAPI.showInFolder(filePath);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Electron showInFolder error:', error);\n      return false;\n    }\n  }\n}\n\nexport default ElectronAdapter;\n","/**\n * CapacitorAdapter - Capacitor 檔案系統儲存適配器\n * 使用 Capacitor Filesystem Plugin 在移動裝置上儲存檔案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class CapacitorAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} directory - 儲存目錄名稱\n   */\n  constructor(directory = 'recordings') {\n    super();\n    this.directory = directory;\n    \n    // 檢查 Capacitor 是否可用\n    if (typeof window === 'undefined' || !window.Capacitor) {\n      throw new Error('Capacitor not available. Make sure Capacitor is properly initialized.');\n    }\n    \n    this.Capacitor = window.Capacitor;\n    this.initialized = false;\n  }\n  \n  /**\n   * 初始化（確保目錄存在）\n   * @returns {Promise<void>}\n   */\n  async initialize() {\n    if (this.initialized) return;\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 嘗試讀取目錄，如果不存在則創建\n      try {\n        await Filesystem.readdir({\n          path: this.directory,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 目錄不存在，創建它\n        await Filesystem.mkdir({\n          path: this.directory,\n          directory: Directory.Documents,\n          recursive: true\n        });\n      }\n      \n      this.initialized = true;\n    } catch (error) {\n      console.error('Capacitor initialization error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 轉換 Blob 為 base64\n      const base64Data = await this.blobToBase64(blob);\n      \n      // 儲存音訊檔案\n      await Filesystem.writeFile({\n        path: `${this.directory}/${filename}`,\n        data: base64Data,\n        directory: Directory.Documents\n      });\n      \n      // 儲存元數據\n      if (metadata && Object.keys(metadata).length > 0) {\n        const metadataWithDefaults = {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        };\n        \n        await Filesystem.writeFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          data: JSON.stringify(metadataWithDefaults),\n          directory: Directory.Documents,\n          encoding: 'utf8'\n        });\n      }\n      \n      return filename;\n    } catch (error) {\n      console.error('Capacitor save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 將 base64 轉換為 Blob\n      return this.base64ToBlob(result.data, 'audio/wav');\n    } catch (error) {\n      console.error('Capacitor load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 刪除音訊檔案\n      await Filesystem.deleteFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 嘗試刪除元數據（如果存在）\n      try {\n        await Filesystem.deleteFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 元數據可能不存在，忽略錯誤\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Capacitor delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readdir({\n        path: this.directory,\n        directory: Directory.Documents\n      });\n      \n      // 過濾掉元數據檔案，只保留音訊檔案\n      const audioFiles = result.files.filter(f => !f.endsWith('.meta.json'));\n      \n      // 為每個檔案載入元數據\n      const recordings = await Promise.all(\n        audioFiles.map(async (filename) => {\n          let metadata = {};\n          \n          try {\n            const metaResult = await Filesystem.readFile({\n              path: `${this.directory}/${filename}.meta.json`,\n              directory: Directory.Documents,\n              encoding: 'utf8'\n            });\n            metadata = JSON.parse(metaResult.data);\n          } catch (e) {\n            // 沒有元數據\n          }\n          \n          return {\n            id: filename,\n            filename: filename,\n            metadata: metadata,\n            timestamp: metadata.timestamp || 0,\n            date: metadata.timestamp ? new Date(metadata.timestamp) : null,\n            size: metadata.size || 0,\n            type: metadata.type || 'audio/wav'\n          };\n        })\n      );\n      \n      // 按時間排序（最新的在前）\n      recordings.sort((a, b) => b.timestamp - a.timestamp);\n      \n      return recordings;\n    } catch (error) {\n      console.error('Capacitor list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 取得檔案的 URI（用於播放）\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<string>} 檔案 URI\n   */\n  async getUri(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.getUri({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      return result.uri;\n    } catch (error) {\n      console.error('Capacitor getUri error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * Blob 轉 base64\n   * @param {Blob} blob\n   * @returns {Promise<string>}\n   */\n  blobToBase64(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // 移除 data:audio/wav;base64, 前綴\n        const base64 = reader.result.split(',')[1];\n        resolve(base64);\n      };\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n  \n  /**\n   * base64 轉 Blob\n   * @param {string} base64\n   * @param {string} mimeType\n   * @returns {Blob}\n   */\n  base64ToBlob(base64, mimeType = 'audio/wav') {\n    const byteCharacters = atob(base64);\n    const byteNumbers = new Array(byteCharacters.length);\n    \n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    \n    const byteArray = new Uint8Array(byteNumbers);\n    return new Blob([byteArray], { type: mimeType });\n  }\n  \n  /**\n   * 取得儲存空間資訊\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const recordings = await this.list();\n    const totalSize = recordings.reduce((sum, r) => sum + (r.size || 0), 0);\n    \n    return {\n      count: recordings.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      recordings: recordings\n    };\n  }\n}\n\nexport default CapacitorAdapter;\n","/**\n * Storage Module - 儲存模組統一入口\n * 匯出所有儲存適配器\n */\n\nexport { StorageAdapter } from './StorageAdapter.js';\nexport { IndexedDBAdapter } from './IndexedDBAdapter.js';\nexport { ServerAdapter } from './ServerAdapter.js';\nexport { ElectronAdapter } from './ElectronAdapter.js';\nexport { CapacitorAdapter } from './CapacitorAdapter.js';\n\n/**\n * StorageFactory - 儲存適配器工廠\n * 根據配置自動創建適當的儲存適配器\n */\nexport class StorageFactory {\n  /**\n   * 創建儲存適配器\n   * @param {Object} config - 配置選項\n   * @param {string} config.type - 儲存類型 ('browser'|'electron'|'capacitor'|'server'|'auto')\n   * @param {Object} config.options - 適配器特定選項\n   * @returns {StorageAdapter}\n   */\n  static create(config = {}) {\n    const type = config.type || 'auto';\n    const options = config.options || {};\n    \n    // 自動偵測\n    if (type === 'auto') {\n      return this.createAuto(options);\n    }\n    \n    // 根據類型創建\n    switch (type.toLowerCase()) {\n      case 'browser':\n      case 'indexeddb':\n        const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n        return new IndexedDBAdapter(\n          options.dbName,\n          options.storeName,\n          options.version\n        );\n      \n      case 'electron':\n        const { ElectronAdapter } = require('./ElectronAdapter.js');\n        return new ElectronAdapter(options.savePath);\n      \n      case 'capacitor':\n        const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n        return new CapacitorAdapter(options.directory);\n      \n      case 'server':\n      case 'php':\n      case 'nodejs':\n        const { ServerAdapter } = require('./ServerAdapter.js');\n        return new ServerAdapter(options);\n      \n      default:\n        throw new Error(`Unknown storage type: ${type}`);\n    }\n  }\n  \n  /**\n   * 自動創建適配器（根據環境）\n   * @param {Object} options - 選項\n   * @returns {StorageAdapter}\n   */\n  static createAuto(options = {}) {\n    // 檢查 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      const { ElectronAdapter } = require('./ElectronAdapter.js');\n      return new ElectronAdapter(options.savePath);\n    }\n    \n    // 檢查 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n      return new CapacitorAdapter(options.directory);\n    }\n    \n    // 預設使用 IndexedDB（瀏覽器）\n    const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n    return new IndexedDBAdapter(\n      options.dbName,\n      options.storeName,\n      options.version\n    );\n  }\n}\n\nexport default StorageFactory;\n","/**\n * PlatformDetector - 平台偵測工具\n * 自動偵測當前運行環境（Browser/Electron/Capacitor）\n */\n\nexport class PlatformDetector {\n  /**\n   * 偵測當前平台\n   * @returns {string} 'browser' | 'electron' | 'capacitor'\n   */\n  static detect() {\n    // 檢查是否為 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Electron（另一種方式）\n    if (typeof process !== 'undefined' && process.versions && process.versions.electron) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      return 'capacitor';\n    }\n    \n    // 預設為瀏覽器\n    return 'browser';\n  }\n  \n  /**\n   * 檢查是否為 Electron 環境\n   * @returns {boolean}\n   */\n  static isElectron() {\n    return this.detect() === 'electron';\n  }\n  \n  /**\n   * 檢查是否為 Capacitor 環境\n   * @returns {boolean}\n   */\n  static isCapacitor() {\n    return this.detect() === 'capacitor';\n  }\n  \n  /**\n   * 檢查是否為瀏覽器環境\n   * @returns {boolean}\n   */\n  static isBrowser() {\n    return this.detect() === 'browser';\n  }\n  \n  /**\n   * 檢查是否為移動裝置\n   * @returns {boolean}\n   */\n  static isMobile() {\n    if (typeof window === 'undefined' || !window.navigator) {\n      return false;\n    }\n    \n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      window.navigator.userAgent\n    );\n  }\n  \n  /**\n   * 檢查是否支援 AudioWorklet\n   * @returns {boolean}\n   */\n  static supportsAudioWorklet() {\n    if (typeof window === 'undefined' || !window.AudioContext) {\n      return false;\n    }\n    \n    const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n    return 'audioWorklet' in AudioContextClass.prototype;\n  }\n  \n  /**\n   * 檢查是否支援 OffscreenCanvas\n   * @returns {boolean}\n   */\n  static supportsOffscreenCanvas() {\n    return typeof OffscreenCanvas !== 'undefined';\n  }\n  \n  /**\n   * 取得平台資訊\n   * @returns {Object}\n   */\n  static getInfo() {\n    return {\n      platform: this.detect(),\n      isElectron: this.isElectron(),\n      isCapacitor: this.isCapacitor(),\n      isBrowser: this.isBrowser(),\n      isMobile: this.isMobile(),\n      supportsAudioWorklet: this.supportsAudioWorklet(),\n      supportsOffscreenCanvas: this.supportsOffscreenCanvas(),\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown'\n    };\n  }\n}\n\nexport default PlatformDetector;\n","/**\n * VoiceBank Recorder - 主入口點\n * 跨平台音訊錄音庫\n * \n * @version 1.0.0\n * @author VoiceBank Team\n * @license MIT\n */\n\n// 匯出核心模組\nexport { AudioEngine } from './core/AudioEngine.js';\nexport { WaveformRenderer } from './core/WaveformRenderer.js';\nexport { DeviceManager } from './core/DeviceManager.js';\n\n// 匯出 UI 模組\nexport { VoiceBankRecorderUI } from './ui/VoiceBankRecorderUI.js';\n\n// 匯出儲存模組\nexport {\n  StorageAdapter,\n  IndexedDBAdapter,\n  ServerAdapter,\n  ElectronAdapter,\n  CapacitorAdapter,\n  StorageFactory\n} from './storage/index.js';\n\n// 匯出工具模組\nexport { PlatformDetector } from './utils/PlatformDetector.js';\n\n/**\n * VoiceBankRecorder - 主類別\n * 提供統一的 API 介面\n */\nexport class VoiceBankRecorder {\n  /**\n   * 建構函數\n   * @param {Object} options - 配置選項\n   * @param {string|HTMLElement} options.container - 容器選擇器或元素\n   * @param {string} options.layout - 佈局模式 ('horizontal'|'vertical'|'auto')\n   * @param {string} options.theme - 主題 ('light'|'dark')\n   * @param {Object} options.audio - 音訊配置\n   * @param {Object} options.waveform - 波形配置\n   * @param {Object} options.storage - 儲存配置\n   * @param {Object} options.callbacks - 事件回調\n   */\n  constructor(options = {}) {\n    this.options = this.mergeOptions(options);\n    this.initialized = false;\n    \n    // 初始化儲存適配器\n    this.storage = this.createStorageAdapter(this.options.storage);\n    \n    // 狀態\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    // 如果提供了容器，初始化 UI\n    if (this.options.container) {\n      this.initializeUI();\n    }\n  }\n  \n  /**\n   * 合併配置選項\n   * @param {Object} options - 用戶選項\n   * @returns {Object} 合併後的選項\n   */\n  mergeOptions(options) {\n    const defaults = {\n      container: null,\n      layout: 'auto',\n      theme: 'light',\n      \n      audio: {\n        sampleRate: 48000,\n        channels: 1,\n        agc: false,\n        gain: 1.0\n      },\n      \n      waveform: {\n        showOverview: true,\n        showAccumulated: true,\n        showLive: true,\n        decimation: 10,\n        colors: {\n          waveform: '#1E88E5',\n          selection: '#4CAF50',\n          playback: '#FF0000'\n        }\n      },\n      \n      storage: {\n        type: 'auto'\n      },\n      \n      callbacks: {\n        onRecordStart: () => {},\n        onRecordStop: () => {},\n        onRecordPause: () => {},\n        onRecordResume: () => {},\n        onPlayStart: () => {},\n        onPlayStop: () => {},\n        onError: (error) => console.error('VoiceBankRecorder error:', error)\n      }\n    };\n    \n    // 深度合併\n    return this.deepMerge(defaults, options);\n  }\n  \n  /**\n   * 深度合併物件\n   * @param {Object} target - 目標物件\n   * @param {Object} source - 來源物件\n   * @returns {Object}\n   */\n  deepMerge(target, source) {\n    const result = { ...target };\n    \n    for (const key in source) {\n      if (source[key] instanceof Object && !Array.isArray(source[key])) {\n        result[key] = this.deepMerge(result[key] || {}, source[key]);\n      } else {\n        result[key] = source[key];\n      }\n    }\n    \n    return result;\n  }\n  \n  /**\n   * 創建儲存適配器\n   * @param {Object} storageConfig - 儲存配置\n   * @returns {StorageAdapter}\n   */\n  createStorageAdapter(storageConfig) {\n    const { StorageFactory } = require('./storage/index.js');\n    return StorageFactory.create({\n      type: storageConfig.type || 'auto',\n      options: storageConfig\n    });\n  }\n  \n  /**\n   * 初始化 UI\n   */\n  initializeUI() {\n    // TODO: 實作 UI 初始化\n    // 這將在後續階段實作\n    console.log('UI initialization - to be implemented');\n  }\n  \n  /**\n   * 開始錄音\n   * @returns {Promise<void>}\n   */\n  async startRecording() {\n    try {\n      if (this.isRecording) {\n        throw new Error('Already recording');\n      }\n      \n      // TODO: 實作錄音邏輯\n      this.isRecording = true;\n      this.options.callbacks.onRecordStart();\n      \n      console.log('Recording started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止錄音\n   * @returns {Promise<Blob>}\n   */\n  async stopRecording() {\n    try {\n      if (!this.isRecording) {\n        throw new Error('Not recording');\n      }\n      \n      // TODO: 實作停止錄音邏輯\n      this.isRecording = false;\n      \n      // 模擬返回 Blob（實際會從 AudioEngine 獲取）\n      this.currentBlob = null; // TODO: 實際的 Blob\n      \n      this.options.callbacks.onRecordStop(this.currentBlob);\n      \n      console.log('Recording stopped');\n      return this.currentBlob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 暫停錄音\n   * @returns {Promise<void>}\n   */\n  async pauseRecording() {\n    try {\n      if (!this.isRecording || this.isPaused) {\n        throw new Error('Cannot pause');\n      }\n      \n      this.isPaused = true;\n      this.options.callbacks.onRecordPause();\n      \n      console.log('Recording paused');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 恢復錄音\n   * @returns {Promise<void>}\n   */\n  async resumeRecording() {\n    try {\n      if (!this.isRecording || !this.isPaused) {\n        throw new Error('Cannot resume');\n      }\n      \n      this.isPaused = false;\n      this.options.callbacks.onRecordResume();\n      \n      console.log('Recording resumed');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 播放錄音\n   * @returns {Promise<void>}\n   */\n  async play() {\n    try {\n      // TODO: 實作播放邏輯\n      this.options.callbacks.onPlayStart();\n      \n      console.log('Playback started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止播放\n   * @returns {Promise<void>}\n   */\n  async stop() {\n    try {\n      // TODO: 實作停止播放邏輯\n      this.options.callbacks.onPlayStop();\n      \n      console.log('Playback stopped');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存錄音\n   * @param {Blob} blob - 音訊 Blob（可選，使用當前錄音）\n   * @param {string} filename - 檔案名稱（可選，自動生成）\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async saveRecording(blob = null, filename = null, metadata = {}) {\n    try {\n      const blobToSave = blob || this.currentBlob;\n      \n      if (!blobToSave) {\n        throw new Error('No recording to save');\n      }\n      \n      const filenameToUse = filename || `recording-${Date.now()}.wav`;\n      \n      const id = await this.storage.save(blobToSave, filenameToUse, metadata);\n      \n      console.log('Recording saved:', id);\n      return id;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async loadRecording(id) {\n    try {\n      const blob = await this.storage.load(id);\n      this.currentBlob = blob;\n      \n      console.log('Recording loaded:', id);\n      return blob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async deleteRecording(id) {\n    try {\n      const result = await this.storage.delete(id);\n      \n      console.log('Recording deleted:', id);\n      return result;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有錄音\n   * @returns {Promise<Array>}\n   */\n  async listRecordings() {\n    try {\n      const recordings = await this.storage.list();\n      \n      console.log('Recordings listed:', recordings.length);\n      return recordings;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 取得當前錄音 Blob\n   * @returns {Blob|null}\n   */\n  getCurrentBlob() {\n    return this.currentBlob;\n  }\n  \n  /**\n   * 銷毀實例\n   */\n  destroy() {\n    // TODO: 清理資源\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    if (this.storage && typeof this.storage.close === 'function') {\n      this.storage.close();\n    }\n    \n    console.log('VoiceBankRecorder destroyed');\n  }\n}\n\n// 預設導出\nexport default VoiceBankRecorder;\n\n/**\n * 版本資訊\n */\nexport const VERSION = '1.0.0';\n\n/**\n * 建置資訊\n */\nexport const BUILD_INFO = {\n  version: VERSION,\n  date: new Date().toISOString(),\n  name: 'VoiceBank Recorder'\n};\n"],"names":["DeviceManager","constructor","options","micStorageKey","outputStorageKey","autoLoadPreferences","autoRequestPermission","microphoneDevices","outputDevices","selectedMicDeviceId","selectedOutputDeviceId","_eventListeners","_deviceChangeListener","loadPreferences","console","log","savedMicId","localStorage","getItem","savedOutputId","error","warn","savePreference","type","deviceId","setItem","isSupported","navigator","mediaDevices","enumerateDevices","requestMicrophonePermission","getUserMedia","Error","stream","audio","getTracks","forEach","track","stop","message","enumerateMicrophones","requestPermission","devices","filter","device","kind","enumerateOutputDevices","enumerateAllDevices","microphones","outputs","Promise","all","selectMicrophone","save","_emit","selectOutputDevice","getSelectedMicrophoneId","getSelectedOutputDeviceId","getSelectedMicrophone","find","getSelectedOutputDevice","getMicrophoneConstraints","additionalConstraints","constraints","video","exact","setAudioOutputDevice","audioElement","targetDeviceId","setSinkId","isDeviceAvailable","some","startDeviceChangeMonitoring","addEventListener","stopDeviceChangeMonitoring","removeEventListener","on","event","callback","push","off","index","indexOf","splice","data","destroy","AudioEngine","config","sampleRate","autoGainControl","undefined","echoCancellation","noiseSuppression","micGain","workletPath","preferWorklet","autoManageDevices","deviceManager","_ownDeviceManager","audioContext","analyser","preGainNode","mediaDest","analyserSilencer","workletSupported","workletLoaded","pcmCollectorNode","usingWorklet","pcmChunks","pcmTotalSamples","recorder","_pcmCaptureInterval","micStream","isRecording","isPaused","isInitialized","recordStartTime","recordStopTime","recordWallStartMs","recordWallStopMs","latestBlob","latestUrl","initialize","AudioContextClass","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","createGain","gain","value","createMediaStreamDestination","connect","destination","audioWorklet","AudioWorkletNode","addModule","path","state","resume","stage","startRecording","_stopMicrophone","_captureMicrophone","URL","revokeObjectURL","Date","now","performance","useWorklet","_startWorkletRecording","_startRecordRTCRecording","timestamp","mode","stopRecording","blob","_stopWorkletRecording","_stopRecordRTCRecording","createObjectURL","duration","url","samples","pauseRecording","resumeRecording","getLatestRecording","getPcmWindow","start","count","length","total","Float32Array","end","Math","min","out","offset","passed","i","chunk","cLen","cStart","cEnd","segStart","max","segEnd","localStart","slice","subarray","set","getAnalyser","getAudioContext","microphoneStream","setMicGain","dispose","catch","_stopPcmCapture","close","handler","selectedId","JSON","stringify","_applyIOSMicGainAdjustment","source","createMediaStreamSource","usedDeviceId","audioTracks","getAudioTracks","actualDevice","label","name","ua","userAgent","isIOS","test","abs","port","onmessage","pcmData","totalSamples","disconnect","merged","wavBuffer","_buildWavFromFloat32Mono","Blob","resolve","reject","RecordRTC","recordStream","mimeType","recorderType","StereoAudioRecorder","numberOfAudioChannels","bufferSize","timeSlice","ondataavailable","_startPcmCapture","getBlob","bufferLength","dataArray","setInterval","getFloatTimeDomainData","pcmChunk","clearInterval","float32Data","numSamples","buffer","ArrayBuffer","view","DataView","_writeString","setUint32","setUint16","sample","int16","setInt16","string","setUint8","charCodeAt","err","WaveformRenderer","workerPath","useWorker","showClipMarks","audioEngine","liveWaveform","vuMeter","accumulatedWaveform","overviewWaveform","isVerticalMode","_overviewUpdateScheduled","_setupAudioEngineListeners","stopLive","appendPCM","liveCanvas","vuMeterCanvas","accumulatedCanvas","overviewCanvas","analyserNode","LiveWaveform","VUMeter","AccumulatedWaveform","OverviewWaveform","startLive","append","requestAnimationFrame","draw","reset","clear","canvasContext","clearRect","width","height","setVerticalMode","isVertical","_worker","postMessage","verticalMode","resize","canvas","terminate","getContext","mediaStreamSource","animationId","isRunning","amplification","_lastDataArray","_verticalScrollOffset","hasAudioContext","hasAnalyser","self","contextReady","then","e","Uint8Array","cancelAnimationFrame","getByteTimeDomainData","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","sliceWidth","x","v","y","moveTo","lineTo","stroke","scrollSpeed","sliceHeight","ctx","timeData","levelDb","peakDb","holdPeakDb","lastPeakTime","peakHoldMillis","fallRateDbPerSec","minDb","maxDb","lastClipTime","clipHoldMillis","_lastLogTime","_computeLevels","rmsDb","required","sumSquares","peak","clipped","absV","rms","sqrt","log10","Infinity","currentDb","w","h","grd","createLinearGradient","addColorStop","norm","barGrad","barWidth","round","db","posNorm","xPos","toString","font","textAlign","textBaseline","fillText","restore","minus10Norm","minus10X","holdNorm","holdX","displayRms","toFixed","displayPeak","txt","badgeW","badgeH","update","levels","elapsed","fallSeconds","fallAmount","loop","targetSampleRate","sourceSampleRate","decimationFactor","sampleMin","sampleMax","sampleCount","zoomFactor","viewStart","isAutoScroll","_panRemainder","playbackPosition","isPlaying","playbackStartTime","playbackStartSample","rawZoomMode","rawViewStart","rawVisibleRaw","_useWorker","_appendBatchMin","_appendBatchMax","_appendFlushScheduled","lastDetail","lastDensity","transferControlToOffscreen","Worker","ev","msg","detail","density","_setupMouseInteraction","isDragging","dragStartX","dragStartViewStart","offsetX","style","cursor","deltaX","info","getVisibleSamples","samplesPerPixel","visible","sampleDelta","_enforceViewBounds","preventDefault","rect","getBoundingClientRect","clientX","left","anchorRatio","zoomSteps","deltaY","zoomBySteps","clickRatio","clickedSample","floor","CustomEvent","time","dispatchEvent","audioSamples","factor","appendedMin","appendedMax","_lastAppendLog","blockSum","blockCount","j","blockMean","blockMin","blockMax","k","centeredSample","scrollToLatest","flush","_flushAppendBatch","setTimeout","minArr","maxArr","centerY","lineJoin","lineCap","hasFirstPoint","minVis","_getMinVisibleSamples","maxStart","setZoom","targetZoom","anchorSample","maxZoom","oldInfo","newInfo","oldRatio","desiredStart","oldCenter","stepCount","zoomStep","newZoom","pow","panBySamples","panByPixels","pixelDelta","totalDelta","intDelta","resetView","setSourceSampleRate","_getSamplePair","setPlaybackPosition","sampleIndex","setRawZoomMode","enabled","startPlayback","startSample","sr","updatePosition","rawSamples","decimatedPos","stopPlayback","_updatePlaybackPosition","_workerRef","_warnedNoData","_lastTotal","dragClickedSample","dragVisibleSamples","acc","viewStartX","offsetInView","targetViewStartX","newViewStart","maxViewStart","clampedViewStart","_handleSeek","clickX","targetSample","currentZoom","visibleSamples","halfVisible","hasAcc","visibleStart","visibleEnd","canvasWidth","canvasHeight","yMin","yMax","viewEndX","viewWidth","strokeRect","VoiceBankRecorderUI","showAdvancedOptions","showStatusLog","theme","primaryColor","secondaryColor","successColor","errorColor","warningColor","container","document","querySelector","waveformRenderer","elements","audioPlayer","recordedBlob","recordedUrl","_generateHTML","_injectStyles","_cacheElements","_initializeAudioEngine","_initializeWaveformRenderer","_bindEvents","_initializeDevices","_log","innerHTML","_getTimeString","styleId","getElementById","createElement","id","textContent","_getStyles","head","appendChild","root","recordBtn","stopBtn","playBtn","pauseBtn","downloadBtn","zoomInBtn","zoomOutBtn","zoomResetBtn","panLeftBtn","panRightBtn","autoScrollCheck","vuCanvas","micSelect","outputSelect","refreshMicBtn","refreshOutputBtn","gainSlider","gainValue","agcCheck","echoCancelCheck","noiseSuppressCheck","recordingInfo","durationInfo","samplesInfo","samplerateInfo","filesizeInfo","statusLog","audioConfig","waveformConfig","_handleRecord","_handleStop","_handlePlay","_handlePause","_handleDownload","_handleZoomIn","_handleZoomOut","_handleZoomReset","_handlePanLeft","_handlePanRight","_handleAutoScrollChange","_handleMicChange","_handleOutputChange","_refreshMicrophones","_refreshOutputDevices","_handleGainChange","_handleAGCChange","_handleEchoCancelChange","_handleNoiseSuppressChange","disabled","option","savedId","size","_updateRecordingInfo","pause","src","Audio","play","toISOString","replace","filename","a","href","download","click","checked","target","deviceLabel","selectedIndex","text","parseFloat","_formatDuration","toLocaleString","display","seconds","mins","secs","ms","String","padStart","getHours","getMinutes","getSeconds","entry","className","scrollTop","scrollHeight","StorageAdapter","metadata","load","delete","list","exists","files","file","IndexedDBAdapter","dbName","storeName","version","request","indexedDB","open","onerror","onsuccess","result","onupgradeneeded","objectStoreNames","contains","store","createObjectStore","keyPath","autoIncrement","createIndex","unique","transaction","objectStore","record","add","get","Number","getAll","records","map","date","searchByFilename","allRecords","toLowerCase","includes","getStorageInfo","totalSize","reduce","sum","totalSizeMB","countRequest","clearRequest","getStorageEstimate","storage","estimate","usage","quota","usageMB","quotaMB","usagePercent","ServerAdapter","baseURL","saveEndpoint","loadEndpoint","deleteEndpoint","listEndpoint","headers","formData","FormData","Object","keys","response","fetch","method","body","ok","status","statusText","json","Array","isArray","saveWithProgress","onProgress","xhr","XMLHttpRequest","upload","lengthComputable","percent","loaded","responseText","key","setRequestHeader","send","ElectronAdapter","savePath","electronAPI","arrayBuffer","from","saveRecording","success","filePath","loadRecording","uint8Array","deleteRecording","directory","recordings","listRecordings","openFile","saveAs","defaultFilename","showInFolder","CapacitorAdapter","Capacitor","initialized","Filesystem","Directory","Plugins","readdir","Documents","mkdir","recursive","base64Data","blobToBase64","writeFile","metadataWithDefaults","encoding","readFile","base64ToBlob","deleteFile","audioFiles","f","endsWith","metaResult","parse","sort","b","getUri","uri","reader","FileReader","onloadend","base64","split","readAsDataURL","byteCharacters","atob","byteNumbers","byteArray","r","StorageFactory","create","createAuto","require","PlatformDetector","detect","process","versions","electron","isElectron","isCapacitor","isBrowser","isMobile","supportsAudioWorklet","prototype","supportsOffscreenCanvas","OffscreenCanvas","getInfo","platform","VoiceBankRecorder","mergeOptions","createStorageAdapter","currentBlob","initializeUI","defaults","layout","channels","agc","waveform","showOverview","showAccumulated","showLive","decimation","colors","selection","playback","callbacks","onRecordStart","onRecordStop","onRecordPause","onRecordResume","onPlayStart","onPlayStop","onError","deepMerge","storageConfig","blobToSave","filenameToUse","getCurrentBlob","VERSION","BUILD_INFO"],"mappings":"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Aa,EAAE;IACpBrG,MAAAA,OAAO,CAACO,IAAI,CAAC,yCAAyC,CAAC;IACvD,MAAA;IACJ,IAAA;;IAEA;QACA,IAAI,CAACmhB,aAAa,EAAE;QACpB,IAAI,CAACC,aAAa,EAAE;QACpB,IAAI,CAACC,cAAc,EAAE;;IAErB;IACA,IAAA,MAAM,IAAI,CAACC,sBAAsB,EAAE;;IAEnC;IACA,IAAA,MAAM,IAAI,CAACC,2BAA2B,EAAE;;IAExC;QACA,IAAI,CAACC,WAAW,EAAE;;IAElB;IACA,IAAA,MAAM,IAAI,CAACC,kBAAkB,EAAE;QAE/B,IAAI,CAAC3b,aAAa,GAAG,IAAI;IACzB,IAAA,IAAI,CAAC4b,IAAI,CAAC,+BAA+B,EAAE,SAAS,CAAC;IACzD,EAAA;;IAEA;IACJ;IACA;IACA;IACIP,EAAAA,aAAaA,GAAG;IACZ,IAAA,IAAI,CAACR,SAAS,CAACgB,SAAS,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAA,EAAsB,IAAI,CAAC9iB,OAAO,CAACshB,mBAAmB,GAAG;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAA,CAAqB,GAAG,EAAE;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAA,EAAkB,IAAI,CAACthB,OAAO,CAACuhB,aAAa,GAAG;AAC/C;AACA;AACA,oDAAA,EAAsD,IAAI,CAACwB,cAAc,EAAE,CAAA;AAC3E;AACA;AACA;AACA,gBAAA,CAAiB,GAAG,EAAE;AACtB;AACA,QAAA,CAAS;IACL,EAAA;;IAEA;IACJ;IACA;IACA;IACIR,EAAAA,aAAaA,GAAG;QACZ,MAAMS,OAAO,GAAG,8BAA8B;IAC9C,IAAA,IAAIjB,QAAQ,CAACkB,cAAc,CAACD,OAAO,CAAC,EAAE;IAEtC,IAAA,MAAM1I,KAAK,GAAGyH,QAAQ,CAACmB,aAAa,CAAC,OAAO,CAAC;QAC7C5I,KAAK,CAAC6I,EAAE,GAAGH,OAAO;IAClB1I,IAAAA,KAAK,CAAC8I,WAAW,GAAG,IAAI,CAACC,UAAU,EAAE;IACrCtB,IAAAA,QAAQ,CAACuB,IAAI,CAACC,WAAW,CAACjJ,KAAK,CAAC;IACpC,EAAA;;IAEA;IACJ;IACA;IACA;IACA;IACI+I,EAAAA,UAAUA,GAAG;IACT,IAAA,MAAM7B,KAAK,GAAG,IAAI,CAACxhB,OAAO,CAACwhB,KAAK;QAEhC,OAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAAA,EAA8BA,KAAK,CAACI,UAAU,CAAA;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAAA,EAA8BJ,KAAK,CAACC,YAAY,CAAA;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAAA,EAA8BD,KAAK,CAACK,YAAY,CAAA;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAAA,EAA8BL,KAAK,CAACC,YAAY,CAAA;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAAA,EAAgCD,KAAK,CAACC,YAAY,CAAA;AAClD,uBAAA,EAAyBD,KAAK,CAACC,YAAY,CAAA;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAA,EAAyBD,KAAK,CAACC,YAAY,CAAA;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAAA,EAA8BD,KAAK,CAACC,YAAY,CAAA;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAA,EAAyCD,KAAK,CAACC,YAAY,CAAA;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAA,EAAyBD,KAAK,CAACC,YAAY,CAAA;AAC3C;AACA;AACA;AAC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"}