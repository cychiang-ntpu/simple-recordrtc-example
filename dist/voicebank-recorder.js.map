{"version":3,"file":"voicebank-recorder.js","sources":["../src/core/AudioEngine.js","../src/storage/StorageAdapter.js","../src/storage/IndexedDBAdapter.js","../src/storage/ServerAdapter.js","../src/storage/ElectronAdapter.js","../src/storage/CapacitorAdapter.js","../src/storage/index.js","../src/utils/PlatformDetector.js","../src/index.js"],"sourcesContent":["/**\n * AudioEngine - 跨平台音訊錄音引擎\n * \n * 功能：\n * - 封裝 Web Audio API (AudioContext, AudioWorklet)\n * - 支援 RecordRTC 錄音 (WAV 格式)\n * - 自動處理 AudioWorklet 與 ScriptProcessor fallback\n * - 提供錄音控制 (開始/停止/暫停/繼續)\n * - 事件驅動架構 (recording-start, data-available, recording-stop 等)\n * - 麥克風輸入管理與前級增益控制\n * \n * @example\n * const engine = new AudioEngine({\n *   sampleRate: 48000,\n *   autoGainControl: false,\n *   micGain: 1.0\n * });\n * \n * engine.on('recording-start', () => console.log('Started'));\n * engine.on('data-available', (pcmData) => console.log('PCM chunk', pcmData));\n * engine.on('recording-stop', (blob) => console.log('Finished', blob));\n * \n * await engine.initialize();\n * await engine.startRecording();\n * // ... 錄音中 ...\n * await engine.stopRecording();\n */\n\nexport class AudioEngine {\n    /**\n     * 創建 AudioEngine 實例\n     * @param {Object} options - 配置選項\n     * @param {number} [options.sampleRate=48000] - 採樣率\n     * @param {boolean} [options.autoGainControl=false] - 自動增益控制\n     * @param {boolean} [options.echoCancellation=false] - 回音消除\n     * @param {boolean} [options.noiseSuppression=false] - 噪音抑制\n     * @param {number} [options.micGain=1.0] - 前級增益 (1.0-6.0)\n     * @param {string} [options.deviceId] - 麥克風設備 ID\n     * @param {string} [options.workletPath='assets/js/worklet/pcm-collector.js'] - AudioWorklet 模組路徑\n     * @param {boolean} [options.preferWorklet=true] - 優先使用 AudioWorklet（支援時）\n     */\n    constructor(options = {}) {\n        // 配置選項\n        this.config = {\n            sampleRate: options.sampleRate || 48000,\n            autoGainControl: options.autoGainControl !== undefined ? options.autoGainControl : false,\n            echoCancellation: options.echoCancellation !== undefined ? options.echoCancellation : false,\n            noiseSuppression: options.noiseSuppression !== undefined ? options.noiseSuppression : false,\n            micGain: options.micGain || 1.0,\n            deviceId: options.deviceId || null,\n            workletPath: options.workletPath || 'assets/js/worklet/pcm-collector.js',\n            preferWorklet: options.preferWorklet !== undefined ? options.preferWorklet : true\n        };\n\n        // Web Audio API 物件\n        this.audioContext = null;\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n\n        // AudioWorklet 相關\n        this.workletSupported = false;\n        this.workletLoaded = false;\n        this.pcmCollectorNode = null;\n        this.usingWorklet = false;\n\n        // PCM 數據收集 (AudioWorklet 模式)\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        // RecordRTC 錄音器\n        this.recorder = null;\n\n        // 麥克風串流\n        this.micStream = null;\n\n        // 錄音狀態\n        this.isRecording = false;\n        this.isPaused = false;\n        this.isInitialized = false;\n\n        // 時間戳記\n        this.recordStartTime = 0;\n        this.recordStopTime = 0;\n        this.recordWallStartMs = 0;\n        this.recordWallStopMs = 0;\n\n        // 最後的錄音結果\n        this.latestBlob = null;\n        this.latestUrl = null;\n\n        // 事件監聽器\n        this._eventListeners = {};\n    }\n\n    /**\n     * 初始化音訊引擎\n     * 創建 AudioContext、Analyser、Gain 節點等\n     * @returns {Promise<void>}\n     */\n    async initialize() {\n        if (this.isInitialized) {\n            return;\n        }\n\n        try {\n            // 創建 AudioContext\n            const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n            this.audioContext = new AudioContextClass({ sampleRate: this.config.sampleRate });\n\n            // 創建分析器節點\n            this.analyser = this.audioContext.createAnalyser();\n            this.analyser.fftSize = 256;\n\n            // 創建前級增益節點\n            this.preGainNode = this.audioContext.createGain();\n            this.preGainNode.gain.value = this.config.micGain;\n\n            // 創建 MediaStreamDestination（供 RecordRTC 使用）\n            this.mediaDest = this.audioContext.createMediaStreamDestination();\n\n            // 連接節點：preGain -> analyser -> silencer -> destination\n            this.preGainNode.connect(this.analyser);\n            this.preGainNode.connect(this.mediaDest);\n\n            // 創建靜音節點（避免回授）\n            this.analyserSilencer = this.audioContext.createGain();\n            this.analyserSilencer.gain.value = 0;\n            this.analyser.connect(this.analyserSilencer);\n            this.analyserSilencer.connect(this.audioContext.destination);\n\n            // 檢測 AudioWorklet 支援\n            this.workletSupported = !!(\n                this.audioContext.audioWorklet && \n                window.AudioWorkletNode\n            );\n\n            // 載入 AudioWorklet 模組（如果支援且偏好使用）\n            if (this.workletSupported && this.config.preferWorklet) {\n                try {\n                    await this.audioContext.audioWorklet.addModule(this.config.workletPath);\n                    this.workletLoaded = true;\n                    this._emit('worklet-loaded', { path: this.config.workletPath });\n                } catch (error) {\n                    console.warn('載入 AudioWorklet 模組失敗，將回退到 RecordRTC:', error);\n                    this.workletLoaded = false;\n                    this._emit('worklet-load-failed', { error });\n                }\n            }\n\n            // 恢復 AudioContext（如果暫停）\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            this.isInitialized = true;\n            this._emit('initialized', {\n                sampleRate: this.audioContext.sampleRate,\n                state: this.audioContext.state,\n                workletSupported: this.workletSupported,\n                workletLoaded: this.workletLoaded\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'initialize', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 開始錄音\n     * @returns {Promise<void>}\n     */\n    async startRecording() {\n        if (!this.isInitialized) {\n            throw new Error('AudioEngine 尚未初始化，請先調用 initialize()');\n        }\n\n        if (this.isRecording) {\n            throw new Error('已經在錄音中');\n        }\n\n        try {\n            // 確保 AudioContext 是活躍狀態\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            // 獲取麥克風\n            await this._captureMicrophone();\n\n            // 重置 PCM 數據收集\n            this.pcmChunks = [];\n            this.pcmTotalSamples = 0;\n\n            // 清理舊的錄音結果\n            if (this.latestUrl) {\n                URL.revokeObjectURL(this.latestUrl);\n                this.latestUrl = null;\n            }\n            this.latestBlob = null;\n\n            // 記錄開始時間\n            this.recordStartTime = Date.now();\n            this.recordWallStartMs = performance.now();\n            this.recordStopTime = 0;\n            this.recordWallStopMs = 0;\n\n            // 決定使用 AudioWorklet 或 RecordRTC\n            const useWorklet = this.workletLoaded && this.config.preferWorklet;\n\n            if (useWorklet) {\n                await this._startWorkletRecording();\n            } else {\n                await this._startRecordRTCRecording();\n            }\n\n            this.isRecording = true;\n            this.isPaused = false;\n\n            this._emit('recording-start', {\n                timestamp: this.recordStartTime,\n                mode: useWorklet ? 'worklet' : 'recordrtc',\n                sampleRate: this.audioContext.sampleRate\n            });\n\n        } catch (error) {\n            this._emit('error', { stage: 'start-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 停止錄音\n     * @returns {Promise<Blob>} 錄音的 Blob\n     */\n    async stopRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        try {\n            this.isRecording = false;\n            this.recordStopTime = Date.now();\n            this.recordWallStopMs = performance.now();\n\n            let blob;\n\n            if (this.usingWorklet) {\n                blob = await this._stopWorkletRecording();\n            } else if (this.recorder) {\n                blob = await this._stopRecordRTCRecording();\n            } else {\n                throw new Error('沒有可用的錄音器');\n            }\n\n            // 停止麥克風\n            this._stopMicrophone();\n\n            // 儲存結果\n            this.latestBlob = blob;\n            this.latestUrl = URL.createObjectURL(blob);\n\n            const duration = (this.recordStopTime - this.recordStartTime) / 1000;\n\n            this._emit('recording-stop', {\n                blob,\n                url: this.latestUrl,\n                duration,\n                samples: this.pcmTotalSamples,\n                sampleRate: this.audioContext.sampleRate\n            });\n\n            return blob;\n\n        } catch (error) {\n            this._emit('error', { stage: 'stop-recording', error });\n            throw error;\n        }\n    }\n\n    /**\n     * 暫停錄音（僅 RecordRTC 模式支援）\n     */\n    pauseRecording() {\n        if (!this.isRecording) {\n            throw new Error('目前沒有在錄音');\n        }\n\n        if (this.usingWorklet) {\n            throw new Error('AudioWorklet 模式不支援暫停功能');\n        }\n\n        if (this.recorder && typeof this.recorder.pauseRecording === 'function') {\n            this.recorder.pauseRecording();\n            this.isPaused = true;\n            this._emit('recording-paused', { timestamp: Date.now() });\n        } else {\n            throw new Error('暫停功能不可用');\n        }\n    }\n\n    /**\n     * 繼續錄音（僅 RecordRTC 模式支援）\n     */\n    resumeRecording() {\n        if (!this.isPaused) {\n            throw new Error('錄音沒有暫停');\n        }\n\n        if (this.recorder && typeof this.recorder.resumeRecording === 'function') {\n            this.recorder.resumeRecording();\n            this.isPaused = false;\n            this._emit('recording-resumed', { timestamp: Date.now() });\n        } else {\n            throw new Error('繼續錄音功能不可用');\n        }\n    }\n\n    /**\n     * 取得最新的錄音數據\n     * @returns {Object} { blob, url, duration, samples }\n     */\n    getLatestRecording() {\n        return {\n            blob: this.latestBlob,\n            url: this.latestUrl,\n            duration: this.latestBlob ? (this.recordStopTime - this.recordStartTime) / 1000 : 0,\n            samples: this.pcmTotalSamples,\n            sampleRate: this.audioContext ? this.audioContext.sampleRate : 0\n        };\n    }\n\n    /**\n     * 取得 PCM 數據視窗（僅 AudioWorklet 模式）\n     * @param {number} start - 起始樣本索引\n     * @param {number} count - 樣本數量\n     * @returns {Float32Array|null}\n     */\n    getPcmWindow(start, count) {\n        if (!this.usingWorklet || !this.pcmChunks.length) {\n            return null;\n        }\n\n        if (start < 0) start = 0;\n        const total = this.pcmTotalSamples;\n        if (start >= total) return new Float32Array(0);\n\n        const end = Math.min(total, start + count);\n        const out = new Float32Array(end - start);\n        let offset = 0;\n        let passed = 0;\n\n        for (let i = 0; i < this.pcmChunks.length && passed < end; i++) {\n            const chunk = this.pcmChunks[i];\n            if (!chunk || !chunk.length) continue;\n\n            const cLen = chunk.length;\n            const cStart = passed;\n            const cEnd = passed + cLen;\n\n            if (cEnd <= start) {\n                passed = cEnd;\n                continue;\n            }\n\n            const segStart = Math.max(start, cStart);\n            const segEnd = Math.min(end, cEnd);\n\n            if (segEnd > segStart) {\n                const localStart = segStart - cStart;\n                const slice = chunk.subarray(localStart, localStart + (segEnd - segStart));\n                out.set(slice, offset);\n                offset += slice.length;\n            }\n\n            passed = cEnd;\n            if (segEnd >= end) break;\n        }\n\n        return out;\n    }\n\n    /**\n     * 取得 Analyser 節點（供外部波形顯示使用）\n     * @returns {AnalyserNode|null}\n     */\n    getAnalyser() {\n        return this.analyser;\n    }\n\n    /**\n     * 取得 AudioContext\n     * @returns {AudioContext|null}\n     */\n    getAudioContext() {\n        return this.audioContext;\n    }\n\n    /**\n     * 設定前級增益\n     * @param {number} gain - 增益值 (1.0-6.0)\n     */\n    setMicGain(gain) {\n        gain = Math.max(1.0, Math.min(6.0, gain));\n        this.config.micGain = gain;\n\n        if (this.preGainNode) {\n            this.preGainNode.gain.value = gain;\n        }\n\n        this._emit('mic-gain-changed', { gain });\n    }\n\n    /**\n     * 釋放資源\n     */\n    dispose() {\n        if (this.isRecording) {\n            this.stopRecording().catch(console.error);\n        }\n\n        this._stopMicrophone();\n\n        if (this.latestUrl) {\n            URL.revokeObjectURL(this.latestUrl);\n            this.latestUrl = null;\n        }\n\n        if (this.audioContext) {\n            this.audioContext.close().catch(console.error);\n            this.audioContext = null;\n        }\n\n        this.analyser = null;\n        this.preGainNode = null;\n        this.mediaDest = null;\n        this.analyserSilencer = null;\n        this.pcmCollectorNode = null;\n        this.recorder = null;\n\n        this.pcmChunks = [];\n        this.pcmTotalSamples = 0;\n\n        this.isInitialized = false;\n\n        this._emit('disposed');\n    }\n\n    // ============================================================\n    // 事件系統\n    // ============================================================\n\n    /**\n     * 註冊事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    on(event, handler) {\n        if (!this._eventListeners[event]) {\n            this._eventListeners[event] = [];\n        }\n        this._eventListeners[event].push(handler);\n    }\n\n    /**\n     * 移除事件監聽器\n     * @param {string} event - 事件名稱\n     * @param {Function} handler - 處理函數\n     */\n    off(event, handler) {\n        if (!this._eventListeners[event]) return;\n\n        const index = this._eventListeners[event].indexOf(handler);\n        if (index > -1) {\n            this._eventListeners[event].splice(index, 1);\n        }\n    }\n\n    /**\n     * 觸發事件（內部使用）\n     * @private\n     */\n    _emit(event, data) {\n        if (!this._eventListeners[event]) return;\n\n        this._eventListeners[event].forEach(handler => {\n            try {\n                handler(data);\n            } catch (error) {\n                console.error(`事件處理器錯誤 [${event}]:`, error);\n            }\n        });\n    }\n\n    // ============================================================\n    // 私有方法 - 麥克風捕獲\n    // ============================================================\n\n    async _captureMicrophone() {\n        const constraints = {\n            audio: {\n                echoCancellation: this.config.echoCancellation,\n                noiseSuppression: this.config.noiseSuppression,\n                autoGainControl: this.config.autoGainControl\n            },\n            video: false\n        };\n\n        // 加入設備 ID 限制（如果有指定）\n        if (this.config.deviceId) {\n            constraints.audio.deviceId = { exact: this.config.deviceId };\n        }\n\n        try {\n            this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n            // iOS 自動增益調整\n            this._applyIOSMicGainAdjustment();\n\n            // 連接麥克風到前級增益節點\n            const source = this.audioContext.createMediaStreamSource(this.micStream);\n            source.connect(this.preGainNode);\n\n            this._emit('microphone-captured', {\n                deviceId: this.config.deviceId,\n                constraints\n            });\n\n        } catch (error) {\n            // 如果指定設備失敗，嘗試使用預設設備\n            if (error.name === 'OverconstrainedError' || error.name === 'NotFoundError') {\n                console.warn('指定的麥克風無法使用，嘗試預設設備');\n\n                delete constraints.audio.deviceId;\n                this.micStream = await navigator.mediaDevices.getUserMedia(constraints);\n\n                this._applyIOSMicGainAdjustment();\n\n                const source = this.audioContext.createMediaStreamSource(this.micStream);\n                source.connect(this.preGainNode);\n\n                this._emit('microphone-captured-fallback', { constraints });\n            } else {\n                throw error;\n            }\n        }\n    }\n\n    _stopMicrophone() {\n        if (this.micStream) {\n            this.micStream.getTracks().forEach(track => {\n                try {\n                    track.stop();\n                } catch (error) {\n                    console.warn('停止麥克風軌道失敗:', error);\n                }\n            });\n            this.micStream = null;\n        }\n    }\n\n    _applyIOSMicGainAdjustment() {\n        // iOS 上 AGC 關閉時音量偏低，自動提升增益\n        try {\n            const ua = navigator.userAgent || '';\n            const isIOS = /iphone|ipad|ipod/i.test(ua);\n\n            if (isIOS && !this.config.autoGainControl) {\n                if (Math.abs(this.config.micGain - 1.0) < 0.0001) {\n                    this.setMicGain(3.5);\n                    this._emit('ios-gain-adjusted', { gain: 3.5 });\n                }\n            }\n        } catch (error) {\n            console.warn('iOS 增益調整失敗:', error);\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - AudioWorklet 錄音\n    // ============================================================\n\n    async _startWorkletRecording() {\n        try {\n            // 創建 AudioWorkletNode\n            this.pcmCollectorNode = new AudioWorkletNode(\n                this.audioContext,\n                'pcm-collector-processor'\n            );\n\n            // 監聽 PCM 數據\n            this.pcmCollectorNode.port.onmessage = (event) => {\n                const { type, pcmData } = event.data;\n\n                if (type === 'pcm-data' && pcmData) {\n                    this.pcmChunks.push(new Float32Array(pcmData));\n                    this.pcmTotalSamples += pcmData.length;\n\n                    this._emit('data-available', {\n                        pcmData: new Float32Array(pcmData),\n                        totalSamples: this.pcmTotalSamples,\n                        mode: 'worklet'\n                    });\n                }\n            };\n\n            // 連接節點：preGain -> pcmCollector -> analyser\n            this.preGainNode.connect(this.pcmCollectorNode);\n            this.pcmCollectorNode.connect(this.audioContext.destination);\n\n            this.usingWorklet = true;\n\n        } catch (error) {\n            console.error('AudioWorklet 啟動失敗，回退到 RecordRTC:', error);\n            this.usingWorklet = false;\n            await this._startRecordRTCRecording();\n        }\n    }\n\n    async _stopWorkletRecording() {\n        try {\n            // 斷開 AudioWorkletNode\n            if (this.pcmCollectorNode) {\n                this.pcmCollectorNode.port.onmessage = null;\n                this.preGainNode.disconnect(this.pcmCollectorNode);\n                this.pcmCollectorNode.disconnect();\n                this.pcmCollectorNode = null;\n            }\n\n            // 合併 PCM 數據並轉換為 WAV\n            if (this.pcmChunks.length === 0) {\n                throw new Error('沒有錄音數據');\n            }\n\n            const merged = new Float32Array(this.pcmTotalSamples);\n            let offset = 0;\n\n            for (const chunk of this.pcmChunks) {\n                merged.set(chunk, offset);\n                offset += chunk.length;\n            }\n\n            // 轉換為 16-bit PCM WAV\n            const wavBuffer = this._buildWavFromFloat32Mono(\n                merged,\n                this.audioContext.sampleRate\n            );\n\n            const blob = new Blob([wavBuffer], { type: 'audio/wav' });\n\n            this.usingWorklet = false;\n\n            return blob;\n\n        } catch (error) {\n            console.error('AudioWorklet 停止失敗:', error);\n            throw error;\n        }\n    }\n\n    // ============================================================\n    // 私有方法 - RecordRTC 錄音\n    // ============================================================\n\n    async _startRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                // 檢查 RecordRTC 是否可用\n                if (typeof RecordRTC === 'undefined') {\n                    reject(new Error('RecordRTC 未載入'));\n                    return;\n                }\n\n                const recordStream = this.mediaDest.stream || this.micStream;\n\n                this.recorder = RecordRTC(recordStream, {\n                    type: 'audio',\n                    mimeType: 'audio/wav',\n                    recorderType: StereoAudioRecorder,\n                    numberOfAudioChannels: 1,\n                    bufferSize: 4096,\n                    timeSlice: 100,\n                    ondataavailable: (blob) => {\n                        this._emit('data-available', {\n                            blob,\n                            mode: 'recordrtc'\n                        });\n                    }\n                });\n\n                this.recorder.startRecording();\n                this.usingWorklet = false;\n\n                resolve();\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    async _stopRecordRTCRecording() {\n        return new Promise((resolve, reject) => {\n            try {\n                if (!this.recorder) {\n                    reject(new Error('RecordRTC 錄音器不存在'));\n                    return;\n                }\n\n                this.recorder.stopRecording(() => {\n                    try {\n                        const blob = this.recorder.getBlob();\n\n                        // 清理錄音器\n                        this.recorder = null;\n\n                        resolve(blob);\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    // ============================================================\n    // 私有方法 - WAV 格式轉換\n    // ============================================================\n\n    _buildWavFromFloat32Mono(float32Data, sampleRate) {\n        const numSamples = float32Data.length;\n        const buffer = new ArrayBuffer(44 + numSamples * 2);\n        const view = new DataView(buffer);\n\n        // WAV Header\n        this._writeString(view, 0, 'RIFF');\n        view.setUint32(4, 36 + numSamples * 2, true);\n        this._writeString(view, 8, 'WAVE');\n        this._writeString(view, 12, 'fmt ');\n        view.setUint32(16, 16, true); // fmt chunk size\n        view.setUint16(20, 1, true);  // audio format (PCM)\n        view.setUint16(22, 1, true);  // number of channels\n        view.setUint32(24, sampleRate, true);\n        view.setUint32(28, sampleRate * 2, true); // byte rate\n        view.setUint16(32, 2, true);  // block align\n        view.setUint16(34, 16, true); // bits per sample\n        this._writeString(view, 36, 'data');\n        view.setUint32(40, numSamples * 2, true);\n\n        // PCM Data (float32 -> int16)\n        let offset = 44;\n        for (let i = 0; i < numSamples; i++) {\n            const sample = Math.max(-1, Math.min(1, float32Data[i]));\n            const int16 = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;\n            view.setInt16(offset, int16, true);\n            offset += 2;\n        }\n\n        return buffer;\n    }\n\n    _writeString(view, offset, string) {\n        for (let i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n}\n\nexport default AudioEngine;\n","/**\n * StorageAdapter - 儲存適配器基類\n * 定義統一的儲存介面，支援多種儲存後端\n */\n\nexport class StorageAdapter {\n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob 物件\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID 或 URL\n   */\n  async save(blob, filename, metadata = {}) {\n    throw new Error('save() must be implemented by subclass');\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<Blob>} 音訊 Blob 物件\n   */\n  async load(id) {\n    throw new Error('load() must be implemented by subclass');\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>} 是否成功刪除\n   */\n  async delete(id) {\n    throw new Error('delete() must be implemented by subclass');\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>} 檔案列表\n   */\n  async list() {\n    throw new Error('list() must be implemented by subclass');\n  }\n  \n  /**\n   * 檢查檔案是否存在\n   * @param {string} id - 檔案 ID 或名稱\n   * @returns {Promise<boolean>}\n   */\n  async exists(id) {\n    try {\n      await this.load(id);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n  \n  /**\n   * 清空所有檔案（謹慎使用）\n   * @returns {Promise<number>} 刪除的檔案數量\n   */\n  async clear() {\n    const files = await this.list();\n    let count = 0;\n    \n    for (const file of files) {\n      try {\n        await this.delete(file.id || file.filename);\n        count++;\n      } catch (error) {\n        console.error('Failed to delete file:', file, error);\n      }\n    }\n    \n    return count;\n  }\n}\n\nexport default StorageAdapter;\n","/**\n * IndexedDBAdapter - IndexedDB 儲存實現\n * 用於瀏覽器端本地儲存，無需伺服器\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class IndexedDBAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} dbName - 資料庫名稱\n   * @param {string} storeName - 儲存區名稱\n   * @param {number} version - 資料庫版本\n   */\n  constructor(dbName = 'VoiceBankDB', storeName = 'recordings', version = 1) {\n    super();\n    this.dbName = dbName;\n    this.storeName = storeName;\n    this.version = version;\n    this.db = null;\n  }\n  \n  /**\n   * 初始化資料庫\n   * @returns {Promise<IDBDatabase>}\n   */\n  async initialize() {\n    if (this.db) {\n      return this.db;\n    }\n    \n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.version);\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to open IndexedDB: ${request.error}`));\n      };\n      \n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(this.db);\n      };\n      \n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        \n        // 創建物件儲存區（如果不存在）\n        if (!db.objectStoreNames.contains(this.storeName)) {\n          const store = db.createObjectStore(this.storeName, { \n            keyPath: 'id', \n            autoIncrement: true \n          });\n          \n          // 創建索引\n          store.createIndex('filename', 'filename', { unique: false });\n          store.createIndex('timestamp', 'timestamp', { unique: false });\n          store.createIndex('duration', 'duration', { unique: false });\n        }\n      };\n    });\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      const record = {\n        filename: filename,\n        blob: blob,\n        size: blob.size,\n        type: blob.type,\n        timestamp: Date.now(),\n        metadata: metadata\n      };\n      \n      const request = store.add(record);\n      \n      request.onsuccess = () => {\n        resolve(String(request.result));\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to save recording: ${request.error}`));\n      };\n      \n      transaction.onerror = () => {\n        reject(new Error(`Transaction failed: ${transaction.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async load(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.get(Number(id));\n      \n      request.onsuccess = () => {\n        const record = request.result;\n        if (record && record.blob) {\n          resolve(record.blob);\n        } else {\n          reject(new Error(`Recording not found: ${id}`));\n        }\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to load recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async delete(id) {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.delete(Number(id));\n      \n      request.onsuccess = () => {\n        resolve(true);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to delete recording: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.getAll();\n      \n      request.onsuccess = () => {\n        const records = request.result.map(record => ({\n          id: String(record.id),\n          filename: record.filename,\n          size: record.size,\n          type: record.type,\n          timestamp: record.timestamp,\n          date: new Date(record.timestamp),\n          metadata: record.metadata || {}\n        }));\n        resolve(records);\n      };\n      \n      request.onerror = () => {\n        reject(new Error(`Failed to list recordings: ${request.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 根據檔名搜尋\n   * @param {string} filename - 檔案名稱（支援部分匹配）\n   * @returns {Promise<Array>}\n   */\n  async searchByFilename(filename) {\n    const allRecords = await this.list();\n    return allRecords.filter(record => \n      record.filename.toLowerCase().includes(filename.toLowerCase())\n    );\n  }\n  \n  /**\n   * 取得儲存空間使用情況\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const records = await this.list();\n    const totalSize = records.reduce((sum, record) => sum + record.size, 0);\n    \n    return {\n      count: records.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      records: records\n    };\n  }\n  \n  /**\n   * 清空所有錄音\n   * @returns {Promise<number>} 刪除的數量\n   */\n  async clear() {\n    await this.initialize();\n    \n    return new Promise((resolve, reject) => {\n      const transaction = this.db.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      \n      // 先取得數量\n      const countRequest = store.count();\n      \n      countRequest.onsuccess = () => {\n        const count = countRequest.result;\n        \n        // 清空儲存區\n        const clearRequest = store.clear();\n        \n        clearRequest.onsuccess = () => {\n          resolve(count);\n        };\n        \n        clearRequest.onerror = () => {\n          reject(new Error(`Failed to clear recordings: ${clearRequest.error}`));\n        };\n      };\n      \n      countRequest.onerror = () => {\n        reject(new Error(`Failed to count recordings: ${countRequest.error}`));\n      };\n    });\n  }\n  \n  /**\n   * 取得瀏覽器儲存空間配額資訊（如果可用）\n   * @returns {Promise<Object|null>}\n   */\n  async getStorageEstimate() {\n    if ('storage' in navigator && 'estimate' in navigator.storage) {\n      try {\n        const estimate = await navigator.storage.estimate();\n        return {\n          usage: estimate.usage,\n          quota: estimate.quota,\n          usageMB: (estimate.usage / (1024 * 1024)).toFixed(2),\n          quotaMB: (estimate.quota / (1024 * 1024)).toFixed(2),\n          usagePercent: ((estimate.usage / estimate.quota) * 100).toFixed(2)\n        };\n      } catch (error) {\n        console.warn('Failed to get storage estimate:', error);\n        return null;\n      }\n    }\n    return null;\n  }\n  \n  /**\n   * 關閉資料庫連接\n   */\n  close() {\n    if (this.db) {\n      this.db.close();\n      this.db = null;\n    }\n  }\n}\n\nexport default IndexedDBAdapter;\n","/**\n * ServerAdapter - 伺服器儲存適配器\n * 支援 PHP/Node.js 等後端儲存方案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ServerAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {Object} config - 配置選項\n   * @param {string} config.baseURL - 基礎 URL\n   * @param {string} config.saveEndpoint - 上傳端點\n   * @param {string} config.loadEndpoint - 下載端點\n   * @param {string} config.deleteEndpoint - 刪除端點\n   * @param {string} config.listEndpoint - 列表端點（可選）\n   */\n  constructor(config = {}) {\n    super();\n    this.baseURL = config.baseURL || '';\n    this.saveEndpoint = config.saveEndpoint || '/backend/save.php';\n    this.loadEndpoint = config.loadEndpoint || '/public/uploads/';\n    this.deleteEndpoint = config.deleteEndpoint || '/backend/delete.php';\n    this.listEndpoint = config.listEndpoint || '/api/recordings';\n    this.headers = config.headers || {};\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    const formData = new FormData();\n    formData.append('audio-blob', blob);\n    formData.append('audio-filename', filename);\n    \n    if (metadata && Object.keys(metadata).length > 0) {\n      formData.append('metadata', JSON.stringify(metadata));\n    }\n    \n    try {\n      const response = await fetch(this.baseURL + this.saveEndpoint, {\n        method: 'POST',\n        body: formData,\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Upload failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      \n      // 檢查 PHP 端點的回應（通常是 'success'）\n      if (result.toLowerCase().includes('success')) {\n        return filename;\n      } else {\n        throw new Error(`Server error: ${result}`);\n      }\n    } catch (error) {\n      console.error('Save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    try {\n      const url = this.baseURL + this.loadEndpoint + filename;\n      const response = await fetch(url, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Load failed: ${response.status} ${response.statusText}`);\n      }\n      \n      return await response.blob();\n    } catch (error) {\n      console.error('Load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    try {\n      const response = await fetch(this.baseURL + this.deleteEndpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...this.headers\n        },\n        body: JSON.stringify({ filename })\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Delete failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const result = await response.text();\n      return result.toLowerCase().includes('success');\n    } catch (error) {\n      console.error('Delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    try {\n      const response = await fetch(this.baseURL + this.listEndpoint, {\n        headers: this.headers\n      });\n      \n      if (!response.ok) {\n        throw new Error(`List failed: ${response.status} ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      return Array.isArray(data) ? data : [];\n    } catch (error) {\n      console.error('List error:', error);\n      // 如果後端不支援 list 操作，返回空陣列\n      return [];\n    }\n  }\n  \n  /**\n   * 使用 XMLHttpRequest 上傳（帶進度回調）\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @param {Function} onProgress - 進度回調 (percent)\n   * @returns {Promise<string>}\n   */\n  async saveWithProgress(blob, filename, metadata = {}, onProgress = null) {\n    return new Promise((resolve, reject) => {\n      const formData = new FormData();\n      formData.append('audio-blob', blob);\n      formData.append('audio-filename', filename);\n      \n      if (metadata && Object.keys(metadata).length > 0) {\n        formData.append('metadata', JSON.stringify(metadata));\n      }\n      \n      const xhr = new XMLHttpRequest();\n      \n      // 進度事件\n      if (onProgress) {\n        xhr.upload.addEventListener('progress', (e) => {\n          if (e.lengthComputable) {\n            const percent = (e.loaded / e.total) * 100;\n            onProgress(percent);\n          }\n        });\n      }\n      \n      // 完成事件\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const result = xhr.responseText;\n          if (result.toLowerCase().includes('success')) {\n            resolve(filename);\n          } else {\n            reject(new Error(`Server error: ${result}`));\n          }\n        } else {\n          reject(new Error(`Upload failed: ${xhr.status} ${xhr.statusText}`));\n        }\n      });\n      \n      // 錯誤事件\n      xhr.addEventListener('error', () => {\n        reject(new Error('Network error during upload'));\n      });\n      \n      // 取消事件\n      xhr.addEventListener('abort', () => {\n        reject(new Error('Upload cancelled'));\n      });\n      \n      // 發送請求\n      xhr.open('POST', this.baseURL + this.saveEndpoint);\n      \n      // 設定自定義 headers\n      Object.keys(this.headers).forEach(key => {\n        xhr.setRequestHeader(key, this.headers[key]);\n      });\n      \n      xhr.send(formData);\n    });\n  }\n}\n\nexport default ServerAdapter;\n","/**\n * ElectronAdapter - Electron 檔案系統儲存適配器\n * 使用 Electron 的 IPC 通訊與主進程進行檔案操作\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class ElectronAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} savePath - 預設儲存路徑（相對於用戶文件目錄）\n   */\n  constructor(savePath = 'recordings') {\n    super();\n    this.savePath = savePath;\n    \n    // 檢查 Electron API 是否可用\n    if (typeof window === 'undefined' || !window.electronAPI) {\n      throw new Error('Electron API not available. Make sure preload script is properly configured.');\n    }\n    \n    this.electronAPI = window.electronAPI;\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案路徑\n   */\n  async save(blob, filename, metadata = {}) {\n    try {\n      // 將 Blob 轉換為 ArrayBuffer\n      const arrayBuffer = await blob.arrayBuffer();\n      \n      // 轉換為普通陣列（以便通過 IPC 傳遞）\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      // 呼叫 Electron API\n      const result = await this.electronAPI.saveRecording({\n        filename,\n        buffer,\n        metadata: {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        }\n      });\n      \n      if (result.success) {\n        return result.id || result.path;\n      } else {\n        throw new Error(result.error || 'Save failed');\n      }\n    } catch (error) {\n      console.error('Electron save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<Blob>}\n   */\n  async load(filePath) {\n    try {\n      // 從 Electron 讀取檔案\n      const buffer = await this.electronAPI.loadRecording(filePath);\n      \n      // 將 Buffer 轉換為 Blob\n      const uint8Array = new Uint8Array(buffer);\n      return new Blob([uint8Array], { type: 'audio/wav' });\n    } catch (error) {\n      console.error('Electron load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async delete(filePath) {\n    try {\n      const result = await this.electronAPI.deleteRecording(filePath);\n      return result.success;\n    } catch (error) {\n      console.error('Electron delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @param {string} directory - 目錄路徑（可選）\n   * @returns {Promise<Array>}\n   */\n  async list(directory = null) {\n    try {\n      const recordings = await this.electronAPI.listRecordings(directory);\n      return recordings || [];\n    } catch (error) {\n      console.error('Electron list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 開啟檔案選擇對話框\n   * @returns {Promise<string|null>} 選擇的檔案路徑\n   */\n  async openFile() {\n    try {\n      if (this.electronAPI.openFile) {\n        return await this.electronAPI.openFile();\n      }\n      throw new Error('openFile API not available');\n    } catch (error) {\n      console.error('Electron openFile error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 開啟另存為對話框\n   * @param {Blob} blob - 要儲存的 Blob\n   * @param {string} defaultFilename - 預設檔案名稱\n   * @returns {Promise<string|null>} 儲存的檔案路徑\n   */\n  async saveAs(blob, defaultFilename = 'recording.wav') {\n    try {\n      const arrayBuffer = await blob.arrayBuffer();\n      const buffer = Array.from(new Uint8Array(arrayBuffer));\n      \n      if (this.electronAPI.saveAs) {\n        const result = await this.electronAPI.saveAs({\n          filename: defaultFilename,\n          buffer\n        });\n        \n        return result.success ? result.path : null;\n      }\n      \n      // 如果沒有 saveAs API，使用預設的 save\n      return await this.save(blob, defaultFilename);\n    } catch (error) {\n      console.error('Electron saveAs error:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * 在檔案管理器中顯示檔案\n   * @param {string} filePath - 檔案路徑\n   * @returns {Promise<boolean>}\n   */\n  async showInFolder(filePath) {\n    try {\n      if (this.electronAPI.showInFolder) {\n        await this.electronAPI.showInFolder(filePath);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Electron showInFolder error:', error);\n      return false;\n    }\n  }\n}\n\nexport default ElectronAdapter;\n","/**\n * CapacitorAdapter - Capacitor 檔案系統儲存適配器\n * 使用 Capacitor Filesystem Plugin 在移動裝置上儲存檔案\n */\n\nimport { StorageAdapter } from './StorageAdapter.js';\n\nexport class CapacitorAdapter extends StorageAdapter {\n  /**\n   * 建構函數\n   * @param {string} directory - 儲存目錄名稱\n   */\n  constructor(directory = 'recordings') {\n    super();\n    this.directory = directory;\n    \n    // 檢查 Capacitor 是否可用\n    if (typeof window === 'undefined' || !window.Capacitor) {\n      throw new Error('Capacitor not available. Make sure Capacitor is properly initialized.');\n    }\n    \n    this.Capacitor = window.Capacitor;\n    this.initialized = false;\n  }\n  \n  /**\n   * 初始化（確保目錄存在）\n   * @returns {Promise<void>}\n   */\n  async initialize() {\n    if (this.initialized) return;\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 嘗試讀取目錄，如果不存在則創建\n      try {\n        await Filesystem.readdir({\n          path: this.directory,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 目錄不存在，創建它\n        await Filesystem.mkdir({\n          path: this.directory,\n          directory: Directory.Documents,\n          recursive: true\n        });\n      }\n      \n      this.initialized = true;\n    } catch (error) {\n      console.error('Capacitor initialization error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存音訊檔案\n   * @param {Blob} blob - 音訊 Blob\n   * @param {string} filename - 檔案名稱\n   * @param {Object} metadata - 元數據\n   * @returns {Promise<string>} 檔案名稱\n   */\n  async save(blob, filename, metadata = {}) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 轉換 Blob 為 base64\n      const base64Data = await this.blobToBase64(blob);\n      \n      // 儲存音訊檔案\n      await Filesystem.writeFile({\n        path: `${this.directory}/${filename}`,\n        data: base64Data,\n        directory: Directory.Documents\n      });\n      \n      // 儲存元數據\n      if (metadata && Object.keys(metadata).length > 0) {\n        const metadataWithDefaults = {\n          ...metadata,\n          size: blob.size,\n          type: blob.type,\n          timestamp: Date.now()\n        };\n        \n        await Filesystem.writeFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          data: JSON.stringify(metadataWithDefaults),\n          directory: Directory.Documents,\n          encoding: 'utf8'\n        });\n      }\n      \n      return filename;\n    } catch (error) {\n      console.error('Capacitor save error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<Blob>}\n   */\n  async load(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 將 base64 轉換為 Blob\n      return this.base64ToBlob(result.data, 'audio/wav');\n    } catch (error) {\n      console.error('Capacitor load error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除音訊檔案\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<boolean>}\n   */\n  async delete(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      // 刪除音訊檔案\n      await Filesystem.deleteFile({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      // 嘗試刪除元數據（如果存在）\n      try {\n        await Filesystem.deleteFile({\n          path: `${this.directory}/${filename}.meta.json`,\n          directory: Directory.Documents\n        });\n      } catch (e) {\n        // 元數據可能不存在，忽略錯誤\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Capacitor delete error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有檔案\n   * @returns {Promise<Array>}\n   */\n  async list() {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.readdir({\n        path: this.directory,\n        directory: Directory.Documents\n      });\n      \n      // 過濾掉元數據檔案，只保留音訊檔案\n      const audioFiles = result.files.filter(f => !f.endsWith('.meta.json'));\n      \n      // 為每個檔案載入元數據\n      const recordings = await Promise.all(\n        audioFiles.map(async (filename) => {\n          let metadata = {};\n          \n          try {\n            const metaResult = await Filesystem.readFile({\n              path: `${this.directory}/${filename}.meta.json`,\n              directory: Directory.Documents,\n              encoding: 'utf8'\n            });\n            metadata = JSON.parse(metaResult.data);\n          } catch (e) {\n            // 沒有元數據\n          }\n          \n          return {\n            id: filename,\n            filename: filename,\n            metadata: metadata,\n            timestamp: metadata.timestamp || 0,\n            date: metadata.timestamp ? new Date(metadata.timestamp) : null,\n            size: metadata.size || 0,\n            type: metadata.type || 'audio/wav'\n          };\n        })\n      );\n      \n      // 按時間排序（最新的在前）\n      recordings.sort((a, b) => b.timestamp - a.timestamp);\n      \n      return recordings;\n    } catch (error) {\n      console.error('Capacitor list error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   * 取得檔案的 URI（用於播放）\n   * @param {string} filename - 檔案名稱\n   * @returns {Promise<string>} 檔案 URI\n   */\n  async getUri(filename) {\n    await this.initialize();\n    \n    try {\n      const { Filesystem, Directory } = this.Capacitor.Plugins;\n      \n      const result = await Filesystem.getUri({\n        path: `${this.directory}/${filename}`,\n        directory: Directory.Documents\n      });\n      \n      return result.uri;\n    } catch (error) {\n      console.error('Capacitor getUri error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * Blob 轉 base64\n   * @param {Blob} blob\n   * @returns {Promise<string>}\n   */\n  blobToBase64(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // 移除 data:audio/wav;base64, 前綴\n        const base64 = reader.result.split(',')[1];\n        resolve(base64);\n      };\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n  \n  /**\n   * base64 轉 Blob\n   * @param {string} base64\n   * @param {string} mimeType\n   * @returns {Blob}\n   */\n  base64ToBlob(base64, mimeType = 'audio/wav') {\n    const byteCharacters = atob(base64);\n    const byteNumbers = new Array(byteCharacters.length);\n    \n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    \n    const byteArray = new Uint8Array(byteNumbers);\n    return new Blob([byteArray], { type: mimeType });\n  }\n  \n  /**\n   * 取得儲存空間資訊\n   * @returns {Promise<Object>}\n   */\n  async getStorageInfo() {\n    const recordings = await this.list();\n    const totalSize = recordings.reduce((sum, r) => sum + (r.size || 0), 0);\n    \n    return {\n      count: recordings.length,\n      totalSize: totalSize,\n      totalSizeMB: (totalSize / (1024 * 1024)).toFixed(2),\n      recordings: recordings\n    };\n  }\n}\n\nexport default CapacitorAdapter;\n","/**\n * Storage Module - 儲存模組統一入口\n * 匯出所有儲存適配器\n */\n\nexport { StorageAdapter } from './StorageAdapter.js';\nexport { IndexedDBAdapter } from './IndexedDBAdapter.js';\nexport { ServerAdapter } from './ServerAdapter.js';\nexport { ElectronAdapter } from './ElectronAdapter.js';\nexport { CapacitorAdapter } from './CapacitorAdapter.js';\n\n/**\n * StorageFactory - 儲存適配器工廠\n * 根據配置自動創建適當的儲存適配器\n */\nexport class StorageFactory {\n  /**\n   * 創建儲存適配器\n   * @param {Object} config - 配置選項\n   * @param {string} config.type - 儲存類型 ('browser'|'electron'|'capacitor'|'server'|'auto')\n   * @param {Object} config.options - 適配器特定選項\n   * @returns {StorageAdapter}\n   */\n  static create(config = {}) {\n    const type = config.type || 'auto';\n    const options = config.options || {};\n    \n    // 自動偵測\n    if (type === 'auto') {\n      return this.createAuto(options);\n    }\n    \n    // 根據類型創建\n    switch (type.toLowerCase()) {\n      case 'browser':\n      case 'indexeddb':\n        const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n        return new IndexedDBAdapter(\n          options.dbName,\n          options.storeName,\n          options.version\n        );\n      \n      case 'electron':\n        const { ElectronAdapter } = require('./ElectronAdapter.js');\n        return new ElectronAdapter(options.savePath);\n      \n      case 'capacitor':\n        const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n        return new CapacitorAdapter(options.directory);\n      \n      case 'server':\n      case 'php':\n      case 'nodejs':\n        const { ServerAdapter } = require('./ServerAdapter.js');\n        return new ServerAdapter(options);\n      \n      default:\n        throw new Error(`Unknown storage type: ${type}`);\n    }\n  }\n  \n  /**\n   * 自動創建適配器（根據環境）\n   * @param {Object} options - 選項\n   * @returns {StorageAdapter}\n   */\n  static createAuto(options = {}) {\n    // 檢查 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      const { ElectronAdapter } = require('./ElectronAdapter.js');\n      return new ElectronAdapter(options.savePath);\n    }\n    \n    // 檢查 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      const { CapacitorAdapter } = require('./CapacitorAdapter.js');\n      return new CapacitorAdapter(options.directory);\n    }\n    \n    // 預設使用 IndexedDB（瀏覽器）\n    const { IndexedDBAdapter } = require('./IndexedDBAdapter.js');\n    return new IndexedDBAdapter(\n      options.dbName,\n      options.storeName,\n      options.version\n    );\n  }\n}\n\nexport default StorageFactory;\n","/**\n * PlatformDetector - 平台偵測工具\n * 自動偵測當前運行環境（Browser/Electron/Capacitor）\n */\n\nexport class PlatformDetector {\n  /**\n   * 偵測當前平台\n   * @returns {string} 'browser' | 'electron' | 'capacitor'\n   */\n  static detect() {\n    // 檢查是否為 Electron\n    if (typeof window !== 'undefined' && window.electronAPI) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Electron（另一種方式）\n    if (typeof process !== 'undefined' && process.versions && process.versions.electron) {\n      return 'electron';\n    }\n    \n    // 檢查是否為 Capacitor\n    if (typeof window !== 'undefined' && window.Capacitor) {\n      return 'capacitor';\n    }\n    \n    // 預設為瀏覽器\n    return 'browser';\n  }\n  \n  /**\n   * 檢查是否為 Electron 環境\n   * @returns {boolean}\n   */\n  static isElectron() {\n    return this.detect() === 'electron';\n  }\n  \n  /**\n   * 檢查是否為 Capacitor 環境\n   * @returns {boolean}\n   */\n  static isCapacitor() {\n    return this.detect() === 'capacitor';\n  }\n  \n  /**\n   * 檢查是否為瀏覽器環境\n   * @returns {boolean}\n   */\n  static isBrowser() {\n    return this.detect() === 'browser';\n  }\n  \n  /**\n   * 檢查是否為移動裝置\n   * @returns {boolean}\n   */\n  static isMobile() {\n    if (typeof window === 'undefined' || !window.navigator) {\n      return false;\n    }\n    \n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      window.navigator.userAgent\n    );\n  }\n  \n  /**\n   * 檢查是否支援 AudioWorklet\n   * @returns {boolean}\n   */\n  static supportsAudioWorklet() {\n    if (typeof window === 'undefined' || !window.AudioContext) {\n      return false;\n    }\n    \n    const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n    return 'audioWorklet' in AudioContextClass.prototype;\n  }\n  \n  /**\n   * 檢查是否支援 OffscreenCanvas\n   * @returns {boolean}\n   */\n  static supportsOffscreenCanvas() {\n    return typeof OffscreenCanvas !== 'undefined';\n  }\n  \n  /**\n   * 取得平台資訊\n   * @returns {Object}\n   */\n  static getInfo() {\n    return {\n      platform: this.detect(),\n      isElectron: this.isElectron(),\n      isCapacitor: this.isCapacitor(),\n      isBrowser: this.isBrowser(),\n      isMobile: this.isMobile(),\n      supportsAudioWorklet: this.supportsAudioWorklet(),\n      supportsOffscreenCanvas: this.supportsOffscreenCanvas(),\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown'\n    };\n  }\n}\n\nexport default PlatformDetector;\n","/**\n * VoiceBank Recorder - 主入口點\n * 跨平台音訊錄音庫\n * \n * @version 1.0.0\n * @author VoiceBank Team\n * @license MIT\n */\n\n// 匯出核心模組\nexport { AudioEngine } from './core/AudioEngine.js';\n\n// 匯出儲存模組\nexport {\n  StorageAdapter,\n  IndexedDBAdapter,\n  ServerAdapter,\n  ElectronAdapter,\n  CapacitorAdapter,\n  StorageFactory\n} from './storage/index.js';\n\n// 匯出工具模組\nexport { PlatformDetector } from './utils/PlatformDetector.js';\n\n/**\n * VoiceBankRecorder - 主類別\n * 提供統一的 API 介面\n */\nexport class VoiceBankRecorder {\n  /**\n   * 建構函數\n   * @param {Object} options - 配置選項\n   * @param {string|HTMLElement} options.container - 容器選擇器或元素\n   * @param {string} options.layout - 佈局模式 ('horizontal'|'vertical'|'auto')\n   * @param {string} options.theme - 主題 ('light'|'dark')\n   * @param {Object} options.audio - 音訊配置\n   * @param {Object} options.waveform - 波形配置\n   * @param {Object} options.storage - 儲存配置\n   * @param {Object} options.callbacks - 事件回調\n   */\n  constructor(options = {}) {\n    this.options = this.mergeOptions(options);\n    this.initialized = false;\n    \n    // 初始化儲存適配器\n    this.storage = this.createStorageAdapter(this.options.storage);\n    \n    // 狀態\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    // 如果提供了容器，初始化 UI\n    if (this.options.container) {\n      this.initializeUI();\n    }\n  }\n  \n  /**\n   * 合併配置選項\n   * @param {Object} options - 用戶選項\n   * @returns {Object} 合併後的選項\n   */\n  mergeOptions(options) {\n    const defaults = {\n      container: null,\n      layout: 'auto',\n      theme: 'light',\n      \n      audio: {\n        sampleRate: 48000,\n        channels: 1,\n        agc: false,\n        gain: 1.0\n      },\n      \n      waveform: {\n        showOverview: true,\n        showAccumulated: true,\n        showLive: true,\n        decimation: 10,\n        colors: {\n          waveform: '#1E88E5',\n          selection: '#4CAF50',\n          playback: '#FF0000'\n        }\n      },\n      \n      storage: {\n        type: 'auto'\n      },\n      \n      callbacks: {\n        onRecordStart: () => {},\n        onRecordStop: () => {},\n        onRecordPause: () => {},\n        onRecordResume: () => {},\n        onPlayStart: () => {},\n        onPlayStop: () => {},\n        onError: (error) => console.error('VoiceBankRecorder error:', error)\n      }\n    };\n    \n    // 深度合併\n    return this.deepMerge(defaults, options);\n  }\n  \n  /**\n   * 深度合併物件\n   * @param {Object} target - 目標物件\n   * @param {Object} source - 來源物件\n   * @returns {Object}\n   */\n  deepMerge(target, source) {\n    const result = { ...target };\n    \n    for (const key in source) {\n      if (source[key] instanceof Object && !Array.isArray(source[key])) {\n        result[key] = this.deepMerge(result[key] || {}, source[key]);\n      } else {\n        result[key] = source[key];\n      }\n    }\n    \n    return result;\n  }\n  \n  /**\n   * 創建儲存適配器\n   * @param {Object} storageConfig - 儲存配置\n   * @returns {StorageAdapter}\n   */\n  createStorageAdapter(storageConfig) {\n    const { StorageFactory } = require('./storage/index.js');\n    return StorageFactory.create({\n      type: storageConfig.type || 'auto',\n      options: storageConfig\n    });\n  }\n  \n  /**\n   * 初始化 UI\n   */\n  initializeUI() {\n    // TODO: 實作 UI 初始化\n    // 這將在後續階段實作\n    console.log('UI initialization - to be implemented');\n  }\n  \n  /**\n   * 開始錄音\n   * @returns {Promise<void>}\n   */\n  async startRecording() {\n    try {\n      if (this.isRecording) {\n        throw new Error('Already recording');\n      }\n      \n      // TODO: 實作錄音邏輯\n      this.isRecording = true;\n      this.options.callbacks.onRecordStart();\n      \n      console.log('Recording started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止錄音\n   * @returns {Promise<Blob>}\n   */\n  async stopRecording() {\n    try {\n      if (!this.isRecording) {\n        throw new Error('Not recording');\n      }\n      \n      // TODO: 實作停止錄音邏輯\n      this.isRecording = false;\n      \n      // 模擬返回 Blob（實際會從 AudioEngine 獲取）\n      this.currentBlob = null; // TODO: 實際的 Blob\n      \n      this.options.callbacks.onRecordStop(this.currentBlob);\n      \n      console.log('Recording stopped');\n      return this.currentBlob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 暫停錄音\n   * @returns {Promise<void>}\n   */\n  async pauseRecording() {\n    try {\n      if (!this.isRecording || this.isPaused) {\n        throw new Error('Cannot pause');\n      }\n      \n      this.isPaused = true;\n      this.options.callbacks.onRecordPause();\n      \n      console.log('Recording paused');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 恢復錄音\n   * @returns {Promise<void>}\n   */\n  async resumeRecording() {\n    try {\n      if (!this.isRecording || !this.isPaused) {\n        throw new Error('Cannot resume');\n      }\n      \n      this.isPaused = false;\n      this.options.callbacks.onRecordResume();\n      \n      console.log('Recording resumed');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 播放錄音\n   * @returns {Promise<void>}\n   */\n  async play() {\n    try {\n      // TODO: 實作播放邏輯\n      this.options.callbacks.onPlayStart();\n      \n      console.log('Playback started');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 停止播放\n   * @returns {Promise<void>}\n   */\n  async stop() {\n    try {\n      // TODO: 實作停止播放邏輯\n      this.options.callbacks.onPlayStop();\n      \n      console.log('Playback stopped');\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 儲存錄音\n   * @param {Blob} blob - 音訊 Blob（可選，使用當前錄音）\n   * @param {string} filename - 檔案名稱（可選，自動生成）\n   * @param {Object} metadata - 元數據（可選）\n   * @returns {Promise<string>} 檔案 ID\n   */\n  async saveRecording(blob = null, filename = null, metadata = {}) {\n    try {\n      const blobToSave = blob || this.currentBlob;\n      \n      if (!blobToSave) {\n        throw new Error('No recording to save');\n      }\n      \n      const filenameToUse = filename || `recording-${Date.now()}.wav`;\n      \n      const id = await this.storage.save(blobToSave, filenameToUse, metadata);\n      \n      console.log('Recording saved:', id);\n      return id;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 載入錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<Blob>}\n   */\n  async loadRecording(id) {\n    try {\n      const blob = await this.storage.load(id);\n      this.currentBlob = blob;\n      \n      console.log('Recording loaded:', id);\n      return blob;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 刪除錄音\n   * @param {string} id - 檔案 ID\n   * @returns {Promise<boolean>}\n   */\n  async deleteRecording(id) {\n    try {\n      const result = await this.storage.delete(id);\n      \n      console.log('Recording deleted:', id);\n      return result;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 列出所有錄音\n   * @returns {Promise<Array>}\n   */\n  async listRecordings() {\n    try {\n      const recordings = await this.storage.list();\n      \n      console.log('Recordings listed:', recordings.length);\n      return recordings;\n    } catch (error) {\n      this.options.callbacks.onError(error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 取得當前錄音 Blob\n   * @returns {Blob|null}\n   */\n  getCurrentBlob() {\n    return this.currentBlob;\n  }\n  \n  /**\n   * 銷毀實例\n   */\n  destroy() {\n    // TODO: 清理資源\n    this.isRecording = false;\n    this.isPaused = false;\n    this.currentBlob = null;\n    \n    if (this.storage && typeof this.storage.close === 'function') {\n      this.storage.close();\n    }\n    \n    console.log('VoiceBankRecorder destroyed');\n  }\n}\n\n// 預設導出\nexport default VoiceBankRecorder;\n\n/**\n * 版本資訊\n */\nexport const VERSION = '1.0.0';\n\n/**\n * 建置資訊\n */\nexport const BUILD_INFO = {\n  version: VERSION,\n  date: new Date().toISOString(),\n  name: 'VoiceBank Recorder'\n};\n"],"names":["AudioEngine","constructor","options","config","sampleRate","autoGainControl","undefined","echoCancellation","noiseSuppression","micGain","deviceId","workletPath","preferWorklet","audioContext","analyser","preGainNode","mediaDest","analyserSilencer","workletSupported","workletLoaded","pcmCollectorNode","usingWorklet","pcmChunks","pcmTotalSamples","recorder","micStream","isRecording","isPaused","isInitialized","recordStartTime","recordStopTime","recordWallStartMs","recordWallStopMs","latestBlob","latestUrl","_eventListeners","initialize","AudioContextClass","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","createGain","gain","value","createMediaStreamDestination","connect","destination","audioWorklet","AudioWorkletNode","addModule","_emit","path","error","console","warn","state","resume","stage","startRecording","Error","_captureMicrophone","URL","revokeObjectURL","Date","now","performance","useWorklet","_startWorkletRecording","_startRecordRTCRecording","timestamp","mode","stopRecording","blob","_stopWorkletRecording","_stopRecordRTCRecording","_stopMicrophone","createObjectURL","duration","url","samples","pauseRecording","resumeRecording","getLatestRecording","getPcmWindow","start","count","length","total","Float32Array","end","Math","min","out","offset","passed","i","chunk","cLen","cStart","cEnd","segStart","max","segEnd","localStart","slice","subarray","set","getAnalyser","getAudioContext","setMicGain","dispose","catch","close","on","event","handler","push","off","index","indexOf","splice","data","forEach","constraints","audio","video","exact","navigator","mediaDevices","getUserMedia","_applyIOSMicGainAdjustment","source","createMediaStreamSource","name","getTracks","track","stop","ua","userAgent","isIOS","test","abs","port","onmessage","type","pcmData","totalSamples","disconnect","merged","wavBuffer","_buildWavFromFloat32Mono","Blob","Promise","resolve","reject","RecordRTC","recordStream","stream","mimeType","recorderType","StereoAudioRecorder","numberOfAudioChannels","bufferSize","timeSlice","ondataavailable","getBlob","float32Data","numSamples","buffer","ArrayBuffer","view","DataView","_writeString","setUint32","setUint16","sample","int16","setInt16","string","setUint8","charCodeAt","StorageAdapter","save","filename","metadata","load","id","delete","list","exists","clear","files","file","IndexedDBAdapter","dbName","storeName","version","db","request","indexedDB","open","onerror","onsuccess","result","onupgradeneeded","target","objectStoreNames","contains","store","createObjectStore","keyPath","autoIncrement","createIndex","unique","transaction","objectStore","record","size","add","String","get","Number","getAll","records","map","date","searchByFilename","allRecords","filter","toLowerCase","includes","getStorageInfo","totalSize","reduce","sum","totalSizeMB","toFixed","countRequest","clearRequest","getStorageEstimate","storage","estimate","usage","quota","usageMB","quotaMB","usagePercent","ServerAdapter","baseURL","saveEndpoint","loadEndpoint","deleteEndpoint","listEndpoint","headers","formData","FormData","append","Object","keys","JSON","stringify","response","fetch","method","body","ok","status","statusText","text","json","Array","isArray","saveWithProgress","onProgress","xhr","XMLHttpRequest","upload","addEventListener","e","lengthComputable","percent","loaded","responseText","key","setRequestHeader","send","ElectronAdapter","savePath","electronAPI","arrayBuffer","from","Uint8Array","saveRecording","success","filePath","loadRecording","uint8Array","deleteRecording","directory","recordings","listRecordings","openFile","saveAs","defaultFilename","showInFolder","CapacitorAdapter","Capacitor","initialized","Filesystem","Directory","Plugins","readdir","Documents","mkdir","recursive","base64Data","blobToBase64","writeFile","metadataWithDefaults","encoding","readFile","base64ToBlob","deleteFile","audioFiles","f","endsWith","all","metaResult","parse","sort","a","b","getUri","uri","reader","FileReader","onloadend","base64","split","readAsDataURL","byteCharacters","atob","byteNumbers","byteArray","r","StorageFactory","create","createAuto","require","PlatformDetector","detect","process","versions","electron","isElectron","isCapacitor","isBrowser","isMobile","supportsAudioWorklet","prototype","supportsOffscreenCanvas","OffscreenCanvas","getInfo","platform","VoiceBankRecorder","mergeOptions","createStorageAdapter","currentBlob","container","initializeUI","defaults","layout","theme","channels","agc","waveform","showOverview","showAccumulated","showLive","decimation","colors","selection","playback","callbacks","onRecordStart","onRecordStop","onRecordPause","onRecordResume","onPlayStart","onPlayStop","onError","deepMerge","storageConfig","log","play","blobToSave","filenameToUse","getCurrentBlob","destroy","VERSION","BUILD_INFO","toISOString"],"mappings":"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"}